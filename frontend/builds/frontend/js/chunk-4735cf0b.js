(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4735cf0b"],{"652d":function(t,e,i){},"814e":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t._self._c;return e("notification-channel-template",{attrs:{"error-messages":t.errorMessages,saving:t.saving,"notification-channel":t.notificationChannel,"show-settings":t.setupCompleted},on:{createNotificationChannel:function(e){return t.$emit("createNotificationChannel",e)},updateNotificationChannel:function(e){return t.$emit("updateNotificationChannel",e)},deleteNotificationChannel:e=>t.$emit("deleteNotificationChannel",e),clearErrorMessages:e=>t.$emit("clearErrorMessages",e)},scopedSlots:t._u([{key:"header",fn:function(){return[e("div",{staticClass:"form-text"},[e("p",[t._v(t._s(t.$t("Login to be notified by our Telegram bot.")))]),t.isInMobile?e("div",{staticClass:"text-warning small"},[e("p",[e("i18next",{attrs:{translation:t.$t("Telegram in the mobile app is very finicky. Please open a browser, and log into {localizedDom} using the same credential to set up Telegram.")},scopedSlots:t._u([{key:"localizedDom",fn:function(){return[e("a",{attrs:{href:t.getAppUrl()}},[t._v(t._s(t.$t("the {brandName} web app",{brandName:t.$syndicateText.brandName})))])]},proxy:!0}],null,!1,2450832137)})],1),e("p",[t._v(t._s(t.$t("Once set up, Telegram notification will work properly on your phone.")))])]):e("div",{staticClass:"text-warning small"},[e("p",[t._v(" "+t._s(t.$t("If you see 'Bot domain invalid', please hard-refresh the browser a few times. I know it's annoying. But Telegram API has a very high failure rate."))+" ")]),e("p",[t._v(" "+t._s(t.$t("If you press the 'Test Telegram Notification' button and see an error, please hard-refresh the browser a few times and press the test button again."))+" ")])])]),e("br"),e("div",{staticClass:"form-group row"},[t.notificationChannel.channelInfo&&t.notificationChannel.channelInfo.config&&t.notificationChannel.channelInfo.config.chat_id?e("div",[e("div",{staticClass:"col-12"},[e("div",{staticClass:"btn btn-sm btn-primary float-left mr-2",on:{click:t.onTelegramLogout}},[t._v(" "+t._s(t.$t("Unlink Telegram"))+" ")]),e("div",{staticClass:"btn btn-sm btn-primary float-left",on:{click:function(e){return t.onTelegramTest(e)}}},[t._v(" "+t._s(t.$t("Test Telegram Notification"))+" ")])])]):e("div",[e("div",{staticClass:"col-12"},[e("vue-telegram-login",{attrs:{mode:"callback","telegram-login":t.notificationChannel.pluginInfo.env_vars.TELEGRAM_BOT_NAME.value,"request-access":"write"},on:{callback:t.onTelegramAuth}})],1)])])]},proxy:!0}])})},a=[],o=i("9897"),s=i("cee4"),r=i("c7f6"),l=i("d226"),c=i("1c9d"),d={name:"TelegramPlugin",components:{NotificationChannelTemplate:o["a"],vueTelegramLogin:l["vueTelegramLogin"]},props:{errorMessages:{type:Object,required:!0},saving:{type:Object,required:!0},notificationChannel:{type:Object,required:!0},config:{type:Object,required:!0}},computed:{setupCompleted(){var t,e;return!(null===(t=this.notificationChannel.channelInfo)||void 0===t||null===(e=t.config)||void 0===e||!e.chat_id)},isInMobile(){return Object(c["c"])()}},methods:{onTelegramAuth(t){const e={chat_id:JSON.stringify(t.id)};this.$emit("createNotificationChannel",{section:this.notificationChannel,config:e})},onTelegramLogout(){this.$emit("deleteNotificationChannel",this.notificationChannel)},onTelegramTest(t){return t.target.classList.add("disabled"),s["a"].post(r["a"].testNotificationChannel(this.notificationChannel.channelInfo.id)).then(()=>{t.target.classList.add("btn-success")}).catch(e=>{t.target.classList.remove("disabled"),this.$swal.Reject.fire({title:""+this.$i18next.t("Error"),html:`<p style="line-height: 1.5; max-width: 400px; margin: 0 auto;">\n              ${this.$i18next.t("Telegram test failed")}\n            </p>`,showConfirmButton:!1,showCancelButton:!0,cancelButtonText:""+this.$i18next.t("Close")})})}}},u=d,f=i("2877"),h=Object(f["a"])(u,n,a,!1,null,null,null);e["default"]=h.exports},9897:function(t,e,i){"use strict";var n=function(){var t=this,e=t._self._c;return e("section",[e("h2",{staticClass:"section-title"},[t._v(t._s(t.$t(t.notificationChannel.title)))]),0===t.envVarsToSet.length?e("div",[t._t("header"),t._t("configuration",(function(){return[t.configVariableName?e("div",{staticClass:"form-group row my-4"},[e("label",{staticClass:"col-12 col-form-label",attrs:{for:"id_"+t.settingKey(t.configVariableName)}},[t._v(" "+t._s(t.configVariableTitle)+" ")]),e("div",{staticClass:"col-12 col-form-label"},[e("saving-animation",{attrs:{errors:t.errorMessages[t.settingKey("config")],saving:t.saving[t.settingKey("config")]}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.configVariable,expression:"configVariable"}],staticClass:"form-control",attrs:{id:"id_"+t.settingKey(t.configVariableName),type:"text",placeholder:t.configVariablePlaceholder},domProps:{value:t.configVariable},on:{input:function(e){e.target.composing||(t.configVariable=e.target.value)}}})])],1)]):t._e()]})),t.channelCreated&&t.showSettings?e("div",[e("notification-setting-switch",{attrs:{"setting-id":"enabled","setting-title":t.$t("Enable notification"),"is-header":!0,"error-messages":t.errorMessages,saving:t.saving,"notification-channel":t.notificationChannel,"bottom-divider":!0},on:{updateNotificationChannel:function(e){return t.$emit("updateNotificationChannel",e)}}}),e("div",{class:{inactive:!t.notificationsEnabled}},[t._t("custom-settings"),t._l(t.notificationSettings,(function(i){return e("div",{key:i.id},["print_job"===i.id?["web"===t.theme?e("div",{staticClass:"row"},[e("div",{staticClass:"col-12 col-form-label"},[e("saving-animation",{attrs:{errors:[],saving:!1}},[e("div",{staticClass:"custom-control custom-checkbox form-check-inline"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.printerStatusChangeNotifications,expression:"printerStatusChangeNotifications"}],staticClass:"custom-control-input",attrs:{id:"id_"+t.settingKey(i.id),type:"checkbox",disabled:!t.notificationsEnabled},domProps:{checked:Array.isArray(t.printerStatusChangeNotifications)?t._i(t.printerStatusChangeNotifications,null)>-1:t.printerStatusChangeNotifications},on:{change:function(e){var i=t.printerStatusChangeNotifications,n=e.target,a=!!n.checked;if(Array.isArray(i)){var o=null,s=t._i(i,o);n.checked?s<0&&(t.printerStatusChangeNotifications=i.concat([o])):s>-1&&(t.printerStatusChangeNotifications=i.slice(0,s).concat(i.slice(s+1)))}else t.printerStatusChangeNotifications=a}}}),e("label",{staticClass:"custom-control-label",attrs:{for:"id_"+t.settingKey(i.id)}},[t._v(" "+t._s(i.title)+" "),i.description?e("span",{staticClass:"text-muted setting-description"},[e("br"),t._v(t._s(i.description))]):t._e()])])])],1)]):e("div",[e("saving-animation",{attrs:{errors:[],saving:!1}},[e("div",{staticClass:"mobile-setting-item-wrapper"},[e("div",{staticClass:"setting-item-text"},[e("label",{attrs:{for:"id_"+t.settingKey(i.id)}},[t._v(" "+t._s(i.title)+" "),i.description?e("span",{staticClass:"text-muted setting-description"},[e("br"),t._v(t._s(i.description))]):t._e()])]),e("div",{staticClass:"setting-item-switch"},[e("onoff-toggle",{staticClass:"mb-0",attrs:{theme:t.theme,width:"ios"===t.theme?48:30,height:"ios"===t.theme?24:12,"on-color":"ios"===t.theme?"var(--color-primary)":"var(--color-primary-muted)","off-color":"var(--color-divider)","border-color":"var(--color-divider)","thumb-color":"ios"===t.theme?"#fff":"var(--color-primary)",disabled:!t.notificationsEnabled},model:{value:t.printerStatusChangeNotifications,callback:function(e){t.printerStatusChangeNotifications=e},expression:"printerStatusChangeNotifications"}})],1)])])],1)]:[e("notification-setting-switch",{attrs:{"setting-id":i.id,"setting-title":i.title,"setting-description":i.description,disabled:!t.notificationsEnabled,"error-messages":t.errorMessages,saving:t.saving,"notification-channel":t.notificationChannel},on:{updateNotificationChannel:function(e){return t.$emit("updateNotificationChannel",e)}}})],i.subcategories?e("div",t._l(i.subcategories,(function(i){return e("notification-setting-switch",{key:t.getKey(i),attrs:{"setting-id":i.id,"setting-title":i.title,"setting-description":i.description,"is-subcategory":!0,disabled:!t.notificationsEnabled,"error-messages":t.errorMessages,saving:t.saving,"notification-channel":t.notificationChannel},on:{updateNotificationChannel:function(e){return t.$emit("updateNotificationChannel",e)}}})})),1):t._e()],2)}))],2)],1):t._e(),t._t("footer")],2):e("div",[e("p",{staticClass:"text-warning"},[t._v(t._s(t.$t("Please configure the following variables in the '.env' file"))+":")]),e("ul",{staticClass:"text-warning"},t._l(t.envVarsToSet,(function(i){return e("li",{key:i},[t._v(t._s(i))])})),0)])])},a=[],o=(i("14d9"),i("847e")),s=function(){var t=this,e=t._self._c;return"web"===t.theme?e("div",{staticClass:"row"},[e("div",{staticClass:"col-12 col-form-label",class:{"pl-5":t.isSubcategory}},[e("saving-animation",{attrs:{errors:t.errorMessages?t.errorMessages[t.settingKey(t.settingId)]:[],saving:!!t.saving&&t.saving[t.settingKey(t.settingId)]}},[e("div",{staticClass:"custom-control custom-checkbox form-check-inline"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],staticClass:"custom-control-input",attrs:{id:"id_"+t.settingKey(t.settingId),type:"checkbox",disabled:t.disabled},domProps:{checked:Array.isArray(t.value)?t._i(t.value,null)>-1:t.value},on:{change:function(e){var i=t.value,n=e.target,a=!!n.checked;if(Array.isArray(i)){var o=null,s=t._i(i,o);n.checked?s<0&&(t.value=i.concat([o])):s>-1&&(t.value=i.slice(0,s).concat(i.slice(s+1)))}else t.value=a}}}),e("label",{class:["custom-control-label",t.labelClass],attrs:{for:"id_"+t.settingKey(t.settingId)}},[t._v(" "+t._s(t.settingTitle)+" "),t.settingDescription?e("span",{staticClass:"text-muted setting-description"},[e("br"),t._v(t._s(t.settingDescription))]):t._e()])])])],1),t.bottomDivider?e("div",{staticClass:"col-12"},[e("hr",{staticClass:"my-1"})]):t._e()]):e("div",[e("saving-animation",{attrs:{errors:t.errorMessages?t.errorMessages[t.settingKey(t.settingId)]:[],saving:!!t.saving&&t.saving[t.settingKey(t.settingId)]}},[e("div",{staticClass:"mobile-setting-item-wrapper",class:{"is-subcategory":t.isSubcategory}},[e("div",{staticClass:"setting-item-text"},[e("label",{class:t.labelClass,attrs:{for:"id_"+t.settingKey(t.settingId)}},[t._v(" "+t._s(t.settingTitle)+" "),t.settingDescription?e("span",{staticClass:"text-muted setting-description"},[e("br"),t._v(t._s(t.settingDescription))]):t._e()])]),e("div",{staticClass:"setting-item-switch"},[e("onoff-toggle",{staticClass:"mb-0",attrs:{theme:t.theme,width:"ios"===t.theme?48:30,height:"ios"===t.theme?24:12,"on-color":"ios"===t.theme?"var(--color-primary)":"var(--color-primary-muted)","off-color":"var(--color-divider)","border-color":"var(--color-divider)","thumb-color":"ios"===t.theme?"#fff":"var(--color-primary)",disabled:t.disabled},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1)])])],1)},r=[],l=i("b279"),c=i("1c9d"),d={name:"NotificationSettingSwitch",components:{SavingAnimation:o["a"]},props:{errorMessages:{type:Object||null,default:null},saving:{type:Object||null,default:null},notificationChannel:{type:Object,required:!0},settingId:{type:String,required:!0},settingTitle:{type:String,required:!0},settingDescription:{type:String,default:""},isSubcategory:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},bottomDivider:{type:Boolean,default:!1},isHeader:{type:Boolean,default:!1}},data(){return{value:this.notificationChannel.channelInfo[this.settingId]}},computed:{theme(){const t=Object(c["c"])();return t?"ios"===t?"ios":"material":"web"},labelClass(){return this.isHeader?"lg":""}},watch:{value:function(t,e){this.$emit("updateNotificationChannel",{section:this.notificationChannel,propNames:[this.settingId],propValues:[t]})}},methods:{settingKey(t){return Object(l["e"])(this.notificationChannel,t)}}},u=d,f=(i("edc1"),i("2877")),h=Object(f["a"])(u,s,r,!1,null,"260ae3fa",null),g=h.exports,p=i("0692"),m=[{id:"notify_on_failure_alert",title:""+p["a"].t("Failure alerts"),description:""+p["a"].t("When possible failures are detected")},{id:"print_job",title:""+p["a"].t("Print job events"),description:""+p["a"].t("Upon start/end/cancellation of a print job"),subcategories:[{id:"notify_on_print_done",title:""+p["a"].t("When print is done"),enabledByDefault:!0},{id:"notify_on_print_cancelled",title:""+p["a"].t("When print is cancelled"),enabledByDefault:!1},{id:"notify_on_filament_change",title:""+p["a"].t("When printer needs attention"),description:""+p["a"].t("Such as filament change or run-out"),enabledByDefault:!0},{id:"notify_on_print_start",title:""+p["a"].t("When print is started"),enabledByDefault:!1},{id:"notify_on_print_pause",title:""+p["a"].t("When print is paused"),description:""+p["a"].t("Note: this event may be triggered by other plugins that pause the print frequently, such as the timelapse plugin"),enabledByDefault:!1},{id:"notify_on_print_resume",title:""+p["a"].t("When print is resumed"),description:""+p["a"].t("Note: this event may be triggered by other plugins that pause the print frequently, such as the timelapse plugin"),enabledByDefault:!1}]},{id:"notify_on_heater_status",title:""+p["a"].t("Heater status change"),description:""+p["a"].t("Heater reached target or cooled down")}],b={name:"NotificationChannelTemplate",components:{SavingAnimation:o["a"],NotificationSettingSwitch:g},props:{errorMessages:{type:Object,required:!0},saving:{type:Object,required:!0},notificationChannel:{type:Object,required:!0},notificationSettings:{type:Array,default:()=>m},showSettings:{type:Boolean,default:!0},configVariableTitle:{type:String,default:""},configVariablePlaceholder:{type:String,default:""},configVariableName:{type:String,default:""}},data(){return{configVariable:null,configUpdateTimeout:null}},computed:{channelCreated(){return!!this.notificationChannel.channelInfo},notificationsEnabled(){return!!this.notificationChannel.channelInfo&&this.notificationChannel.channelInfo.enabled},envVarsToSet(){var t;const e=(null===(t=this.notificationChannel.pluginInfo)||void 0===t?void 0:t.env_vars)||{};let i=[];for(const[n,a]of Object.entries(e))a.is_required&&!a.is_set&&i.push(n);return i},printerStatusChangeNotifications:{get:function(){if(!this.notificationChannel.channelInfo)return null;const t=this.notificationSettings.find(t=>"print_job"===t.id).subcategories;for(const e of t)if(this.notificationChannel.channelInfo[e.id])return!0;return!1},set:function(t){if(t){const t=this.notificationSettings.find(t=>"print_job"===t.id).subcategories;let e=[],i=[];for(const n of t)n.enabledByDefault&&(e.push(n.id),i.push(!0));e.length&&this.$emit("updateNotificationChannel",{section:this.notificationChannel,propNames:e,propValues:i})}else{const t=this.notificationSettings.find(t=>"print_job"===t.id).subcategories;let e=[],i=[];for(const n of t)this.notificationChannel.channelInfo[n.id]&&(e.push(n.id),i.push(!1));e.length&&this.$emit("updateNotificationChannel",{section:this.notificationChannel,propNames:e,propValues:i})}}},theme(){const t=Object(c["c"])();return t?"ios"===t?"ios":"material":"web"}},watch:{configVariable(t,e){null!==e&&(this.$emit("clearErrorMessages",this.settingKey("config")),this.updateConfig())}},created(){this.notificationChannel.channelInfo&&this.notificationChannel.channelInfo.config&&this.configVariableName?this.configVariable=this.notificationChannel.channelInfo.config[this.configVariableName]:this.configVariable=""},methods:{getKey(t){return`${t.id}_${this.notificationChannel.channelInfo[t.id]}`},settingKey(t){return Object(l["e"])(this.notificationChannel,t)},updateConfig(){this.configUpdateTimeout&&clearTimeout(this.configUpdateTimeout);const t={[this.configVariableName]:this.configVariable};this.channelCreated?this.configUpdateTimeout=setTimeout(()=>{this.configVariable?this.$emit("updateNotificationChannel",{section:this.notificationChannel,propNames:["config"],propValues:[t]}):this.$emit("deleteNotificationChannel",this.notificationChannel)},1e3):this.configVariable&&(this.configUpdateTimeout=setTimeout(()=>this.$emit("createNotificationChannel",{section:this.notificationChannel,config:t}),1e3))}}},v=b,_=(i("abd4"),Object(f["a"])(v,n,a,!1,null,"93fc5b00",null));e["a"]=_.exports},abd4:function(t,e,i){"use strict";i("f3a1")},d226:function(t,e,i){!function(e,i){t.exports=i()}(window,(function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);var n={name:"vue-telegram-login",props:{mode:{type:String,required:!0,validator:function(t){return["callback","redirect"].includes(t)}},telegramLogin:{type:String,required:!0,validator:function(t){return t.endsWith("bot")||t.endsWith("Bot")}},redirectUrl:{type:String,default:""},requestAccess:{type:String,default:"read",validator:function(t){return["read","write"].includes(t)}},size:{type:String,default:"large",validator:function(t){return["small","medium","large"].includes(t)}},userpic:{type:Boolean,default:!0},radius:{type:String}},methods:{onTelegramAuth:function(t){this.$emit("callback",t)}},mounted:function(){var t=document.createElement("script");t.async=!0,t.src="https://telegram.org/js/telegram-widget.js?3",t.setAttribute("data-size",this.size),t.setAttribute("data-userpic",this.userpic),t.setAttribute("data-telegram-login",this.telegramLogin),t.setAttribute("data-request-access",this.requestAccess),this.radius&&t.setAttribute("data-radius",this.radius),"callback"===this.mode?(window.onTelegramAuth=this.onTelegramAuth,t.setAttribute("data-onauth","window.onTelegramAuth(user)")):t.setAttribute("data-auth-url",this.redirectUrl),this.$refs.telegram.appendChild(t)}},a=function(){var t=this.$createElement;return(this._self._c||t)("div",{ref:"telegram"})};a._withStripped=!0;var o=function(t,e,i,n,a,o,s,r){var l=typeof(t=t||{}).default;"object"!==l&&"function"!==l||(t=t.default);var c,d="function"==typeof t?t.options:t;if(e&&(d.render=e,d.staticRenderFns=i,d._compiled=!0),n&&(d.functional=!0),o&&(d._scopeId=o),s?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),a&&a.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},d._ssrRegister=c):a&&(c=r?function(){a.call(this,this.$root.$options.shadowRoot)}:a),c)if(d.functional){d._injectStyles=c;var u=d.render;d.render=function(t,e){return c.call(e),u(t,e)}}else{var f=d.beforeCreate;d.beforeCreate=f?[].concat(f,c):[c]}return{exports:t,options:d}}(n,a,[],!1,null,null,null);o.options.__file="src/vue-telegram-login.vue";var s=o.exports;i.d(e,"vueTelegramLogin",(function(){return s}))}])}))},edc1:function(t,e,i){"use strict";i("652d")},f3a1:function(t,e,i){}}]);
//# sourceMappingURL=chunk-4735cf0b.js.map