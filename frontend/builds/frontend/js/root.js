(function(e){function t(t){for(var i,r,o=t[0],c=t[1],l=t[2],d=0,u=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&u.push(a[r][0]),a[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);p&&p(t);while(u.length)u.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],i=!0,r=1;r<n.length;r++){var o=n[r];0!==a[o]&&(i=!1)}i&&(s.splice(t--,1),e=c(c.s=n[0]))}return e}var i={},r={root:0},a={root:0},s=[];function o(e){return c.p+"js/"+({}[e]||e)+".js"}function c(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n={"chunk-129fbd24":1,"chunk-207f8542":1,"chunk-2a713caa":1,"chunk-40e6f31a":1,"chunk-4f250c50":1,"chunk-571535b8":1,"chunk-61f8bca3":1,"chunk-738fea3f":1,"chunk-e7f0879a":1};r[e]?t.push(r[e]):0!==r[e]&&n[e]&&t.push(r[e]=new Promise((function(t,n){for(var i="css/"+({}[e]||e)+".css",a=c.p+i,s=document.getElementsByTagName("link"),o=0;o<s.length;o++){var l=s[o],d=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(d===i||d===a))return t()}var u=document.getElementsByTagName("style");for(o=0;o<u.length;o++){l=u[o],d=l.getAttribute("data-href");if(d===i||d===a)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=t,p.onerror=function(t){var i=t&&t.target&&t.target.src||a,s=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");s.code="CSS_CHUNK_LOAD_FAILED",s.request=i,delete r[e],p.parentNode.removeChild(p),n(s)},p.href=a;var f=document.getElementsByTagName("head")[0];f.appendChild(p)})).then((function(){r[e]=0})));var i=a[e];if(0!==i)if(i)t.push(i[2]);else{var s=new Promise((function(t,n){i=a[e]=[t,n]}));t.push(i[2]=s);var l,d=document.createElement("script");d.charset="utf-8",d.timeout=120,c.nc&&d.setAttribute("nonce",c.nc),d.src=o(e);var u=new Error;l=function(t){d.onerror=d.onload=null,clearTimeout(p);var n=a[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",u.name="ChunkLoadError",u.type=i,u.request=r,n[1](u)}a[e]=void 0}};var p=setTimeout((function(){l({type:"timeout",target:d})}),12e4);d.onerror=d.onload=l,document.head.appendChild(d)}return Promise.all(t)},c.m=e,c.c=i,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)c.d(n,i,function(t){return e[t]}.bind(null,i));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/static/frontend/",c.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],d=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var p=d;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"013e":function(e,t,n){},"0469":function(e,t,n){e.exports=n.p+"img/detective-working.gif"},"058a":function(e,t,n){},"05df":function(e,t,n){},"09e8":function(e,t,n){},"0ab6":function(e,t,n){},"0fb5":function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l}));var i=n("a026"),r=n("6c44"),a=n("59cf"),s=i["default"].observable({value:a["c"]});function o(){return Object(a["b"])(s)}function c(){return Object(a["d"])(o())}function l(e){s.value=e,Object(r["a"])()&&localStorage.setItem("colorTheme",s.value),c()}},1:function(e,t){},"17ae":function(e,t,n){var i={"./discord":["6289","chunk-61f8bca3"],"./discord.vue":["6289","chunk-61f8bca3"],"./email":["a10d","chunk-40e6f31a"],"./email.vue":["a10d","chunk-40e6f31a"],"./pushbullet":["fde9","chunk-4f250c50"],"./pushbullet.vue":["fde9","chunk-4f250c50"],"./pushover":["6ad2","chunk-207f8542"],"./pushover.vue":["6ad2","chunk-207f8542"],"./slack":["9aa3","chunk-738fea3f"],"./slack.vue":["9aa3","chunk-738fea3f"],"./telegram":["037c","chunk-129fbd24"],"./telegram.vue":["037c","chunk-129fbd24"],"./twilio":["0bd0","chunk-571535b8"],"./twilio.vue":["0bd0","chunk-571535b8"]};function r(e){if(!n.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(i)},r.id="17ae",e.exports=r},1920:function(e,t,n){},"1c3a":function(e,t,n){e.exports=n.p+"img/moonraker_verification_code.png"},"1ccb":function(e,t,n){},"1cd4":function(e,t,n){},"1e98":function(e,t,n){},"1f6a":function(e,t,n){e.exports=n.p+"img/mainsail_logo.png"},2028:function(e,t,n){},"222b":function(e,t,n){e.exports=n.p+"img/octopod.webp"},"22c6":function(e,t,n){},"24bc":function(e,t,n){},2814:function(e,t,n){e.exports=n.p+"img/install_plugin.png"},"2e7f":function(e,t,n){e.exports=n.p+"img/octoprint_logo.png"},"2e84":function(e,t,n){"use strict";var i=n("2efb"),r=n.n(i);r.a},"2efb":function(e,t,n){},3252:function(e,t,n){"use strict";var i=n("3e93"),r=n.n(i);r.a},"35af":function(e,t,n){},3920:function(e,t,n){},3957:function(e,t,n){e.exports=n.p+"img/polymer.webp"},"3e93":function(e,t,n){},"3ed7":function(e,t,n){},"3ee0":function(e,t,n){e.exports=n.p+"img/printoid.webp"},"404a":function(e,t,n){"use strict";var i=n("5106"),r=n.n(i);r.a},"40e1":function(e,t,n){},4392:function(e,t,n){},"4ccf":function(e,t,n){"use strict";var i=n("2028"),r=n.n(i);r.a},"4d0c":function(e,t,n){},"4de7":function(e,t,n){e.exports=n.p+"img/webpage-multiple.svg"},"4e03":function(e,t,n){e.exports=n.p+"img/plugin_wizard_websetup.png"},"4f95":function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return c}));n("d3b7"),n("ac1f"),n("3ca3"),n("841c"),n("ddb0"),n("2b3d");var i=function(){return JSON.parse(document.querySelector("#app-platform-json").text)["platform"]},r=function(){return""!==i()},a=function(){return JSON.parse(document.querySelector("#user-json").text)},s=function(){return JSON.parse(document.querySelector("#settings-json").text)},o=function(){return"true"===new URLSearchParams(window.location.search).get("onlyNotifications")},c=function(){return"true"===new URLSearchParams(window.location.search).get("onlyName")}},5106:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("a026"),r=n("8c4f"),a=n("f3f3"),s=n("5886"),o=n("6c44"),c=function(e,t){var n=Object(o["a"])()?localStorage.getItem(e):null,i=n||t;try{return JSON.parse(i)}catch(r){return i}},l=function(e,t){Object(o["a"])()&&localStorage.setItem(e,t)},d=function(e,t,n){var r=document.createElement("div"),s=new i["default"]({render:function(n){return n(e,{props:t})}}).$mount(r);return i["default"].swal(Object(a["a"])(Object(a["a"])({},n),{},{customClass:{container:"dark-backdrop"},html:'<div id="replace-here">Placeholder</div>',onBeforeOpen:function(e){e.querySelector("#replace-here").replaceWith(s.$el)},onDestroy:function(){s.$destroy(),r.remove()}}))},u=function(e,t,n){return i["default"].swal(Object(a["a"])(Object(a["a"])({},n),{},{customClass:{container:"dark-backdrop"},html:'<div id="replace-here">Placeholder</div>',onBeforeOpen:function(t){t.querySelector("#replace-here").replaceWith(e)}}))},p=function(e,t){e.use(s["a"],t);var n=e.swal.mixin({title:"Are you sure?",showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"No",customClass:{container:"dark-backdrop"}}),i=e.swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3}),r=e.swal.mixin({icon:"error",customClass:{container:"dark-backdrop error-alert"}}),o=e.swal.mixin({customClass:{container:"dark-backdrop"}}),p=function(t,n){if(!c(n,!1)){var i=Object(a["a"])(Object(a["a"])({},t),{},{position:"top-end",confirmButtonText:"Gotcha! Don't show this again."});return e.swal(i).then((function(e){e.value&&(l(n,!0),console.log(e))}))}};e.prototype.$swal["openModalWithComponent"]=d,e.prototype.$swal["openModalWithElement"]=u,e.prototype.$swal["Confirm"]=n,e.prototype.$swal["Toast"]=i,e.prototype.$swal["DismissableToast"]=p,e.prototype.$swal["Reject"]=r,e.prototype.$swal["Prompt"]=o},f={install:p},h=n("5f5b"),m=n("c0eb"),v=n("2ead"),g=n.n(v);n("4de4");i["default"].filter("floor",(function(e){return Math.floor(e)}));n("99af"),n("fb6a"),n("b0c0"),n("d3b7"),n("ac1f"),n("25f0"),n("5319");var b=n("0122"),_=/(?:^|[-_/])(\w)/g,w="root",C="anonymous component",y=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^/]+?|)(\.[^./]*|))(?:[/]*)$/,k=function(e){var t=y.exec(e);return t?t.slice(1):[]},S=function(e,t){var n=k(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},P=function(e){if(!e)return C;if(e.$root===e)return w;if(!e.$options)return C;if(e.$options.name)return e.$options.name;if(e.$options._componentTag)return e.$options._componentTag;if(e.$options.__file){var t=e.$options.__file.replace(/^[a-zA-Z]:/,"").replace(/\\/g,"/"),n=S(t,".vue");return n.replace(_,(function(e,t){return t?t.toUpperCase():""}))}return C},x=function e(t,n,i,r,a,s){var o=0;for(var c in n){if(o+=1,o>s)break;"object"==Object(b["a"])(n[c])?a>r&&e(t,n[c],i+"."+c,r+1,a,s):t[i+"."+c]=n[c]}},T=function(e){var t=e.config.errorHandler;e.config.errorHandler=function(n,i,r){if(window.Sentry){var a={},s=i;if(i._original&&(s=i._original),s)try{a.componentName=P(s),x(a,JSON.parse(JSON.stringify(s.$options.propsData)),"props",0,2,10)}catch(o){console.log("Unable to extract metadata from Vue component.")}r&&(a.lifecycleHook=r),setTimeout((function(){window.Sentry.getCurrentHub().withScope((function(e){e.setContext("vue",a),window.Sentry.getCurrentHub().captureException(n)}))}))}"function"===typeof t&&t.call(e,n,i,r),e.util&&e.util.warn("Error in ".concat(r,': "').concat(n.toString(),'"'),i),console.error(n)}},O=T,D=n("0fb5"),I=n("fc02"),A=n.n(I),j=n("eaf3"),E=n("67b0"),F=function(e,t){Object(D["b"])(),O(i["default"]),i["default"].use(r["a"]),i["default"].use(h["a"]),i["default"].use(f),i["default"].use(m["a"]),i["default"].use(g.a),i["default"].use(A.a),i["default"].use(j["a"]),i["default"].use(E["a"]),document.getElementById("app")&&new i["default"]({router:e,components:t}).$mount("#app")},R=(n("d81d"),n("07ac"),n("d0ff")),N=(n("13d5"),n("b64b"),n("fc11")),M={email:{displayName:"Email"},twilio:{displayName:"SMS"},pushbullet:{displayName:"Pushbullet"},discord:{displayName:"Discord"},telegram:{displayName:"Telegram"},pushover:{displayName:"Pushover"},slack:{displayName:"Slack"}},L={ThemePreferences:"/user_preferences/personalization/",ProfilePreferences:"/user_preferences/profile/",AuthorizedApps:"/user_preferences/authorized_apps/",GeneralNotifications:"/user_preferences/general_notifications/",PushNotifications:"/user_preferences/mobile_push_notifications/"},B=Object.keys(M).reduce((function(e,t){return Object.assign(e,Object(N["a"])({},t,"/user_preferences/notification_".concat(t,"/")))}),{}),$=Object(a["a"])(Object(a["a"])({},L),B),U={printerWizard:"/printers/wizard/",printerWizardSetup:"/printers/wizard/setup/"},z=U,V=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("b-container",[i("b-row",{staticClass:"justify-content-center"},[e.user?i("b-col",{staticClass:"mt-3",attrs:{lg:"8"}},[0===e.printersToShow.length?i("div",{staticClass:"wizard-container full-on-mobile"},[i("b-container",[i("b-row",[i("div",{staticClass:"col-sm-12 col-md-8 offset-md-2 col-lg-6 offset-lg-3"},[i("svg",{staticClass:"logo-img",attrs:{viewBox:"0 0 1965 240"}},[i("use",{attrs:{href:"#svg-logo-compact"}})])])]),i("b-row",[i("h1",{staticClass:"mx-auto"},[e._v("Welcome To Obico")])]),i("b-row",[i("b-col",[i("hr")])],1),e.isEnt&&e.trialDaysLeft>0?i("b-row",[i("b-col",[e.trialDaysLeft>=29?i("h3",{staticClass:"py-3"},[e._v("Your 30-Day "),i("a",{staticClass:"link",attrs:{target:"_blank",href:"https://www.obico.io/docs/user-guides/upgrade-to-pro/"}},[e._v("Pro Plan")]),e._v(" Free Trial Has Started!")]):i("h3",{staticClass:"py-3"},[e._v(e._s(e.trialDaysLeft)+" Days Left on Your "),i("a",{staticClass:"link",attrs:{target:"_blank",href:"https://www.obico.io/docs/user-guides/upgrade-to-pro/"}},[e._v("Pro Plan ")]),e._v("Free Trial!")]),i("div",{staticClass:"pb-1"},[i("i",{staticClass:"feature-check fas fa-check-circle"}),i("span",{staticClass:"feature-text"},[e._v("Unlimited Secure Tunneling to your OctoPrint")])]),i("div",{staticClass:"pb-1"},[i("i",{staticClass:"feature-check fas fa-check-circle"}),i("span",{staticClass:"feature-text"},[e._v("Premium 25 FPS Webcam Streaming")])]),i("div",{staticClass:"pb-1"},[i("i",{staticClass:"feature-check fas fa-check-circle"}),i("span",{staticClass:"feature-text"},[e._v("250 AI Failure Detection Hours")])]),i("div",{staticClass:"pb-1"},[i("i",{staticClass:"feature-check fas fa-check-circle"}),i("span",{staticClass:"feature-text"},[e._v("G-Code Remote Upload and Printing")])]),i("div",{staticClass:"lead py-4"},[e._v("OctoPrint has not been linked to your Obico account.")]),i("div",{staticClass:"d-flex flex-column align-center justify-content-center"},[i("div",[i("a",{staticClass:"btn btn-primary btn-block mx-auto btn-lg",attrs:{href:e.wizardUrl}},[e._v("Link OctoPrint Now")])]),i("div",[i("div",{staticClass:"text-muted mx-auto text-center font-weight-light"},[e._v("It's as easy as 1-2-3.")])])])])],1):e._e(),i("div",{staticClass:"footer-note small"},[e._v("Not ready to start yet? "),i("a",{attrs:{href:"mailto:support@obico.io?subject=Please%20pause%20my%20free%20trial"}},[e._v("Email us")]),e._v(" to pause your free trial.")])],1)],1):i("div",[i("div",{staticClass:"text-center"},[i("svg",{attrs:{width:"100",height:"40"}},[i("use",{attrs:{href:"#svg-logo-full"}})])]),e.authorized?i("div",{staticClass:"authorization-successful"},[i("h4",{staticClass:"title"},[e._v("Authorization Successful!")]),i("p",[e._v("You can close this page")])]):i("div",[i("div",[i("div",{staticClass:"lead text-center mt-3 mb-5"},[e._v("Tunnel Access Authorization")]),i("h4",{staticClass:"my-4"},[i("span",{staticClass:"font-weight-bold"},[e._v(e._s(e.appName))]),e._v(" is requesting to access you OctoPrint Tunnel.")]),i("p",{staticClass:"text-muted"},[i("a",{attrs:{href:"https://www.obico.io/docs/user-guides/octoprint-tunneling/",target:"_blank"}},[e._v("OctoPrint Tunnel")]),e._v(" is a secure way provided by "),i("a",{attrs:{href:"https://www.obico.io/",target:"_blank"}},[e._v("Obico")]),e._v(" to remotely access your OctoPrint. With the OctoPrint Tunnel, you can use "+e._s(e.appName)+" to access your OctoPrint from anywhere.")]),e.user.is_pro?e._e():i("b-alert",{staticClass:"my-3",attrs:{variant:"warning",dismissible:"",show:""}},[i("div",[i("i",{staticClass:"fas fa-exclamation-triangle"}),e._v(" Tunnel usage of a free account is "),i("a",{attrs:{href:"https://www.obico.io/docs/user-guides/octoprint-tunneling/#why-is-the-limit-on-free-account-only-100mb",target:"_blank"}},[e._v("capped at 300MB per month")]),e._v(". You can "),i("a",{attrs:{href:"http://app.obico.io/ent_pub/pricing/",target:"_blank"}},[e._v("upgrade to the Obico app Pro plan for 1 Starbucks a month")]),e._v(" to enjoy unlimited tunnel usage. ")])]),e.user.is_pro&&e.trialDaysLeft>0?i("b-alert",{staticClass:"my-3",attrs:{variant:"warning",dismissible:"",show:""}},[i("div",[i("i",{staticClass:"fas fa-exclamation-triangle"}),e._v(" After the Free trial expires, tunnel data usage will be "),i("a",{attrs:{href:"https://www.obico.io/docs/user-guides/octoprint-tunneling/#why-is-the-limit-on-free-account-only-100mb",target:"_blank"}},[e._v("capped at 300MB per month")]),e._v(". You can "),i("a",{attrs:{href:"http://app.obico.io/ent_pub/pricing/",target:"_blank"}},[e._v("upgrade to the Obico app Pro plan for 1 Starbucks a month")]),e._v(" to continue enjoying unlimited tunnel usage. ")])]):e._e(),i("div",{staticClass:"mt-5"},[i("p",{staticClass:"lead"},[e._v("Tunnel access by "),i("span",{staticClass:"font-weight-bold"},[e._v(e._s(e.appName))]),e._v(" (make sure you trust it): ")]),0===e.printersToShow.length?i("h5",[e._v("You have 0 active printers")]):1===e.printersToShow.length?i("h5",{staticClass:"font-weight-bold"},[e._v(e._s(e.printersToShow[0].name))]):e.printersToShow.length>1?i("select",{directives:[{name:"model",rawName:"v-model",value:e.printerToAuthorize,expression:"printerToAuthorize"}],staticClass:"custom-select",on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.printerToAuthorize=t.target.multiple?n:n[0]}}},[i("option",{attrs:{selected:"",disabled:""},domProps:{value:null}},[e._v("Please select a printer")]),e._l(e.printersToShow,(function(t){return i("option",{key:t.id,domProps:{value:t.id}},[e._v(" "+e._s(t.name)+" ")])}))],2):e._e(),e.printersToShow.length?i("div",{staticClass:"d-flex mt-4 mb-3"},[i("button",{staticClass:"btn btn-primary",staticStyle:{flex:"1"},attrs:{disabled:!e.printerToAuthorize||e.performingAuthRequest},on:{click:e.authorize}},[e.performingAuthRequest?i("b-spinner",{attrs:{small:"",label:"Loading..."}}):i("span",[e._v("Authorize")])],1),i("a",{staticClass:"btn btn-outline-secondary ml-2",staticStyle:{flex:"1"},attrs:{href:"/user_preferences/authorized_apps"}},[e._v("Manage Apps")])]):e._e()])],1),i("div",{staticClass:"mt-4"},[i("p",{staticClass:"text-muted small mb-1"},[e._v(" Security notes: ")]),i("ul",{staticClass:"text-muted small pl-4"},[i("li",[e._v("The app can only access the tunnel, not your Obico account info such as your email address.")]),i("li",[e._v("The access remains valid until explicitly revoked. You can revoke the access by going to Preferences -> Authorized Apps.")])])])])])]):i("b-col",{staticClass:"mt-5"},[i("div",[i("b-container",[i("div",{staticClass:"d-flex justify-content-center align-items-center"},[i("img",{staticClass:"logo-icon",attrs:{src:e.appLogo}}),i("h3",[e._v("⇄")]),i("svg",{staticClass:"logo-icon obico"},[i("use",{attrs:{href:"#svg-logo-compact"}})]),i("h3",[e._v("⇄")]),i("img",{staticClass:"logo-icon",attrs:{src:n("2e7f")}})]),i("div",{staticClass:"my-4"},[i("div",{staticClass:"mx-auto text-center"},[i("h4",[e._v("OctoPrint Tunnel")]),i("div",{staticClass:"lead"},[e._v("Powered by Obico")])])]),i("div",{staticClass:"account-details"},[i("p",[e._v("With the OctoPrint Tunnel by Obico, you can now use "+e._s(e.appName)+" to "),i("a",{attrs:{href:"https://www.obico.io/docs/user-guides/octoprint-tunneling/",target:"_blank"}},[e._v("securely control and monitor your printer from anywhere")]),e._v(".")]),i("div",{staticClass:"text-muted"},[e._v("Obico Free Account:")]),i("ul",{staticClass:"text-muted"},[i("li",[e._v("Unlimited realtime webcam at 0.1FPS.")]),i("li",[e._v("300MB monthly tunnel data cap (excluding webcam streaming).")]),i("li",[e._v("10 hours/mo AI failure detection.")])]),i("div",{staticClass:"text-muted"},[e._v("Obico Pro Account ("),i("a",{attrs:{href:"https://app.obico.io/ent_pub/pricing/",target:"_blank"}},[e._v("from $4/mo")]),e._v("):")]),i("ul",{staticClass:"text-muted"},[i("li",[e._v("Unlimited realtime webcam streaming.")]),i("li",[e._v("Unlimited tunnel data usage.")]),i("li",[e._v("50 hours/mo AI failure detection.")]),i("li",[i("a",{attrs:{href:"https://app.obico.io/ent_pub/pricing/",target:"_blank"}},[e._v("And much more...")])])])]),i("div",[i("div",{staticClass:"my-5 w-100"},[i("a",{staticClass:"btn btn-primary btn-block",attrs:{href:e.loginUrl}},[e._v("SIGN IN ")]),i("div",{staticClass:"text-center pt-3 w-100"},[i("div",{staticClass:"font-weight-light text-muted"},[e._v("- OR -")]),i("a",{staticClass:"btn",attrs:{href:e.signupUrl}},[e._v("SIGN UP")])])])])])],1)])],1)],1)},W=[],q=(n("4160"),n("3ca3"),n("841c"),n("159b"),n("ddb0"),n("2b3d"),n("bc3a")),G=n.n(q),H=n("c1df"),J=n.n(H),Y=n("c7f6"),K=(n("caad"),n("2532"),n("9b02")),Q=n.n(K),Z=n("49d5"),X=n.n(Z),ee=n("0e49"),te=n.n(ee),ne=function(e){return e?J()(e):null},ie=function(e){return e.ended_at=ne(e.cancelled_at||e.finished_at),e.started_at=ne(e.started_at),e.uploaded_at=ne(e.uploaded_at),e.has_alerts=Boolean(e.alerted_at),e},re=function(e){var t,n;for(var i in e.created_at=ne(e.created_at),e.updated_at=ne(e.updated_at),e.deleted=ne(e.deleted),e.filesize=X()(e.num_bytes),e.print_set)e.print_set[i].started_at=ne(e.print_set[i].started_at),e.print_set[i].finished_at=ne(e.print_set[i].finished_at),e.print_set[i].cancelled_at=ne(e.print_set[i].cancelled_at),e.print_set[i].ended_at=ne(e.print_set[i].ended_at);return e.print_set.sort((function(e,t){return e.ended_at||t.ended_at?e.ended_at?t.ended_at?e.ended_at>t.ended_at?-1:e.ended_at<t.ended_at?1:0:1:-1:e.started_at>t.started_at?-1:e.started_at<t.started_at?1:0})),e.last_print=e.print_set[0],(null===(t=e.last_print)||void 0===t?void 0:t.cancelled_at)?e.last_print_result="cancelled":(null===(n=e.last_print)||void 0===n?void 0:n.finished_at)&&(e.last_print_result="finished"),e.failedPrints=e.print_set.filter((function(e){return e.cancelled_at})).length,e.successPrints=e.print_set.filter((function(e){return e.finished_at})).length,e.totalPrints=e.print_set.length,e},ae=function(e){return e.created_at=ne(e.created_at),e.updated_at=ne(e.updated_at),e.numItems=e.g_code_file_count+e.g_code_folder_count,e},se=function(e,t){var n={createdAt:function(){return ne(this.created_at)},isOffline:function(){return null===Q()(this,"status",null)},isPaused:function(){return Q()(this,"status.state.flags.paused",!1)},isDisconnected:function(){return Q()(this,"status.state.flags.closedOrError",!0)},isActive:function(){var e=Q()(this,"status.state.flags");return Boolean(e&&e.operational&&(!e.ready||e.paused))},inTransientState:function(){return!this.hasError()&&Q()(this,"status.state.text","").includes("ing")&&!Q()(this,"status.state.text","").includes("Printing")},inUserInteractionRequired:function(){return Q()(this,"status.user_interaction_required",!1)},hasError:function(){return Q()(this,"status.state.flags.error")||Q()(this,"status.state.text","").toLowerCase().includes("error")},isAgentMoonraker:function(){return"moonraker_obico"===Q()(this,"agent_name","")},agentDisplayName:function(){return this.isAgentMoonraker()?"Klipper":"OctoPrint"},basicStreamingInWebrtc:function(){return"octoprint_obico"===Q()(this,"settings.agent_name","")&&te()(Q()(this,"settings.agent_version","0.0.0"),"2.1.0")||"moonraker_obico"===Q()(this,"settings.agent_name","")&&te()(Q()(this,"settings.agent_version","0.0.0"),"0.3.0")},alertUnacknowledged:function(){return Q()(this,"current_print.alerted_at")&&J()(Q()(this,"current_print.alerted_at")).isAfter(J()(Q()(this,"current_print.alert_acknowledged_at")||0))}};return t?(Q()(t,"status._ts",-1)>Q()(e,"status._ts",Q()(t,"status._ts",0))&&delete e.status,Object(a["a"])(Object(a["a"])(Object(a["a"])({},t),e),n)):Object(a["a"])(Object(a["a"])({},e),n)},oe=function(e){return e.created_at=ne(e.created_at),e},ce=n("4f95"),le=n("222b"),de=n.n(le),ue=n("ca14"),pe=n.n(ue),fe=n("3957"),he=n.n(fe),me=n("3ee0"),ve=n.n(me),ge=n("d1d5"),be=n.n(ge),_e={name:"NewOctoPrintTunnelPage",components:{},data:function(){return{user:null,printers:[],printerId:null,printerToAuthorize:null,performingAuthRequest:!1,authorized:!1}},created:function(){this.user=Object(ce["f"])();var e=Object(ce["e"])(),t=e.IS_ENT;this.isEnt=!!t,this.printerId=new URLSearchParams(window.location.search).get("printer_id"),this.user&&this.fetchPrinters()},computed:{printersToShow:function(){var e=this;return this.printerId?this.printers.filter((function(t){return t.id==e.printerId})):this.printers},loginUrl:function(){return"/accounts/login/?hide_navbar=true&next=".concat(encodeURIComponent(window.location.pathname+window.location.search))},signupUrl:function(){return"/accounts/signup/?hide_navbar=true&next=".concat(encodeURIComponent(window.location.pathname+window.location.search))},wizardUrl:function(){return"/printers/wizard/?redirectToTunnelCreation=".concat(encodeURIComponent(window.location.pathname+window.location.search))},appName:function(){return new URLSearchParams(window.location.search).get("app")||"Unknown App"},trialDaysLeft:function(){var e,t;return"pro-trial"!==(null===(e=this.user)||void 0===e||null===(t=e.subscription)||void 0===t?void 0:t.plan_id)?-1:J()(this.user.subscription.expired_at).diff(J()(),"days")+1},appLogo:function(){switch(this.appName.toLowerCase()){case"octopod":return de.a;case"printoid":return ve.a;case"polymer":return he.a;case"octoapp":return pe.a;default:return be.a}}},methods:{fetchPrinters:function(){var e=this;return G.a.get(Y["a"].printers()).then((function(t){t.data.forEach((function(t){e.printers.push(se(t))})),1==e.printersToShow.length&&(e.printerToAuthorize=e.printersToShow[0].id)}))},authorize:function(){var e=this;this.printersToShow.length&&(this.performingAuthRequest=!0,G.a.post(Y["a"].tunnels(),{app_name:this.appName,target_printer_id:this.printerToAuthorize||this.printersToShow[0].id}).then((function(t){e.authorized=!0;var n=t.data.tunnel_endpoint,i=new URLSearchParams(window.location.search).get("success_redirect_url")||"/tunnels/succeeded/";window.location.replace("".concat(i,"?tunnel_endpoint=").concat(n))})).catch((function(t){e.performingAuthRequest=!1,e.$swal.Reject.fire({title:"Oops",text:t.message})})))}}},we=_e,Ce=(n("7dd6"),n("2877")),ye=Object(Ce["a"])(we,V,W,!1,null,"b83edc56",null),ke=ye.exports,Se=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[!e.isPro&&e.usageFetched?n("div",{staticClass:"floating-panel"},[e.showDetails?n("div",{on:{click:function(t){e.showDetails=!1},mouseover:function(t){e.showDetails=!0},mouseleave:function(t){e.showDetails=!1}}},[n("div",{staticClass:"text-muted"},[e._v("Monthly data usage ("),n("a",{attrs:{href:"https://www.obico.io/docs/user-guides/octoprint-tunneling/#is-octoprint-tunneling-free-to-all-users",target:"_blank"}},[e._v("Resets in "+e._s(e.daysUntilReset)+" days")]),e._v(")")]),n("div",{class:e.usageClass},[e._v("Used "+e._s(e.usageMTD)+" of "+e._s(e.humanizedUsageCap)+".")]),e.overage?n("div",[e._v("Your month-to-date tunneling usage is over the Free plan limit. "),n("a",{staticClass:"btn btn-sm btn-primary",attrs:{type:"button",href:"/ent_pub/pricing/"}},[e._v("Get Unlimited Tunneling")])]):e._e()]):n("div",{class:e.usageClass,on:{click:function(t){e.showDetails=!0},mouseover:function(t){e.showDetails=!0},mouseleave:function(t){e.showDetails=!1}}},[e._v(e._s(e.percentage)+"%")])]):e._e(),n("div",[e.printerId?n("iframe",{staticClass:"tunnel-iframe",attrs:{src:e.iframeUrl()+"#temp"}}):e._e()])])},Pe=[],xe=n("6625"),Te=n.n(xe),Oe={name:"OctoPrintTunnelPage",components:{},props:{},data:function(){return{bytesMTD:null,usageCap:null,usageFetched:!1,isPro:!0,printerId:null,showDetails:!1}},computed:{usageClass:function(){return{"text-success":this.bytesMTD<.8*this.usageCap,"text-warning":this.bytesMTD>=.8*this.usageCap&&this.bytesMTD<this.usageCap,"text-danger":this.bytesMTD>=this.usageCap}},usageMTD:function(){return X()(this.bytesMTD)},humanizedUsageCap:function(){return X()(this.usageCap)},overage:function(){return this.bytesMTD>=this.usageCap},percentage:function(){return Math.round(this.bytesMTD/this.usageCap*100)},daysUntilReset:function(){var e=J()().endOf("month");return e.diff(J()(),"days")+1}},created:function(){this.isPro=Object(ce["f"])().is_pro,this.printerId=Te()(window.location.pathname,"/").slice(-2,-1).pop()},mounted:function(){var e=Object(o["a"])()?localStorage.getItem("skip-tunneling-warning"):null;"yes"!==e&&(this.$swal.Prompt.fire({html:'\n          <h4 class="text-center p-2">\n            <svg class="menu-icon" style="height: 1.1em; width: 1em; margin-right: 0.75em;">\n              <use href="#svg-octoprint-tunneling" />\n            </svg>\n            OctoPrint Secure Tunnel\n          </h4>\n          <div class="p-1">\n            It may take long time for OctoPrint page to load as it is securely tunneled via the Obico app server.\n          </div>\n          <div class="p-1">\n            <a target="_blank" href="https://www.obico.io/docs/user-guides/octoprint-tunneling/#is-octoprint-tunneling-free-to-all-users">\n            Learn more about OctoPrint Tunneling\'s security and page load speed.\n            <i class="fas fa-external-link-alt"></i>\n          </a>\n        </div>\n        ',input:"checkbox",inputPlaceholder:"Don't show again"},"octoprint-tunnel.warning").then((function(e){e.isConfirmed&&e.value&&Object(o["a"])()&&localStorage.setItem("skip-tunneling-warning","yes")})),window.matchMedia("(pointer:none), (pointer:coarse)")&&document.querySelector(".swal2-popup").classList.add("x150"));var t=this,n=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];G.a.get(Y["a"].tunnelUsage()).then((function(n){t.bytesMTD=n.data.total,t.usageCap=n.data.monthly_cap,e&&(t.usageFetched=!0)}))};setInterval(n,15e3),setTimeout((function(){n(!0)}),4e3)},methods:{iframeUrl:function(){return"/octoprint/".concat(this.printerId,"/")}}},De=Oe,Ie=(n("a0a4"),n("d4ad"),Object(Ce["a"])(De,Se,Pe,!1,null,"66809798",null)),Ae=Ie.exports,je=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("layout",{scopedSlots:e._u([{key:"content",fn:function(){return[n("b-container",[n("b-row",{staticClass:"justify-content-center"},[n("b-col",{attrs:{lg:"8"}},[n("div",{staticClass:"card"},[n("h5",{staticClass:"card-header text-center"},[e._v(" F "),n("i",{staticClass:"fas fa-search focused-feedback-icon"}),e._v("CUSED FEEDBACK ")]),n("loading",{attrs:{active:null===e.print,"is-full-page":!0}}),null!==e.print?n("div",[e.print.access_consented_at?n("div",[n("div",[n("vue-slick-carousel",{ref:"carousel",attrs:{arrows:!0,dots:!0},on:{afterChange:e.onNextShot},scopedSlots:e._u([{key:"customPaging",fn:function(t){return[n("div",{class:e.pageClass(t)},[e._v("•")])]}}],null,!1,3226812120)},e._l(e.shots,(function(t,i){return n("print-shot-card",{key:i,attrs:{shot:t},on:{shotChanged:e.onShotChanged}})})),1)],1),n("br"),n("div",{staticClass:"card-body p-3"},[n("a",{attrs:{href:"/prints/"}},[n("i",{staticClass:"fas fa-chevron-left"}),e._v(" Time-lapse ")])])]):n("consent",{attrs:{print:e.print},on:{"continue-btn-pressed":e.consentBtnPressed}})],1):e._e()],1)])],1)],1)]},proxy:!0}])})},Ee=[],Fe=n("c707"),Re=n.n(Fe),Ne=n("51f5"),Me=n.n(Ne),Le=n("a7ab"),Be=n.n(Le),$e=(n("7b8d"),n("6a2c"),n("9062")),Ue=n.n($e),ze=(n("e40d"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card-body consent-section"},[n("div",[e._v(" Number of snapshots: "),n("span",{staticClass:"feedback-estimate"},[e._v(e._s(this.print.printshotfeedback_set.length))])]),n("p",[e._v(" Estimated time to finish: "),n("span",{staticClass:"feedback-estimate"},[e._v(e._s(this.estimatedFeedbackTime))])]),e._m(0),n("br"),n("button",{staticClass:"btn btn-primary btn-block",attrs:{disabled:!e.consentChecked,type:"button"},on:{click:function(t){return e.$emit("continue-btn-pressed")}}},[e._v("Start Focused Feedback")]),n("br"),n("div",{staticClass:"custom-control custom-checkbox form-check-inline"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.consentChecked,expression:"consentChecked"}],staticClass:"custom-control-input",attrs:{type:"checkbox",name:"consented",id:"consented-checkbox"},domProps:{checked:Array.isArray(e.consentChecked)?e._i(e.consentChecked,null)>-1:e.consentChecked},on:{change:function(t){var n=e.consentChecked,i=t.target,r=!!i.checked;if(Array.isArray(n)){var a=null,s=e._i(n,a);i.checked?s<0&&(e.consentChecked=n.concat([a])):s>-1&&(e.consentChecked=n.slice(0,s).concat(n.slice(s+1)))}else e.consentChecked=r}}}),e._m(1)]),n("br"),n("div",[n("span",{staticClass:"text-muted"},[e._v("File:")]),e._v(" "+e._s(e.print.filename)+" ")]),n("div",[n("span",{staticClass:"text-muted"},[e._v("Printed:")]),e._v(" "+e._s(e.print.started_at.fromNow())+" ")]),n("br"),e.print.video_url?n("video-box",{attrs:{videoUrl:e.print.video_url,posterUrl:e.print.poster_url,fullScreenBtn:!1}}):n("div",[n("detective-working")],1)],1)}),Ve=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",{staticClass:"font-weight-light"},[e._v(" Help Obi get better at detecting failures by giving her in-depth feedback on the snapshots of the print. You will earn "),n("strong",{staticClass:"text-light"},[e._v("2 non-expirable AI Detection Hours")]),e._v(" after you finish this Focused Feedback. "),n("a",{attrs:{target:"_blank",href:"https://www.obico.io/docs/user-guides/how-does-credits-work/"}},[e._v("Learn more. "),n("small",[n("i",{staticClass:"fas fa-external-link-alt"})])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("label",{staticClass:"custom-control-label",staticStyle:{"font-size":"16px"},attrs:{for:"consented-checkbox"}},[e._v(" I grant the Obico app team members the permission to review the time-lapse video of the print shown on this page. "),n("a",{attrs:{target:"_blank",href:"https://www.obico.io/docs/user-guides/how-does-credits-work#you-need-to-grant-permission-to-tsd-team-to-review-your-time-lapse"}},[e._v("Why is this necessary? "),n("small",[n("i",{staticClass:"fas fa-external-link-alt"})])])])}],We=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card-img-top"},[n("video-player",{ref:"videoPlayer",staticClass:"vjs-default-skin vjs-big-play-centered",attrs:{options:e.playerOptions,playsinline:!0},on:{timeupdate:e.onTimeUpdate}}),e.fullscreenBtn?n("a",{staticClass:"fullscreen-btn",attrs:{role:"button"},on:{click:function(t){return e.$emit("fullscreen")}}},[n("i",{staticClass:"fa fa-expand fa-2x",attrs:{"aria-hidden":"true"}})]):e._e()],1)},qe=[],Ge=(n("fda2"),n("d6d3")),He={name:"VideoBox",components:{videoPlayer:Ge["videoPlayer"]},props:{videoUrl:String,posterUrl:String,fullscreenBtn:{default:function(){return!0},type:Boolean},fluid:{type:Boolean,default:function(){return!0}},autoplay:{type:Boolean,default:function(){return!1}}},computed:{playerOptions:function(){return{muted:!0,preload:"none",language:"en",playbackRates:[.5,1,1.5,2],fluid:this.fluid,fill:!this.fluid,autoplay:this.autoplay,sources:[{type:"video/mp4",src:this.videoUrl}],controlBar:{fullscreenToggle:!1},poster:this.posterUrl}}},methods:{onTimeUpdate:function(e){this.$emit("timeupdate",e.currentTime()/e.duration())}}},Je=He,Ye=(n("b5a7f"),Object(Ce["a"])(Je,We,qe,!1,null,"6f83ffbe",null)),Ke=Ye.exports,Qe=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"card bg-dark text-white"},[i("img",{staticClass:"card-img",attrs:{src:n("0469"),alt:"Obi is still working"}}),e._m(0)])},Ze=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card-img-overlay",staticStyle:{"background-color":"rgba(0,0,0,0.6)"}},[n("h5",{staticClass:"card-title text-center",staticStyle:{padding:"70px 0"}},[e._v("Obi is still busy working on your time-lapse")])])}],Xe={name:"DetectiveWorking"},et=Xe,tt=Object(Ce["a"])(et,Qe,Ze,!1,null,null,null),nt=tt.exports,it={name:"Consent",props:{print:Object},components:{VideoBox:Ke,DetectiveWorking:nt},data:function(){return{consentChecked:!1}},computed:{estimatedFeedbackTime:function(){var e=12*this.print.printshotfeedback_set.length;return e<60?"".concat(e," seconds"):J.a.duration(e,"seconds").humanize()}}},rt=it,at=(n("e3ad"),Object(Ce["a"])(rt,ze,Ve,!1,null,"05780852",null)),st=at.exports,ot=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("img",{staticClass:"card-img-top",attrs:{src:e.shot.image_url}}),n("div",{staticClass:"px-3 pt-4"},[n("b-form-group",{attrs:{label:"Do you see any spaghetti in this picture?"}},[n("b-form-radio-group",{attrs:{options:e.options},on:{change:e.updateShot},model:{value:e.answer,callback:function(t){e.answer=t},expression:"answer"}})],1),e._m(0)],1)])},ct=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("small",{staticClass:"text-muted"},[e._v(" Not sure? Look at "),n("a",{attrs:{target:"_blank",href:"https://www.obico.io/docs/user-guides/how-does-credits-work#spaghetti-examples"}},[e._v("some examples. "),n("small",[n("i",{staticClass:"fas fa-external-link-alt"})])])])}],lt=n("8226"),dt=n("2924"),ut={name:"PrintShotCard",components:{BFormGroup:lt["a"],BFormRadioGroup:dt["a"]},props:{shot:Object},data:function(){return{answer:this.shot.answer,options:[{text:"Yes",value:"LOOKS_BAD"},{text:"No",value:"LOOKS_OK"},{text:"I am not sure",value:"UNDECIDED"}]}},methods:{updateShot:function(e){var t=this;G.a.put(Y["a"].printShotFeedback(this.shot.id,this.shot.print_id),{answer:e}).then((function(e){var n=e.data,i=n.instance,r=n.credited_dhs;r>0?t.$swal.Prompt.fire({title:"You are awesome!",html:"<p>The AI failure detection just got a little better because of your feedback!</p><p>You just earned 2 non-expirable AI Detection Hours - Yay!</p>",confirmButtonText:"I'm done!",showCancelButton:!0,cancelButtonText:"Change feedback"}).then((function(e){e.isConfirmed?window.location.href="/prints/":t.$emit("shotChanged",i)})):t.$emit("shotChanged",i)}))}}},pt=ut,ft=Object(Ce["a"])(pt,ot,ct,!1,null,null,null),ht=ft.exports,mt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"page-wrapper",class:{collapsed:e.collapsed,"is-in-mobile":e.inMobileWebView,"is-in-popup":e.isPopup}},[n("nav",{staticClass:"side-nav"},[n("a",{staticClass:"sidebar-header",attrs:{href:"/"}},[n("svg",{staticClass:"logo-small"},[n("use",{attrs:{href:"#svg-logo-compact"}})])]),n("ul",{staticClass:"list-unstyled m-0"},[e.isEnt&&!e.user.is_pro?n("li",{class:{active:"/ent_pub/pricing/"===e.path}},[e._m(0)]):e._e(),e.user?n("li",{class:{active:"/printers/"===e.path}},[n("a",{attrs:{href:"/printers/"}},[n("svg",{staticStyle:{"margin-bottom":"5px"},attrs:{width:"1.4em",height:"1.4em"}},[n("use",{attrs:{href:"#svg-3d-printer"}})]),n("br"),e._v(" Printers ")])]):e._e(),e.user?n("li",{class:{active:"/prints/"===e.path}},[e._m(1)]):e._e(),e.user?n("li",{class:{active:e.path.includes("/g_code_")}},[e._m(2)]):e._e()]),n("div",{staticClass:"side-nav-footer"},[n("ul",{staticClass:"list-unstyled m-0"},[e.isEnt?n("li",{class:{active:"/ent_pub/pricing/"===e.path}},[e._m(3)]):e._e(),e._m(4),e._m(5),e._m(6),e.user?n("li",{class:{active:"/printer_events/"===e.path}},[n("a",{attrs:{href:"/printer_events/"}},[n("i",{staticClass:"fas fa-bell position-relative"},[e.hasUnseenPrinterEvents?n("span",{staticClass:"badge"},[e._v(e._s(e.unseenPrinterEventsDisplay))]):e._e()]),n("span",{staticClass:"trim-text"},[e._v("Notifications")])])]):e._e(),e.user?n("li",{class:{active:"/user_preferences/"===e.path}},[e._m(7)]):e._e()])])]),n("div",{staticClass:"content-wrapper",class:{"hide-top-nav":!e.$slots.topBarLeft&&!e.$slots.topBarRight}},[n("b-navbar",{staticClass:"top-nav"},[n("div",{staticClass:"d-flex align-items-center"},[n("b-button",{staticClass:"shadow-none p-0 mr-3 position-relative toggle-sidebar",attrs:{variant:"_"},on:{click:function(t){e.collapsed=!e.collapsed}}},[n("i",{staticClass:"fas fa-bars position-relative"},[e.hasUnseenPrinterEvents?n("div",{staticClass:"notification-dot"},[n("svg",{attrs:{width:"8px",height:"8px"}},[n("use",{attrs:{href:"#svg-circle-icon"}})])]):e._e()])]),e._t("topBarLeft")],2),e._t("topBarRight")],2),n("div",{staticClass:"page-content"},[e.layoutSections.contentTop?n("content-top"):e._e(),e._t("content")],2)],1),n("div",{staticClass:"content-overlay",on:{click:function(t){e.collapsed=!0}}})])},vt=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{staticClass:"primary",attrs:{href:"/ent_pub/pricing/"}},[n("i",{staticClass:"fas fa-star"}),e._v(" Upgrade to Pro ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{attrs:{href:"/prints/"}},[n("i",{staticClass:"fas fa-video"}),e._v(" Time-Lapses ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{attrs:{href:"/g_code_folders/cloud/"}},[n("i",{staticClass:"fas fa-file-code"}),e._v(" G-Codes ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{attrs:{href:"/ent_pub/pricing/"}},[n("i",{staticClass:"fas fa-dollar-sign"}),e._v(" Pricing ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",[n("a",{attrs:{href:"https://www.obico.io/help/",target:"_blank"}},[n("i",{staticClass:"fas fa-question"}),e._v(" Help ")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",[n("a",{attrs:{href:"https://obico.io/discord",target:"_blank"}},[n("i",{staticClass:"fas fa-comments"}),e._v(" Community ")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("li",[n("hr",{staticClass:"my-0 mx-2"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{attrs:{href:"/user_preferences/"}},[n("i",{staticClass:"fas fa-cog"}),n("span",{staticClass:"trim-text"},[e._v("Preferences")])])}],gt={},bt={name:"Layout",components:Object(a["a"])({},Object.keys(gt).reduce((function(e,t){return Object.assign(e,Object(N["a"])({},t,gt[t].importComponent))}),{})),props:{isPopup:{type:Boolean,default:!1}},data:function(){return{layoutSections:gt,collapsed:!0,path:window.location.pathname,user:null,allowSignUp:!1,isEnt:!1}},computed:{inMobileWebView:function(){return Object(ce["a"])()},hasUnseenPrinterEvents:function(){return Q()(this.user,"unseen_printer_events",0)>0},unseenPrinterEventsDisplay:function(){var e=Q()(this.user,"unseen_printer_events",0);return e>99?"99+":e}},created:function(){var e=Object(ce["e"])(),t=e.ACCOUNT_ALLOW_SIGN_UP,n=e.IS_ENT;this.allowSignUp=!!t,this.isEnt=!!n,this.user=Object(ce["f"])()},mounted:function(){var e=document.querySelector(".message-snippet");e&&this.inMobileWebView&&e.classList.add("is-in-mobile"),this.inMobileWebView&&(document.querySelector("body").style.paddingBottom=0)}},_t=bt,wt=(n("7992"),n("e152"),Object(Ce["a"])(_t,mt,vt,!1,null,"098964e5",null)),Ct=wt.exports,yt={name:"PrintShotFeedbackApp",components:{Consent:st,Loading:Ue.a,PrintShotCard:ht,VueSlickCarousel:Be.a,Layout:Ct},props:{config:{default:function(){},type:Object}},data:function(){return{shots:[],currentShot:0,print:null}},computed:{},mounted:function(){this.fetchData()},methods:{fetchData:function(){var e=this;G.a.get(Y["a"].print(this.config.printId)).then((function(t){e.print=ie(t.data),e.shots=Re()(e.print.printshotfeedback_set,"id")}))},updatePrint:function(e){var t=this;G.a.patch(Y["a"].print(this.print.id),e).then((function(e){return t.print=e.data}))},consentBtnPressed:function(){this.updatePrint({access_consented_at:J()()})},onShotChanged:function(e){var t=Me()(this.shots,(function(t){return t.id==e.id}));this.$set(this.shots,t,e),this.$refs.carousel.next()},onNextShot:function(e){this.currentShot=e},pageClass:function(e){return e===this.currentShot?"page-visiting":this.shots[e].answered_at?"text-success":"page-unvisited"}}},kt=yt,St=(n("90d8"),Object(Ce["a"])(kt,je,Ee,!1,null,"26c8d4dc",null)),Pt=St.exports,xt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("layout",{scopedSlots:e._u([{key:"topBarLeft",fn:function(){return[n("div",{staticClass:"actions-with-selected-desktop"},[n("b-form-group",{staticClass:"m-0"},[n("b-form-checkbox",{attrs:{size:"lg"},model:{value:e.allPrintsSelected,callback:function(t){e.allPrintsSelected=t},expression:"allPrintsSelected"}})],1),n("div",[n("span",{directives:[{name:"show",rawName:"v-show",value:!e.selectedPrintIds.size,expression:"!selectedPrintIds.size"}],staticClass:"label",on:{click:function(t){e.allPrintsSelected=!e.allPrintsSelected}}},[e._v("Select all")]),n("b-dropdown",{directives:[{name:"show",rawName:"v-show",value:e.selectedPrintIds.size,expression:"selectedPrintIds.size"}],attrs:{"toggle-class":"btn btn-sm actions-with-selected-btn"},scopedSlots:e._u([{key:"button-content",fn:function(){return[e._v(" "+e._s(e.selectedPrintIds.size)+" item"+e._s(1===e.selectedPrintIds.size?"":"s")+" selected... ")]},proxy:!0}])},[n("b-dropdown-item",[n("div",{staticClass:"text-danger",on:{click:e.onDeleteBtnClick}},[n("i",{staticClass:"far fa-trash-alt"}),e._v("Delete ")])])],1)],1)],1)]},proxy:!0},{key:"topBarRight",fn:function(){return[n("div",[n("a",{staticClass:"btn shadow-none icon-btn d-none d-md-inline",attrs:{href:"/prints/upload/",title:"Upload Time-Lapse"}},[n("i",{staticClass:"fas fa-upload"})]),n("b-dropdown",{attrs:{right:"","no-caret":"","toggle-class":"icon-btn"},scopedSlots:e._u([{key:"button-content",fn:function(){return[n("i",{staticClass:"fas fa-ellipsis-v"})]},proxy:!0}])},[n("b-dropdown-item",{staticClass:"d-md-none",attrs:{href:"/prints/upload/"}},[n("i",{staticClass:"fas fa-upload"}),e._v("Upload Time-Lapse ")]),n("b-dropdown-divider",{staticClass:"d-md-none"}),n("cascaded-dropdown",{attrs:{menuOptions:e.menuOptions,menuSelections:e.menuSelections},on:{menuSelectionChanged:e.menuSelectionChanged}})],1)],1)]},proxy:!0},{key:"content",fn:function(){return[e.shouldShowFilterWarning?n("a",{staticClass:"active-filter-notice",on:{click:e.onShowAllClicked}},[n("div",{staticClass:"filter"},[n("i",{staticClass:"fas fa-filter mr-2"}),e._v(" "+e._s(e.activeFiltering)+" ")]),n("div",[e._v("SHOW ALL")])]):e._e(),n("b-container",[n("b-row",{directives:[{name:"show",rawName:"v-show",value:e.prints.length,expression:"prints.length"}],staticClass:"print-cards"},e._l(e.prints,(function(t){return n("print-card",{key:t.id,attrs:{print:t,selected:e.selectedPrintIds.has(t.id)},on:{selectedChanged:e.onSelectedChanged,printDeleted:e.onPrintDeleted,printDataChanged:e.printDataChanged,fullscreen:e.openFullScreen}})})),1),n("mugen-scroll",{staticClass:"text-center p-4",attrs:{handler:e.fetchMoreData,"should-handle":!e.loading}},[e.noMoreData?n("div",{staticClass:"text-center p-2"},[e._v("No more time-lapses.")]):e._e(),e.noMoreData?e._e():n("b-spinner",{attrs:{label:"Loading..."}})],1),n("b-modal",{attrs:{id:"tl-fullscreen-modal",size:"full",hideHeader:!0,hideFooter:!0},on:{hidden:e.fullScreenClosed}},[n("FullScreenPrintCard",{attrs:{print:e.fullScreenPrint,videoUrl:e.fullScreenPrintVideoUrl,autoplay:!0}})],1)],1)]},proxy:!0}])})},Tt=[],Ot=(n("a630"),n("6062"),n("996c")),Dt=n.n(Ot),It=n("dd61"),At=n.n(It),jt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"col-sm-12 col-md-6 col-lg-4 print-card"},[n("div",{staticClass:"card vld-parent"},[e.isPublic?n("div",{staticClass:"card-header"},[e._v(" - By "+e._s(e.print.creator_name)+" ")]):n("div",{staticClass:"card-header"},[n("div",{style:{visibility:e.hasSelectedChangedListener?"visible":"hidden"}},[n("b-form-checkbox",{staticClass:"text-decoration-none",attrs:{size:"lg"},on:{change:e.onSelectedChange},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1),n("b-form-radio-group",{attrs:{buttons:"","button-variant":"outline-primary",name:"radio-btn-outline"},model:{value:e.selectedCardView,callback:function(t){e.selectedCardView=t},expression:"selectedCardView"}},[n("b-form-radio",{staticClass:"no-corner no-shadow",attrs:{value:"detective",disabled:!e.canShowDetectiveView}},[n("i",{staticClass:"fas fa-balance-scale"})]),n("b-form-radio",{staticClass:"no-corner no-shadow",attrs:{value:"info"}},[n("i",{staticClass:"fas fa-info"})])],1),n("b-dropdown",{attrs:{right:"","no-caret":"","toggle-class":"icon-btn"},scopedSlots:e._u([{key:"button-content",fn:function(){return[n("i",{staticClass:"fas fa-ellipsis-v"})]},proxy:!0}])},[this.print.video_url&&!e.print.video_archived_at?n("b-dropdown-item",{on:{click:function(t){return t.preventDefault(),function(){return e.downloadFile(e.print.video_url,e.print.id+".mp4")}()}}},[n("i",{staticClass:"fas fa-download"}),e._v("Download Original Time-lapse ")]):e._e(),this.print.tagged_video_url&&!e.print.video_archived_at?n("b-dropdown-item",{on:{click:function(t){return t.preventDefault(),function(){return e.downloadFile(e.print.tagged_video_url,e.print.id+"_tagged.mp4")}()}}},[n("i",{staticClass:"fas fa-download"}),e._v("Download Detective Time-lapse ")]):e._e(),n("b-dropdown-divider"),n("b-dropdown-item",{on:{click:e.deleteVideo}},[n("span",{staticClass:"text-danger"},[n("i",{staticClass:"fas fa-trash-alt"}),e._v("Delete ")])])],1)],1),n("div",[e.print.video_archived_at?n("div",{staticClass:"position-relative"},[n("div",{staticClass:"poster-placeholder-wrapper"},[n("svg",{staticClass:"poster-placeholder"},[n("use",{attrs:{href:e.posterSrc}})])]),n("div",{staticClass:"archived-info"},[n("div",{staticClass:"text"},[e._v("Video file is deleted. "),n("a",{attrs:{href:"#"},on:{click:function(t){return e.showVideoArchivedDescription(t)}}},[e._v("Why?")])])])]):n("div",[e.videoUrl?n("video-box",{attrs:{videoUrl:e.videoUrl,posterUrl:e.print.poster_url,fluid:!0,fullscreenBtn:e.hasFullscreenListener},on:{timeupdate:e.onTimeUpdate,fullscreen:function(t){return e.$emit("fullscreen",e.print.id,e.videoUrl)}}}):n("div",[n("detective-working")],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:"info"==e.cardView&&!e.isPublic,expression:"cardView == 'info' && !isPublic"}]},[n("div",{staticClass:"card-body"},[n("div",{staticClass:"container"},[n("div",{staticClass:"row"},[e._m(0),n("div",{staticClass:"col-8"},[e._v(e._s(e.print.filename))])]),n("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"row",attrs:{title:this.humanizedPrintedOrUploadedTime(e.longFormat=!0)}},[n("div",{staticClass:"text-muted col-4"},[e._v(" "+e._s(e.wasTimelapseUploaded?"Uploaded":"Printed")+" "),n("span",{staticClass:"float-right"},[e._v(":")])]),n("div",{staticClass:"col-8"},[e._v(e._s(this.humanizedPrintedOrUploadedTime())+" "+e._s(e.endStatus))])]),!e.wasTimelapseUploaded&&e.duration?n("div",{staticClass:"row",attrs:{id:"dur-"+e.print.id}},[n("b-tooltip",{attrs:{target:"dur-"+e.print.id,triggers:"hover"}},[e._v(" "+e._s(e._f("floor")(e._f("duration")(e.duration,"asHours")))+":"+e._s(e._f("duration")(e.duration,"minutes"))+":"+e._s(e._f("duration")(e.duration,"seconds"))+" ")]),e._m(1),n("div",{staticClass:"col-8"},[e._v(e._s(e.duration.humanize()))])],1):e._e()])])]),e.isPublic?n("div",{staticClass:"bg-warning alert-banner text-center",style:{opacity:e.normalizedP>.4?1:0}},[n("i",{staticClass:"fas fa-exclamation-triangle"}),e._v(" Possible failure detected! ")]):e._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:"detective"==e.cardView||e.isPublic,expression:"cardView == 'detective' || isPublic"}]},[e.print.prediction_json_url?n("gauge",{attrs:{normalizedP:e.normalizedP}}):e._e(),e.isPublic?e._e():n("div",{staticClass:"feedback-section"},[n("div",{staticClass:"text-center py-2 px-3"},[n("div",{staticClass:"lead",class:[e.print.alerted_at?"text-danger":"text-success"]},[e._v(e._s(e.print.alerted_at?"Failure detected":"No failure detected"))]),n("div",{staticClass:"py-2"},[e._v(" Did we get it right? "),n("b-button",{staticClass:"mx-2 btn-sm",attrs:{variant:e.thumbedUp?"primary":"outline"},on:{click:e.onThumbUpClick}},[e.inflightAlertOverwrite?n("b-spinner",{attrs:{type:"grow",small:""}}):n("i",{staticClass:"fas fa-thumbs-up"})],1),n("b-button",{staticClass:"mx-2 btn-sm",attrs:{variant:e.thumbedDown?"primary":"outline"},on:{click:e.onThumbDownClick}},[e.inflightAlertOverwrite?n("b-spinner",{attrs:{type:"grow",small:""}}):n("i",{staticClass:"fas fa-thumbs-down"})],1)],1),n("transition",{attrs:{name:"bounce"}},[e.focusedFeedbackEligible?n("div",{staticClass:"pt-2"},[n("a",{staticClass:"btn btn-sm btn-outline-primary px-4",attrs:{role:"button",href:e.focusedFeedbackLink}},[e._v(" F "),n("i",{staticClass:"fas fa-search focused-feedback-icon"}),e._v("CUSED FEEDBACK "),e.focusedFeedbackCompleted?e._e():n("svg",{staticClass:"seg-control-icon ml-1 double-hours-icon"},[n("use",{attrs:{href:"#svg-hour-double"}})])])]):e._e()])],1),n("div",{staticClass:"text-muted py-2 px-3 help-text"},[e.focusedFeedbackEligible?n("small",[e.focusedFeedbackCompleted?n("span",[e._v("Thank you for completing the Focused Feedback. You have earned 2 non-expirable AI Detection Hours. You can click the button again to change your feedback.")]):n("span",[e._v(" With Focused Feedback, you can tell us exactly where we got it wrong. This is the most effective way to help us improve. "),n("a",{attrs:{href:"https://www.obico.io/docs/user-guides/how-does-credits-work#you-earn-detective-hours-for-giving-focused-feedback"}},[e._v("You will earn 2 AI Detection Hours once you finish the Focused Feedback")]),e._v(". ")])]):n("small",[e._v(" Every time you give us feedback, "),n("a",{attrs:{href:"https://www.obico.io/docs/user-guides/how-does-credits-work/"}},[e._v("you help us get better at detecting failures")]),e._v(". ")])])])],1)])])])},Et=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"text-muted col-4"},[e._v(" File "),n("span",{staticClass:"float-right"},[e._v(":")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"text-muted col-4"},[e._v(" Duration "),n("span",{staticClass:"float-right"},[e._v(":")])])}],Ft=n("9380"),Rt=n.n(Ft),Nt=n("b279"),Mt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"obico-gauge-container"},[n("span",{style:{color:e.titleColor},attrs:{id:"title"}},[e._v(e._s(e.titleText))]),n("div",{staticClass:"obico-gauge"},[n("radial-gauge",{attrs:{value:e.value,options:e.computedOptions}})],1),n("hr")])},Lt=[],Bt=(n("a9e3"),n("7489")),$t=n("59cf"),Ut={name:"Gauge",components:{RadialGauge:Bt["a"]},data:function(){return{}},props:{normalizedP:{type:Number},isWatching:{type:Boolean,default:!0},options:{type:Object,default:null}},computed:{computedOptions:function(){if(null!==this.options)return this.options;var e={highlight1:Object(D["a"])()===$t["a"].Light?"#929292":"#8395a7",highlight2:Object(D["a"])()===$t["a"].Light?"#b7b7b7":"#a8bacc",highlight3:Object(D["a"])()===$t["a"].Light?"#7b7b7b":"#6c7e90",needle:Object(D["a"])()===$t["a"].Light?"#2d3e4f":"#ffffff"};return{valueDec:0,valueInt:0,width:240,height:240,units:!1,box:!1,minValue:0,maxValue:100,majorTicks:["","","",""],minorTicks:4,highlights:[{from:0,to:33,color:this.isWatching?"#5cb85c":e.highlight1},{from:33,to:67,color:this.isWatching?"#f0ad4e":e.highlight2},{from:67,to:100,color:this.isWatching?"#d9534f":e.highlight3}],colorPlate:"rgba(255,255,255,.0)",colorTitle:"#5cb85c",colorStrokeTicks:"#EBEBEB",colorNeedleEnd:this.isWatching?"rgba(255, 160, 122, .9)":e.needle,colorNeedle:this.isWatching?"rgba(240, 128, 128, 1)":e.needle,colorNeedleShadowUp:this.isWatching?"rgba(2,255,255,0.2)":e.needle,valueBox:!1,animationRule:"bounce",animationDuration:500,animatedValue:!0,startAngle:90,ticksAngle:180,borders:!1}},value:function(){return 100*this.normalizedP},titleText:function(){switch(this.level()){case 0:return"Looking Good";case 1:return"Fishy...";case 2:return"Failing!";default:return"Looking Good"}},titleColor:function(){switch(this.level()){case 0:return"#5cb85c";case 1:return"#f0ad4e";case 2:return"#d9534f";default:return"#5cb85c"}}},methods:{level:function(){return this.value>66?2:this.value>33?1:0}}},zt=Ut,Vt=(n("2e84"),Object(Ce["a"])(zt,Mt,Lt,!1,null,"6763f78b",null)),Wt=Vt.exports,qt={name:"PrintCard",components:{VideoBox:Ke,Gauge:Wt,DetectiveWorking:nt},data:function(){return{ALERT_THRESHOLD:.4,currentPosition:0,predictions:[],selectedCardView:"detective",inflightAlertOverwrite:null}},props:{print:Object,isPublic:{type:Boolean,default:!1},selected:{type:Boolean,default:!1}},computed:{wasTimelapseUploaded:function(){return null!==this.print.uploaded_at},endStatus:function(){return this.print.cancelled_at?"(Cancelled)":""},duration:function(){return this.print.ended_at&&this.print.started_at?J.a.duration(this.print.ended_at.diff(this.print.started_at)):null},canShowDetectiveView:function(){return null!==this.print.prediction_json_url&&null!==this.print.tagged_video_url||!!(this.print.uploaded_at&&J()().diff(this.print.uploaded_at,"hours")<24)},cardView:function(){return this.canShowDetectiveView?this.selectedCardView:"info"},videoUrl:function(){return"info"==this.cardView?this.print.video_url:this.print.tagged_video_url},thumbedUp:function(){return!!this.print.alert_overwrite&&this.print.has_alerts^"NOT_FAILED"===this.print.alert_overwrite},thumbedDown:function(){return!!this.print.alert_overwrite&&this.print.has_alerts^"FAILED"===this.print.alert_overwrite},focusedFeedbackEligible:function(){return this.print.printshotfeedback_set.length>0&&this.print.alert_overwrite},focusedFeedbackCompleted:function(){return this.print.printshotfeedback_set.length>0&&0==Rt()(this.print.printshotfeedback_set,(function(e){return!e.answered_at})).length},focusedFeedbackLink:function(){return"/prints/shot-feedback/".concat(this.print.id,"/")},hasSelectedChangedListener:function(){return Boolean(this.$listeners&&this.$listeners.selectedChanged)},hasFullscreenListener:function(){return Boolean(this.$listeners&&this.$listeners.fullscreen)},normalizedP:function(){return Object(Nt["b"])(this.predictions,this.currentPosition,this.isPublic)},posterSrc:function(){return this.print.poster_url||"#svg-3d-printer"}},methods:{downloadFile:function(e,t){fetch(e).then((function(e){return e.blob()})).then((function(e){var n=document.createElement("a");n.setAttribute("download",t);var i=URL.createObjectURL(e);n.href=i,n.setAttribute("target","_blank"),n.click(),URL.revokeObjectURL(i)}))},onTimeUpdate:function(e){this.currentPosition=e},onSelectedChange:function(){this.$emit("selectedChanged",this.print.id,!this.selected)},deleteVideo:function(){var e=this;G.a.delete(Y["a"].print(this.print.id)).then((function(){e.$emit("printDeleted",e.print.id)}))},onThumbUpClick:function(){this.inflightAlertOverwrite=this.print.has_alerts?"FAILED":"NOT_FAILED",this.alertOverwrite(this.inflightAlertOverwrite)},onThumbDownClick:function(){this.inflightAlertOverwrite=this.print.has_alerts?"NOT_FAILED":"FAILED",this.alertOverwrite(this.inflightAlertOverwrite)},alertOverwrite:function(e){var t=this;G.a.patch(Y["a"].print(this.print.id),{alert_overwrite:e}).then((function(e){t.$emit("printDataChanged",e.data),t.inflightAlertOverwrite=null}))},fetchPredictions:function(){var e=this;G.a.get(this.print.prediction_json_url).then((function(t){e.predictions=t.data}))},humanizedPrintedOrUploadedTime:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.print.uploaded_at&&!this.print.ended_at)return"-";var t=this.wasTimelapseUploaded?this.print.uploaded_at:this.print.ended_at;return e?t.format("LLLL"):t.fromNow()},showVideoArchivedDescription:function(e){e.preventDefault(),this.$swal.Prompt.fire({title:"Time-lapse video deleted",html:'\n          <p>Time-lapse videos older than 6-months are deleted from the Obico app server as they are rarely needed and cost significant amount to store in the cloud.</p>\n          <p>If you are a Pro subscriber and you don\'t want your time-lapse videos to be deleted, please <a href="mailto:support@obico.io?subject=Please%20keep%20my%20timelapse%20videos">contact us</a>.</p>\n          ',showCloseButton:!0})}},mounted:function(){this.print.prediction_json_url&&this.fetchPredictions(),this.print.tagged_video_url||(this.selectedCardView="info")}},Gt=qt,Ht=(n("a180"),Object(Ce["a"])(Gt,jt,Et,!1,null,"24ba5886",null)),Jt=Ht.exports,Yt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("video-box",{attrs:{videoUrl:e.videoUrl,posterUrl:e.print.poster_url,fluid:!1,autoplay:e.autoplay,fullscreenBtn:!1},on:{timeupdate:e.onTimeUpdate}}),e.isPublic?n("div",{staticClass:"bg-warning alert-banner text-center",style:{opacity:e.normalizedP>.4?1:0}},[n("i",{staticClass:"fas fa-exclamation-triangle"}),e._v(" Possible failure detected! ")]):e._e(),n("gauge",{attrs:{normalizedP:e.normalizedP}})],1)},Kt=[],Qt={name:"FullScreenPrintCard",components:{VideoBox:Ke,Gauge:Wt},props:{print:{type:Object,required:!0},videoUrl:{type:String,required:!0},initialPosition:{type:Number,default:function(){return 0}},autoplay:{type:Boolean,default:function(){return!1}},isPublic:{type:Boolean,default:!1}},data:function(){return{currentPosition:0,predictions:[]}},computed:{normalizedP:function(){return Object(Nt["b"])(this.predictions,this.currentPosition,this.isPublic)}},methods:{onTimeUpdate:function(e){this.currentPosition=e},fetchPredictions:function(){var e=this;G.a.get(this.print.prediction_json_url).then((function(t){e.predictions=t.data}))}},mounted:function(){this.print.prediction_json_url&&this.fetchPredictions()}},Zt=Qt,Xt=(n("c44a"),Object(Ce["a"])(Zt,Yt,Kt,!1,null,"6c992524",null)),en=Xt.exports,tn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[null===e.menuExpanded?e._l(e.menuOptions,(function(t,i){return n("b-dropdown-item",{key:i},[n("div",{staticClass:"d-flex justify-content-between clickable-area",on:{click:function(t){t.stopPropagation(),t.preventDefault(),e.menuExpanded=i}}},[n("div",[n("i",{class:t.iconClass}),e.activeItems[i]?n("span",[e._v(" "+e._s(e.activeItems[i].title)+" "),e.activeItems[i].iconClass?n("i",{class:e.activeItems[i].iconClass}):e._e()]):n("span",[e._v(" "+e._s(i)+" ")])]),n("div",[n("i",{staticClass:"fas fa-chevron-right m-0"})])])])})):e._e(),null!==e.menuExpanded?[n("b-dropdown-item",[n("div",{staticClass:"clickable-area",on:{click:function(t){t.stopPropagation(),t.preventDefault(),e.menuExpanded=null}}},[n("i",{staticClass:"fas fa-chevron-left"}),e._v("Back ")])]),e._l(e.menuOptions[e.menuExpanded].options,(function(t){return n("b-dropdown-item",{key:t.value},[n("div",{staticClass:"clickable-area",on:{click:function(n){return e.onSelected(t)}}},[n("i",{staticClass:"fas fa-check text-primary",style:{visibility:e.menuSelections[e.menuExpanded]===t.value?"visible":"hidden"}}),e._v(" "+e._s(t.title)+" "),t.iconClass?n("i",{class:t.iconClass}):e._e()])])}))]:e._e()],2)},nn=[],rn={name:"CascadedDropdown",data:function(){return{menuExpanded:null}},props:{menuOptions:Object,menuSelections:Object},methods:{onSelected:function(e){this.$emit("menuSelectionChanged",this.menuExpanded,e),this.menuExpanded=null}},computed:{activeItems:function(){for(var e=this,t={},n=function(){var n=r[i];t[n]=e.menuOptions[n].options.filter((function(t){return t.value===e.menuSelections[n]}))[0]},i=0,r=Object.keys(this.menuSelections);i<r.length;i++)n();return t}}},an=rn,sn=Object(Ce["a"])(an,tn,nn,!1,null,null,null),on=sn.exports,cn={filtering:"prints-filtering",sorting:"prints-sorting"},ln=6,dn={name:"PrintsPage",components:{MugenScroll:Dt.a,PrintCard:Jt,FullScreenPrintCard:en,Layout:Ct,CascadedDropdown:on},data:function(){return{prints:[],selectedPrintIds:new Set,loading:!1,noMoreData:!1,fullScreenPrint:null,fullScreenPrintVideoUrl:null,menuSelections:{"Sort By":c(cn.sorting,"date_desc"),"Filter By":c(cn.filtering,"none")},menuOptions:{"Sort By":{iconClass:"fas fa-sort-amount-up",options:[{value:"date_asc",title:"Sort By Date",iconClass:"fas fa-long-arrow-alt-up"},{value:"date_desc",title:"Sort By Date",iconClass:"fas fa-long-arrow-alt-down"}]},"Filter By":{iconClass:"fas fa-filter",options:[{value:"none",title:"All"},{value:"finished",title:"Succeeded"},{value:"cancelled",title:"Cancelled"},{value:"need_alert_overwrite",title:"Review Needed"},{value:"need_print_shot_feedback",title:"Focused-Review Needed"}]}}}},computed:{allPrintsSelected:{get:function(){return this.selectedPrintIds.size>=this.prints.length&&0!==this.prints.length},set:function(e){this.selectedPrintIds=e?new Set(At()(this.prints,"id")):new Set}},shouldShowFilterWarning:function(){return"none"!==this.menuSelections["Filter By"]},activeFiltering:function(){var e=this,t=this.menuOptions["Filter By"].options.filter((function(t){return t.value===e.menuSelections["Filter By"]}));return t.length?t[0].title:null}},created:function(){this.refetchData()},methods:{fetchMoreData:function(){var e=this;this.noMoreData||(this.loading=!0,G.a.get(Y["a"].prints(),{params:{start:this.prints.length,limit:ln,filter:this.menuSelections["Filter By"],sorting:this.menuSelections["Sort By"]}}).then((function(t){var n;e.loading=!1,e.noMoreData=t.data.length<ln,(n=e.prints).push.apply(n,Object(R["a"])(t.data.map((function(e){return ie(e)}))))})))},refetchData:function(){this.prints=[],this.selectedPrintIds=new Set,this.noMoreData=!1,this.fetchMoreData()},onSelectedChanged:function(e,t){var n=new Set(this.selectedPrintIds);t?n.add(e):n.delete(e),this.selectedPrintIds=n},menuSelectionChanged:function(e,t){this.$set(this.menuSelections,e,t.value);var n="Sort By"===e?cn.sorting:cn.filtering;l(n,t.value),this.refetchData()},onDeleteBtnClick:function(){var e=this,t=Array.from(this.selectedPrintIds);this.$swal.Prompt.fire({title:"Are you sure?",text:"Delete ".concat(this.selectedPrintIds.size," print(s)? This action can not be undone."),showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"No"}).then((function(n){n.isConfirmed&&G.a.post(Y["a"].printsBulkDelete(),{print_ids:t}).then((function(){t.forEach((function(t){return e.onPrintDeleted(t,!1)})),e.$swal.Toast.fire({title:"".concat(t.length," time-lapse(s) deleted!")}),e.selectedPrintIds=new Set}))}))},onPrintDeleted:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Me()(this.prints,(function(t){return t.id==e})),i=this.prints[n];this.$delete(this.prints,n),t&&this.$swal.Toast.fire({title:"Time-lapse ".concat(i.filename," deleted!")})},printDataChanged:function(e){var t=Me()(this.prints,(function(t){return t.id==e.id}));this.$set(this.prints,t,ie(e))},openFullScreen:function(e,t){var n=Me()(this.prints,(function(t){return t.id==e}));-1!=n&&(this.fullScreenPrint=this.prints[n],this.fullScreenPrintVideoUrl=t,this.$bvModal.show("tl-fullscreen-modal"))},fullScreenClosed:function(){this.fullScreenPrint=null,this.fullScreenPrintVideoUrl=null},onShowAllClicked:function(){this.$set(this.menuSelections,"Filter By","none"),l(cn.filtering,"none"),this.refetchData()}}},un=dn,pn=(n("3252"),Object(Ce["a"])(un,xt,Tt,!1,null,"59d5e13b",null)),fn=pn.exports,hn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("layout",{scopedSlots:e._u([{key:"content",fn:function(){return[n("b-container",[n("b-row",{staticClass:"justify-content-center"},[e.print?n("print-card",{staticClass:"m-0",attrs:{print:e.print},on:{printDeleted:e.onPrintDeleted,printDataChanged:e.printDataChanged}}):e._e()],1)],1)]},proxy:!0}])})},mn=[],vn={name:"PrintPage",components:{PrintCard:Jt,Layout:Ct},props:{config:Object},data:function(){return{print:null}},created:function(){this.fetchData()},methods:{fetchData:function(){var e=this;G.a.get(Y["a"].print(this.config.printId)).then((function(t){e.print=ie(t.data)}))},onPrintDeleted:function(){window.location.href="/prints/"},printDataChanged:function(){this.fetchData()}}},gn=vn,bn=Object(Ce["a"])(gn,hn,mn,!1,null,"6bb89ef6",null),_n=bn.exports,wn=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("layout",{scopedSlots:e._u([{key:"content",fn:function(){return[i("b-container",[i("b-row",{staticClass:"justify-content-center"},[i("b-col",{staticClass:"text-center",attrs:{lg:"8"}},[i("h1",{staticClass:"pb-2"},[e._v("Upload Time-lapse")]),i("p",{staticClass:"pb-2"},[e._v("Upload time-lapse videos to test Obico's AI failure detection.")]),i("vue-dropzone",{staticClass:"upload-box",attrs:{id:"dropzone",options:e.dropzoneOptions,useCustomSlot:!0},on:{"vdropzone-success":e.printUploadSuccess}},[i("div",{staticClass:"dz-message needsclick"},[i("i",{staticClass:"fas fa-upload fa-2x"}),e._v(" "),i("br"),e._v(" Drop files here or click to upload."),i("br"),e._v(" *.mp4 or *.mpg files only. Up to 100MB each. ")])]),i("div",{directives:[{name:"show",rawName:"v-show",value:e.uploaded,expression:"uploaded"}],staticClass:"pt-5"},[i("div",{attrs:{id:"tl-uploaded"}},[i("img",{staticClass:"detective-working",attrs:{src:n("0469")}}),i("div",{staticClass:"py-2 text-center"},[i("div",{staticClass:"py-2"},[e._v("The Obico Server is running failure detection on the time-lapse video(s) you uploaded.")]),i("div",[e._v("We will send you email when it is done.")]),i("a",{attrs:{href:"/prints/"}},[e._v("Check status now >>>")])])])])],1)],1)],1)]},proxy:!0}])})},Cn=[],yn=n("92c3"),kn=n.n(yn),Sn=(n("1e3f"),{name:"UploadPrintPage",components:{vueDropzone:kn.a,Layout:Ct},props:{csrf:{type:String,requeired:!0}},data:function(){return{dropzoneOptions:{withCredentials:!0,maxFilesize:100,timeout:36e5,acceptedFiles:"video/mp4, video/mpeg",url:"?",headers:{"X-CSRFToken":this.csrf}},uploaded:!1}},methods:{printUploadSuccess:function(e){console.log(e),this.uploaded=!0}}}),Pn=Sn,xn=(n("8bc4"),Object(Ce["a"])(Pn,wn,Cn,!1,null,"74b3f054",null)),Tn=xn.exports,On=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("layout",{scopedSlots:e._u([{key:"topBarRight",fn:function(){return[n("div",[e.isEnt?n("a",{staticClass:"btn shadow-none hours-btn d-none d-md-inline",attrs:{href:"/user_preferences/dh/",title:e.dhBadgeNum+" AI Detection Hours"}},[n("svg",[n("use",{attrs:{href:"#svg-detective-hours"}})]),n("span",{staticClass:"badge badge-light",attrs:{id:"user-credits"}},[e._v(e._s(e.dhBadgeNum))]),n("span",{staticClass:"sr-only"},[e._v("AI Detection Hours")])]):e._e(),n("a",{staticClass:"btn shadow-none icon-btn d-none d-md-inline",attrs:{href:"/printers/wizard/",title:"Link New Printer"}},[n("i",{staticClass:"fas fa-plus"})]),n("b-dropdown",{attrs:{right:"","no-caret":"","toggle-class":"icon-btn"},scopedSlots:e._u([{key:"button-content",fn:function(){return[n("i",{staticClass:"fas fa-ellipsis-v"})]},proxy:!0}])},[e.isEnt?n("b-dropdown-item",{staticClass:"d-md-none",attrs:{href:"/user_preferences/dh/"}},[n("i",{staticClass:"fas fa-hourglass-half"}),e._v(e._s(e.dhBadgeNum)+" AI Detection Hours ")]):e._e(),n("b-dropdown-item",{staticClass:"d-md-none",attrs:{href:"/printers/wizard/"}},[n("i",{staticClass:"fas fa-plus"}),e._v("Link New Printer ")]),n("b-dropdown-divider",{staticClass:"d-md-none"}),n("cascaded-dropdown",{attrs:{menuOptions:e.menuOptions,menuSelections:e.menuSelections},on:{menuSelectionChanged:e.menuSelectionChanged}})],1)],1)]},proxy:!0},{key:"content",fn:function(){return[e.shouldShowFilterWarning?n("div",{staticClass:"active-filter-notice",on:{click:e.onShowAllClicked}},[n("div",{staticClass:"filter"},[n("i",{staticClass:"fas fa-filter mr-2"}),e._v(" "+e._s(e.activeFiltering)+" ")]),n("a",[e._v("SHOW ALL")])]):e._e(),n("b-container",{staticClass:"printer-list-page"},[e.loading?n("b-row",[n("b-col",{staticClass:"text-center"},[n("b-spinner",{staticClass:"my-5",attrs:{label:"Loading..."}})],1)],1):e._e(),e.visiblePrinters.length?n("b-row",{staticClass:"printer-cards justify-content-center"},e._l(e.visiblePrinters,(function(t){return n("printer-card",{key:t.id,staticClass:"printer-card-wrapper",attrs:{printer:t,"is-pro-account":e.user.is_pro},on:{PrinterUpdated:e.onPrinterUpdated,printModalOpened:function(){return e.targetPrinter=t}}})})),1):e._e(),n("div",{staticClass:"row justify-content-center"},[n("div",{staticClass:"col-sm-12 col-lg-6",attrs:{id:"new-printer"}},[n("div",{staticClass:"new-printer-container"},[n("a",{attrs:{href:"/printers/wizard/"}},[n("i",{staticClass:"fa fa-plus fa-2x"}),n("div",[e._v("Link New Printer")])])])])]),n("b-row",{directives:[{name:"show",rawName:"v-show",value:e.shouldShowArchiveWarning,expression:"shouldShowArchiveWarning"}],staticClass:"bottom-messages"},[n("b-col",[n("div",{staticClass:"alert alert-warning alert-dismissible fade show mb-3",attrs:{role:"alert"}},[n("div",{staticClass:"warning"},[n("div",[e._v(e._s(e.archivedPrinterNum)+" "+e._s(e._f("pluralize")("printer",e.archivedPrinterNum))+" have been archived.")]),n("a",{staticClass:"warning-action",attrs:{href:"/ent/printers/archived/"}},[e._v("Show Archived Printers")])]),n("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"alert","aria-label":"Close"}},[n("span",{attrs:{"aria-hidden":"true"}},[e._v("×")])])])])],1)],1),n("b-modal",{attrs:{size:"lg",id:"b-modal-gcodes"},on:{hidden:e.resetGcodesModal}},[e.selectedGcodeId?n("g-code-file-page",{attrs:{isPopup:!0,targetPrinterId:e.targetPrinter.id,routeParams:{fileId:e.selectedGcodeId,printerId:e.selectedPrinterId},onClose:function(){return e.$bvModal.hide("b-modal-gcodes")}},on:{goBack:function(){e.selectedGcodeId=null,e.scrollToTop()}}}):n("g-code-folders-page",{attrs:{isPopup:!0,targetPrinter:e.targetPrinter,routeParams:{printerId:e.selectedPrinterId,parentFolder:null},onClose:function(){return e.$bvModal.hide("b-modal-gcodes")},savedPath:e.savedPath,scrollContainerId:"b-modal-gcodes"},on:{openFile:function(t,n,i){e.selectedGcodeId=t,e.selectedPrinterId=n,e.savedPath=i,e.scrollToTop()}}})],1)]},proxy:!0}])})},Dn=[],In=(n("c740"),n("5128")),An=n.n(In),jn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"col-sm-12 col-lg-6 printer-card",attrs:{id:e.printer.id}},[n("div",{staticClass:"card"},[n("div",{staticClass:"card-header"},[n("div",{staticClass:"title-box"},[e.hasCurrentPrintFilename?n("div",{staticClass:"primary-title print-filename"},[e._v(e._s(e.printer.current_print.filename))]):e._e(),n("div",{staticClass:"printer-name",class:{"secondary-title":e.hasCurrentPrintFilename}},[e._v(e._s(e.printer.name)+" ("),n("a",{class:e.statusClass,attrs:{href:"#printer-actions-"+e.printer.id}},[e._v(e._s(e.statusText))]),e._v(") ")])]),n("b-dropdown",{attrs:{right:"","no-caret":"","toggle-class":"icon-btn"},scopedSlots:e._u([{key:"button-content",fn:function(){return[n("i",{staticClass:"fas fa-ellipsis-v"})]},proxy:!0}])},[n("b-dropdown-item",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.onSharePrinter()}}},[n("i",{staticClass:"fas fa-share-alt fa-lg"}),e._v("Share ")]),e.printer.isAgentMoonraker()?e._e():n("b-dropdown-item",{attrs:{href:e.octoPrintTunnelUrl()}},[n("svg",{staticClass:"menu-icon"},[n("use",{attrs:{href:"#svg-octoprint-tunneling"}})]),e._v(" Tunneling ")]),n("div",{staticClass:"dropdown-divider"}),n("b-dropdown-item",{attrs:{href:e.settingsUrl()}},[n("i",{staticClass:"fas fa-wrench fa-lg"}),e._v("Configure ")])],1)],1),n("streaming-box",{attrs:{printer:e.printer,webrtc:e.webrtc,autoplay:e.isProAccount}}),e.printer.alertUnacknowledged()?n("div",{staticClass:"failure-alert card-body bg-warning px-2 py-1"},[n("i",{staticClass:"fas fa-exclamation-triangle align-middle"}),n("span",{staticClass:"align-middle"},[e._v("Failure Detected!")]),n("button",{staticClass:"btn btn-outline-primary btn-sm float-right",attrs:{type:"button",id:"not-a-failure"},on:{click:function(t){return e.onNotAFailureClicked(t,!1)}}},[e._v("Not a failure?")])]):e._e(),n("div",{staticClass:"card-body gauge-container",class:{overlay:!e.isWatching}},[e.isWatching?e._e():n("div",{staticClass:"overlay-top text-center",staticStyle:{left:"0",width:"100%",top:"50%","margin-top":"-55px"}},[n("H1",[n("i",{staticClass:"far fa-eye-slash"})]),n("h5",{staticClass:"text-warning"},[e._v("Failure Detection is Off")]),e.printer.not_watching_reason?n("small",[e._v(e._s(e.printer.not_watching_reason)+". "),e._m(0)]):e._e(),n("div")],1),n("Gauge",{attrs:{normalizedP:e.printer.normalized_p,isWatching:e.isWatching}}),n("hr")],1),n("PrinterActions",e._b({staticClass:"container",attrs:{id:"printer-actions-"+e.printer.id},on:{PrinterActionPauseClicked:e.onPrinterActionPauseClicked,PrinterActionResumeClicked:function(t){return e.onPrinterActionResumeClicked(t)},PrinterActionCancelClicked:e.onPrinterActionCancelClicked,PrinterActionConnectClicked:e.onPrinterActionConnectClicked,PrinterActionStartClicked:e.onPrinterActionStartClicked,PrinterActionControlClicked:e.onPrinterActionControlClicked}},"PrinterActions",e.actionsProps,!1)),n("div",{staticClass:"info-section settings"},[n("button",{staticClass:"info-section-toggle btn btn-sm no-corner mx-2",class:{pressed:e.section_toggles.settings},attrs:{type:"button"},on:{click:function(t){return e.onSettingsToggleClicked()}}},[n("i",{staticClass:"fas fa-cog fa-lg"})]),n("button",{staticClass:"info-section-toggle btn btn-sm no-corner mx-2",class:{pressed:e.section_toggles.time},attrs:{type:"button"},on:{click:function(t){return e.onTimeToggleClicked()}}},[n("i",{staticClass:"fas fa-clock fa-lg"})]),n("button",{staticClass:"info-section-toggle btn btn-sm no-corner mx-2",class:{pressed:e.section_toggles.statusTemp},attrs:{type:"button"},on:{click:function(t){return e.onStatusTempToggleClicked()}}},[n("i",{staticClass:"fas fa-thermometer-half fa-lg"})])]),n("div",{staticClass:"info-section",staticStyle:{height:"0.3rem"}}),n("div",[n("div",{staticClass:"info-section container"},[e.section_toggles.settings?n("div",{attrs:{id:"panel-settings"}},[n("div",{staticClass:"pt-2 pb-3"},[n("div",{staticClass:"row justify-content-center px-3"},[n("div",{staticClass:"col-12 setting-item"},[n("label",{staticClass:"toggle-label",attrs:{for:"watching_enabled-toggle-"+e.printer.id}},[e._v("Enable AI failure detection "),e.watchForFailures?e._e():n("div",{staticClass:"text-muted font-weight-light font-size-sm"},[e._v("AI failure detection is disabled. You are on your own. ")])]),n("div",{staticClass:"custom-control custom-switch"},[n("input",{staticClass:"custom-control-input update-printer",attrs:{type:"checkbox",name:"watching_enabled",id:"watching_enabled-toggle-"+e.printer.id},domProps:{checked:e.watchForFailures},on:{click:e.onWatchForFailuresToggled}}),n("label",{staticClass:"custom-control-label",staticStyle:{"font-size":"1rem"},attrs:{for:"watching_enabled-toggle-"+e.printer.id}})])])]),n("div",{staticClass:"row justify-content-center px-3"},[n("div",{staticClass:"col-12 setting-item"},[n("label",{staticClass:"toggle-label",attrs:{for:"pause-toggle-"+e.printer.id}},[e._v("Pause on detected failures "),e.pauseOnFailure?e._e():n("div",{staticClass:"text-muted font-weight-light font-size-sm"},[e._v("You will still be alerted via notifications ")])]),n("div",{staticClass:"custom-control custom-switch"},[n("input",{staticClass:"custom-control-input update-printer",attrs:{type:"checkbox",name:"pause_on_failure",id:"pause-toggle-"+e.printer.id},domProps:{checked:e.pauseOnFailure},on:{click:e.onPauseOnFailureToggled}}),n("label",{staticClass:"custom-control-label",staticStyle:{"font-size":"1rem"},attrs:{for:"pause-toggle-"+e.printer.id}})])])])])]):e._e(),e.section_toggles.time?n("div",{attrs:{id:"print-time"}},[n("div",{staticClass:"py-2"},[e._m(1),n("div",{staticClass:"row"},[e._m(2),n("duration-block",e._b({staticClass:"col-5 numbers",attrs:{id:"print-time-remaining"}},"duration-block",e.timeRemaining,!1)),n("duration-block",e._b({staticClass:"col-5 numbers",attrs:{id:"print-time-total"}},"duration-block",e.timeTotal,!1)),n("div",{staticClass:"col-12"},[n("div",{staticClass:"progress",staticStyle:{height:"2px"}},[n("div",{staticClass:"progress-bar",class:{"progress-bar-striped":e.progressPct<100,"progress-bar-animated":e.progressPct<100},style:"width: "+e.progressPct+"%;",attrs:{id:"print-progress",role:"progressbar","aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100"}})])])],1)])]):e._e(),e.section_toggles.statusTemp&&e.tempProps.show?n("StatusTemp",e._b({attrs:{id:"status_temp_block"},on:{TempEditClicked:e.onTempEditClicked}},"StatusTemp",e.tempProps,!1)):e._e()],1)])],1)])},En=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{attrs:{href:"https://www.obico.io/docs/user-guides/detective-not-watching/",target:"_blank"}},[e._v("Learn more. "),n("small",[n("i",{staticClass:"fas fa-external-link-alt"})])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"row text-muted"},[n("small",{staticClass:"col-5 offset-2"},[e._v(" Remaining ")]),n("small",{staticClass:"col-5"},[e._v(" Total ")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"col-2 text-muted"},[n("i",{staticClass:"fas fa-clock"})])}],Fn=(n("4fad"),n("d0af")),Rn=(n("e9a7"),n("4ec9"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("dce5")),Nn=n.n(Rn),Mn=n("aaa7"),Ln=n.n(Mn),Bn=n("acff");function $n(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a={};return a.printerId=e,a.wsUri=t,a.onPrinterUpdateReceived=n,a.onStatusReceived=r,a.ws=null,a.webrtc=null,a.passthruQueue=new Map,Ln.a.on("blur",(function(){a.closeWebSocket()})),Ln.a.on("focus",(function(){a.connect()})),a.onPassThruReceived=function(e){var t=e.ref;if(t&&a.passthruQueue.get(t)){var n=a.passthruQueue.get(t);a.passthruQueue.delete(t),n(null,e.ret)}else if("printer_event"in e){var r=e.printer_event;i["default"].swal.Toast.fire({icon:r.event_class.toLowerCase(),title:r.event_title,html:r.event_text}).then((function(e){e.isDismissed&&"close"===e.dismiss&&(window.location.href="/printer_events/")}))}},a.connect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;a.ws=new WebSocket(window.location.protocol.replace("http","ws")+"//"+window.location.host+a.wsUri),a.ws.onmessage=function(e){var t={};try{t=JSON.parse(e.data)}catch(i){throw console.log(e.data),i}"passthru"in t?a.onPassThruReceived(t.passthru):n(t)},e&&(a.ws.onopen=e),a.ensureWebsocketClosed(),setTimeout((function(){a.heartbeat()}),3e4)},a.setWebRTC=function(e){function t(e){var t={};try{t=JSON.parse(e)}catch(n){return}t&&"ref"in t&&"ret"in t?a.onPassThruReceived(t):a.onStatusReceived&&a.onStatusReceived(t)}a.webrtc=e,a.webrtc.setCallbacks({onData:function(e){"string"===typeof e||e instanceof String?t(e):Object(Nt["e"])(e,(function(e){t(Bn["a"].ungzip(new Uint8Array(e),{to:"string"}))}))}})},a.passThruToPrinter=function(e,t){if(a.canSend()){var n=Math.random().toString();Nn()(e,{ref:n}),t&&(a.passthruQueue.set(n,t),setTimeout((function(){a.passthruQueue.has(n)&&i["default"].swal.Toast.fire({icon:"error",title:"Failed to contact OctoPrint, or the Obico plugin version is older than 1.2.0."})}),1e4)),a.webrtc&&a.webrtc.sendData(JSON.stringify(e)),a.ws.send(JSON.stringify({passthru:e}))}else t&&t("Message not passed through. No suitable WebSocket.")},a.ensureWebsocketClosed=function(){a.ws.onclose=function(e){a.ws===e.target&&(a.ws=null)},a.ws.onerror=function(){a.ws&&a.ws.close()}},a.closeWebSocket=function(){a.ws&&a.ws.close()},a.heartbeat=function(){a.canSend()&&(a.ws.send(JSON.stringify({})),setTimeout((function(){a.heartbeat()}),3e4))},a.canSend=function(){return a.ws&&1===a.ws.readyState},a}var Un=n("2769"),zn=n.n(Un),Vn=(n("7db0"),n("c975"),n("a15b"),n("45fc"),n("a434"),n("8a79"),n("466d"),n("1276"),n("54f8")),Wn=n("d093");Gn.sessions={},Gn.isExtensionEnabled=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return!0;if(window.navigator.userAgent.match("Chrome")){var e=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),t=33;return window.navigator.userAgent.match("Linux")&&(t=35),e>=26&&e<=t||Gn.extension.isInstalled()}return!0};var qn={extensionId:"hapfgfdkleiggjjpfpenajgdnfckjpaj",isInstalled:function(){return null!==document.querySelector("#janus-extension-installed")},getScreen:function(e){var t=window.setTimeout((function(){var t=new Error("NavigatorUserMediaError");return t.name='The required Chrome extension is not installed: click <a href="#">here</a> to install it. (NOTE: this will need you to refresh the page)',e(t)}),1e3);this.cache[t]=e,window.postMessage({type:"janusGetScreen",id:t},"*")},init:function(){var e={};this.cache=e,window.addEventListener("message",(function(t){if(t.origin==window.location.origin)if("janusGotScreen"==t.data.type&&e[t.data.id]){var n=e[t.data.id];if(delete e[t.data.id],""===t.data.sourceId){var i=new Error("NavigatorUserMediaError");i.name="You cancelled the request for permission, giving up...",n(i)}else n(null,t.data.sourceId)}else"janusGetScreenPending"==t.data.type&&(console.log("clearing ",t.data.id),window.clearTimeout(t.data.id))}))}};function Gn(e){if(e=e||{},e.success="function"==typeof e.success?e.success:Gn.noop,e.error="function"==typeof e.error?e.error:Gn.noop,e.wsopened="function"==typeof e.wsopened?e.wsopened:Gn.noop,e.destroyed="function"==typeof e.destroyed?e.destroyed:Gn.noop,!Gn.initDone)return e.error("Library not initialized"),{};if(!Gn.isWebrtcSupported())return e.error("WebRTC not supported by this browser"),{};if(Gn.log("Library initialized: "+Gn.initDone),!e.server)return e.error("Invalid server url"),{};var t=!1,n=null,i={},r=null,a=null,s=0,o=e.server;Gn.isArray(o)?(Gn.log("Multiple servers provided ("+o.length+"), will use the first that works"),o=null,a=e.server,Gn.debug(a)):0===o.indexOf("ws")?(t=!0,Gn.log("Using WebSockets to contact Janus: "+o)):(t=!1,Gn.log("Using REST API to contact Janus: "+o));var c=e.iceServers||[{urls:"stun:stun.l.google.com:19302"}],l=e.iceTransportPolicy,d=e.bundlePolicy,u=!0===e.ipv6,p=!1;void 0!==e.withCredentials&&null!==e.withCredentials&&(p=!0===e.withCredentials);var f=10;void 0!==e.max_poll_events&&null!==e.max_poll_events&&(f=e.max_poll_events),f<1&&(f=1);var h=null;void 0!==e.token&&null!==e.token&&(h=e.token);var m=null;void 0!==e.apisecret&&null!==e.apisecret&&(m=e.apisecret),this.destroyOnUnload=!0,void 0!==e.destroyOnUnload&&null!==e.destroyOnUnload&&(this.destroyOnUnload=!0===e.destroyOnUnload);var v=25e3;void 0!==e.keepAlivePeriod&&null!==e.keepAlivePeriod&&(v=e.keepAlivePeriod),isNaN(v)&&(v=25e3);var g=6e4;function _(e){var t={high:9e5,medium:3e5,low:1e5};return void 0!==e&&null!==e&&(e.high&&(t.high=e.high),e.medium&&(t.medium=e.medium),e.low&&(t.low=e.low)),t}void 0!==e.longPollTimeout&&null!==e.longPollTimeout&&(g=e.longPollTimeout),isNaN(g)&&(g=6e4);var w=!1,C=null,y={},k=this,S=0,P={};function x(){if(null!=C)if(Gn.debug("Long poll..."),w){var t=o+"/"+C+"?rid="+(new Date).getTime();f&&(t=t+"&maxev="+f),h&&(t=t+"&token="+encodeURIComponent(h)),m&&(t=t+"&apisecret="+encodeURIComponent(m)),Gn.httpAPICall(t,{verb:"GET",withCredentials:p,success:T,timeout:g,error:function(t,n){if(Gn.error(t+":",n),S++,S>3)return w=!1,void e.error("Lost connection to the server (is it down?)");x()}})}else Gn.warn("Is the server down? (connected=false)")}function T(e,i){if(S=0,t||void 0===C||null===C||!0===i||x(),t||!Gn.isArray(e)){if(!e.session_id||e.session_id===C)if("keepalive"!==e["janus"])if("server_info"!==e["janus"])if("ack"!==e["janus"])if("success"!==e["janus"])if("trickle"===e["janus"]){var r=e["sender"];if(!r)return void Gn.warn("Missing sender...");var a=y[r];if(!a)return void Gn.debug("This handle is not attached to this session");var s=e["candidate"];Gn.debug("Got a trickled candidate on session "+C),Gn.debug(s);var o=a.webrtcStuff;o.pc&&o.remoteSdp?(Gn.debug("Adding remote candidate:",s),s&&!0!==s.completed?o.pc.addIceCandidate(s):o.pc.addIceCandidate(Gn.endOfCandidates)):(Gn.debug("We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate"),o.candidates||(o.candidates=[]),o.candidates.push(s),Gn.debug(o.candidates))}else{if("webrtcup"===e["janus"]){Gn.debug("Got a webrtcup event on session "+C),Gn.debug(e);r=e["sender"];if(!r)return void Gn.warn("Missing sender...");a=y[r];return a?void a.webrtcState(!0):void Gn.debug("This handle is not attached to this session")}if("hangup"===e["janus"]){Gn.debug("Got a hangup event on session "+C),Gn.debug(e);r=e["sender"];if(!r)return void Gn.warn("Missing sender...");a=y[r];if(!a)return void Gn.debug("This handle is not attached to this session");a.webrtcState(!1,e["reason"]),a.hangup()}else if("detached"===e["janus"]){Gn.debug("Got a detached event on session "+C),Gn.debug(e);r=e["sender"];if(!r)return void Gn.warn("Missing sender...");a=y[r];if(!a)return;a.detached=!0,a.ondetached(),a.detach()}else if("media"===e["janus"]){Gn.debug("Got a media event on session "+C),Gn.debug(e);r=e["sender"];if(!r)return void Gn.warn("Missing sender...");a=y[r];if(!a)return void Gn.debug("This handle is not attached to this session");a.mediaState(e["type"],e["receiving"])}else if("slowlink"===e["janus"]){Gn.debug("Got a slowlink event on session "+C),Gn.debug(e);r=e["sender"];if(!r)return void Gn.warn("Missing sender...");a=y[r];if(!a)return void Gn.debug("This handle is not attached to this session");a.slowLink(e["uplink"],e["lost"])}else{if("error"===e["janus"]){Gn.error("Ooops: "+e["error"].code+" "+e["error"].reason),Gn.debug(e);p=e["transaction"];if(p){f=P[p];f&&f(e),delete P[p]}return void(458===e.error.code&&t&&n.close(3505,"No such session"))}if("event"===e["janus"]){Gn.debug("Got a plugin event on session "+C),Gn.debug(e);r=e["sender"];if(!r)return void Gn.warn("Missing sender...");var c=e["plugindata"];if(!c)return void Gn.warn("Missing plugindata...");Gn.debug("  -- Event is coming from "+r+" ("+c["plugin"]+")");var l=c["data"];Gn.debug(l);a=y[r];if(!a)return void Gn.warn("This handle is not attached to this session");var d=e["jsep"];d&&(Gn.debug("Handling SDP as well..."),Gn.debug(d));var u=a.onmessage;u?(Gn.debug("Notifying application..."),u(l,d)):Gn.debug("No provided notification callback")}else{if("timeout"===e["janus"])return Gn.error("Timeout on session "+C),Gn.debug(e),void(t&&n.close(3504,"Gateway timeout"));Gn.warn("Unknown message/event  '"+e["janus"]+"' on session "+C),Gn.debug(e)}}}else{Gn.debug("Got a success on session "+C),Gn.debug(e);p=e["transaction"];if(p){f=P[p];f&&f(e),delete P[p]}}else{Gn.debug("Got an ack on session "+C),Gn.debug(e);var p=e["transaction"];if(p){var f=P[p];f&&f(e),delete P[p]}}else{Gn.debug("Got info on the Janus instance"),Gn.debug(e);var p=e["transaction"];if(p){var f=P[p];f&&f(e),delete P[p]}}else Gn.vdebug("Got a keepalive on session "+C)}else for(var h=0;h<e.length;h++)T(e[h],!0)}function O(){if(o&&t&&w){r=setTimeout(O,v);var e={janus:"keepalive",session_id:C,transaction:Gn.randomString(12)};h&&(e["token"]=h),m&&(e["apisecret"]=m),n.send(JSON.stringify(e))}}function D(c){var l=Gn.randomString(12),d={janus:"create",transaction:l};if(c["reconnect"]&&(w=!1,d["janus"]="claim",d["session_id"]=C,n&&(n.onopen=null,n.onerror=null,n.onclose=null,r&&(clearTimeout(r),r=null))),h&&(d["token"]=h),m&&(d["apisecret"]=m),!o&&Gn.isArray(a)&&(o=a[s],0===o.indexOf("ws")?(t=!0,Gn.log("Server #"+(s+1)+": trying WebSockets to contact Janus ("+o+")")):(t=!1,Gn.log("Server #"+(s+1)+": trying REST API to contact Janus ("+o+")"))),t)for(var u in n=Gn.newWebSocket(o,"janus-protocol"),i={error:function(){if(Gn.error("Error connecting to the Janus WebSockets server... "+o),Gn.isArray(a)&&!c["reconnect"])return s++,s===a.length?void c.error("Error connecting to any of the provided Janus servers: Is the server down?"):(o=null,void setTimeout((function(){D(c)}),200));c.error("Error connecting to the Janus WebSockets server: Is the server down?")},open:function(){c.wsopened(),P[l]=function(e){if(Gn.debug(e),"success"!==e["janus"])return Gn.error("Ooops: "+e["error"].code+" "+e["error"].reason),void c.error(e["error"].reason);r=setTimeout(O,v),w=!0,C=e["session_id"]?e["session_id"]:e.data["id"],c["reconnect"]?Gn.log("Claimed session: "+C):Gn.log("Created session: "+C),Gn.sessions[C]=k,c.success()},n.send(JSON.stringify(d))},message:function(e){T(JSON.parse(e.data))},close:function(){o&&w&&(w=!1,e.error("Lost connection to the server (is it down?)"))}},i)n.addEventListener(u,i[u]);else Gn.httpAPICall(o,{verb:"POST",withCredentials:p,body:d,success:function(e){if(Gn.debug(e),"success"!==e["janus"])return Gn.error("Ooops: "+e["error"].code+" "+e["error"].reason),void c.error(e["error"].reason);w=!0,C=e["session_id"]?e["session_id"]:e.data["id"],c["reconnect"]?Gn.log("Claimed session: "+C):Gn.log("Created session: "+C),Gn.sessions[C]=k,x(),c.success()},error:function(e,t){if(Gn.error(e+":",t),Gn.isArray(a)&&!c["reconnect"])return s++,s===a.length?void c.error("Error connecting to any of the provided Janus servers: Is the server down?"):(o=null,void setTimeout((function(){D(c)}),200));""===t?c.error(e+": Is the server down?"):c.error(e+": "+t)}})}function I(e){if(e=e||{},e.success="function"==typeof e.success?e.success:Gn.noop,e.error="function"==typeof e.error?e.error:Gn.noop,Gn.log("Getting info on Janus instance"),!w)return Gn.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var i=Gn.randomString(12),r={janus:"info",transaction:i};if(h&&(r["token"]=h),m&&(r["apisecret"]=m),t)return P[i]=function(t){Gn.log("Server info:"),Gn.debug(t),"server_info"!==t["janus"]&&Gn.error("Ooops: "+t["error"].code+" "+t["error"].reason),e.success(t)},void n.send(JSON.stringify(r));Gn.httpAPICall(o,{verb:"POST",withCredentials:p,body:r,success:function(t){Gn.log("Server info:"),Gn.debug(t),"server_info"!==t["janus"]&&Gn.error("Ooops: "+t["error"].code+" "+t["error"].reason),e.success(t)},error:function(t,n){Gn.error(t+":",n),""===n?e.error(t+": Is the server down?"):e.error(t+": "+n)}})}function A(a){a=a||{},a.success="function"==typeof a.success?a.success:Gn.noop,a.error="function"==typeof a.error?a.error:Gn.noop;var s=!0===a.unload,c=!0;void 0!==a.notifyDestroyed&&null!==a.notifyDestroyed&&(c=!0===a.notifyDestroyed);var l=!0===a.cleanupHandles;if(Gn.log("Destroying session "+C+" (unload="+s+")"),!C)return Gn.warn("No session to destroy"),a.success(),void(c&&e.destroyed());if(l)for(var d in y)L(d,{noRequest:!0});if(!w)return Gn.warn("Is the server down? (connected=false)"),C=null,void a.success();var u={janus:"destroy",transaction:Gn.randomString(12)};if(h&&(u["token"]=h),m&&(u["apisecret"]=m),s)return t?(n.onclose=null,n.close(),n=null):navigator.sendBeacon(o+"/"+C,JSON.stringify(u)),Gn.log("Destroyed session:"),C=null,w=!1,a.success(),void(c&&e.destroyed());if(t){u["session_id"]=C;var f=function(){for(var e in i)n.removeEventListener(e,i[e]);n.removeEventListener("message",v),n.removeEventListener("error",g),r&&clearTimeout(r),n.close()},v=function(t){var n=JSON.parse(t.data);n.session_id==u.session_id&&n.transaction==u.transaction&&(f(),a.success(),c&&e.destroyed())},g=function(t){f(),a.error("Failed to destroy the server: Is the server down?"),c&&e.destroyed()};return n.addEventListener("message",v),n.addEventListener("error",g),void(1===n.readyState?n.send(JSON.stringify(u)):g())}Gn.httpAPICall(o+"/"+C,{verb:"POST",withCredentials:p,body:u,success:function(t){Gn.log("Destroyed session:"),Gn.debug(t),C=null,w=!1,"success"!==t["janus"]&&Gn.error("Ooops: "+t["error"].code+" "+t["error"].reason),a.success(),c&&e.destroyed()},error:function(t,n){Gn.error(t+":",n),C=null,w=!1,a.success(),c&&e.destroyed()}})}function j(e){if(e=e||{},e.success="function"==typeof e.success?e.success:Gn.noop,e.error="function"==typeof e.error?e.error:Gn.noop,e.consentDialog="function"==typeof e.consentDialog?e.consentDialog:Gn.noop,e.iceState="function"==typeof e.iceState?e.iceState:Gn.noop,e.mediaState="function"==typeof e.mediaState?e.mediaState:Gn.noop,e.webrtcState="function"==typeof e.webrtcState?e.webrtcState:Gn.noop,e.slowLink="function"==typeof e.slowLink?e.slowLink:Gn.noop,e.onmessage="function"==typeof e.onmessage?e.onmessage:Gn.noop,e.onlocalstream="function"==typeof e.onlocalstream?e.onlocalstream:Gn.noop,e.onremotestream="function"==typeof e.onremotestream?e.onremotestream:Gn.noop,e.ondata="function"==typeof e.ondata?e.ondata:Gn.noop,e.ondataopen="function"==typeof e.ondataopen?e.ondataopen:Gn.noop,e.oncleanup="function"==typeof e.oncleanup?e.oncleanup:Gn.noop,e.ondetached="function"==typeof e.ondetached?e.ondetached:Gn.noop,!w)return Gn.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var i=e.plugin;if(!i)return Gn.error("Invalid plugin"),void e.error("Invalid plugin");var r=e.opaqueId,a=e.token?e.token:h,s=Gn.randomString(12),c={janus:"attach",plugin:i,opaque_id:r,transaction:s};if(a&&(c["token"]=a),m&&(c["apisecret"]=m),t)return P[s]=function(t){if(Gn.debug(t),"success"!==t["janus"])return Gn.error("Ooops: "+t["error"].code+" "+t["error"].reason),void e.error("Ooops: "+t["error"].code+" "+t["error"].reason);var n=t.data["id"];Gn.log("Created handle: "+n);var r={session:k,plugin:i,id:n,token:a,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return n},getPlugin:function(){return i},getVolume:function(){return q(n,!0)},getRemoteVolume:function(){return q(n,!0)},getLocalVolume:function(){return q(n,!1)},isAudioMuted:function(){return G(n,!1)},muteAudio:function(){return H(n,!1,!0)},unmuteAudio:function(){return H(n,!1,!1)},isVideoMuted:function(){return G(n,!0)},muteVideo:function(){return H(n,!0,!0)},unmuteVideo:function(){return H(n,!0,!1)},getBitrate:function(){return J(n)},send:function(e){E(n,e)},data:function(e){N(n,e)},dtmf:function(e){M(n,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){$(n,!0,e)},createAnswer:function(e){$(n,!1,e)},handleRemoteJsep:function(e){U(n,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ontrackmuted:e.ontrackmuted,ontrackunmuted:e.ontrackunmuted,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){K(n,!0===e)},detach:function(e){L(n,e)}};y[n]=r,e.success(r)},c["session_id"]=C,void n.send(JSON.stringify(c));Gn.httpAPICall(o+"/"+C,{verb:"POST",withCredentials:p,body:c,success:function(t){if(Gn.debug(t),"success"!==t["janus"])return Gn.error("Ooops: "+t["error"].code+" "+t["error"].reason),void e.error("Ooops: "+t["error"].code+" "+t["error"].reason);var n=t.data["id"];Gn.log("Created handle: "+n);var r={session:k,plugin:i,id:n,token:a,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return n},getPlugin:function(){return i},getVolume:function(){return q(n,!0)},getRemoteVolume:function(){return q(n,!0)},getLocalVolume:function(){return q(n,!1)},isAudioMuted:function(){return G(n,!1)},muteAudio:function(){return H(n,!1,!0)},unmuteAudio:function(){return H(n,!1,!1)},isVideoMuted:function(){return G(n,!0)},muteVideo:function(){return H(n,!0,!0)},unmuteVideo:function(){return H(n,!0,!1)},getBitrate:function(){return J(n)},send:function(e){E(n,e)},data:function(e){N(n,e)},dtmf:function(e){M(n,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){$(n,!0,e)},createAnswer:function(e){$(n,!1,e)},handleRemoteJsep:function(e){U(n,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ontrackmuted:e.ontrackmuted,ontrackunmuted:e.ontrackunmuted,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){K(n,!0===e)},detach:function(e){L(n,e)}};y[n]=r,e.success(r)},error:function(t,n){Gn.error(t+":",n),""===n?e.error(t+": Is the server down?"):e.error(t+": "+n)}})}function E(e,i){if(i=i||{},i.success="function"==typeof i.success?i.success:Gn.noop,i.error="function"==typeof i.error?i.error:Gn.noop,!w)return Gn.warn("Is the server down? (connected=false)"),void i.error("Is the server down? (connected=false)");var r=y[e];if(!r||!r.webrtcStuff)return Gn.warn("Invalid handle"),void i.error("Invalid handle");var a=i.message,s=i.jsep,c=Gn.randomString(12),l={janus:"message",body:a,transaction:c};if(r.token&&(l["token"]=r.token),m&&(l["apisecret"]=m),s&&(l.jsep={type:s.type,sdp:s.sdp},s.e2ee&&(l.jsep.e2ee=!0),"hml"!==s.rid_order&&"lmh"!==s.rid_order||(l.jsep.rid_order=s.rid_order)),Gn.debug("Sending message to plugin (handle="+e+"):"),Gn.debug(l),t)return l["session_id"]=C,l["handle_id"]=e,P[c]=function(e){if(Gn.debug("Message sent!"),Gn.debug(e),"success"===e["janus"]){var t=e["plugindata"];if(!t)return Gn.warn("Request succeeded, but missing plugindata..."),void i.success();Gn.log("Synchronous transaction successful ("+t["plugin"]+")");var n=t["data"];return Gn.debug(n),void i.success(n)}"ack"===e["janus"]?i.success():e["error"]?(Gn.error("Ooops: "+e["error"].code+" "+e["error"].reason),i.error(e["error"].code+" "+e["error"].reason)):(Gn.error("Unknown error"),i.error("Unknown error"))},void n.send(JSON.stringify(l));Gn.httpAPICall(o+"/"+C+"/"+e,{verb:"POST",withCredentials:p,body:l,success:function(e){if(Gn.debug("Message sent!"),Gn.debug(e),"success"===e["janus"]){var t=e["plugindata"];if(!t)return Gn.warn("Request succeeded, but missing plugindata..."),void i.success();Gn.log("Synchronous transaction successful ("+t["plugin"]+")");var n=t["data"];return Gn.debug(n),void i.success(n)}"ack"===e["janus"]?i.success():e["error"]?(Gn.error("Ooops: "+e["error"].code+" "+e["error"].reason),i.error(e["error"].code+" "+e["error"].reason)):(Gn.error("Unknown error"),i.error("Unknown error"))},error:function(e,t){Gn.error(e+":",t),i.error(e+": "+t)}})}function F(e,i){if(w){var r=y[e];if(r&&r.webrtcStuff){var a={janus:"trickle",candidate:i,transaction:Gn.randomString(12)};if(r.token&&(a["token"]=r.token),m&&(a["apisecret"]=m),Gn.vdebug("Sending trickle candidate (handle="+e+"):"),Gn.vdebug(a),t)return a["session_id"]=C,a["handle_id"]=e,void n.send(JSON.stringify(a));Gn.httpAPICall(o+"/"+C+"/"+e,{verb:"POST",withCredentials:p,body:a,success:function(e){Gn.vdebug("Candidate sent!"),Gn.vdebug(e),"ack"===e["janus"]||Gn.error("Ooops: "+e["error"].code+" "+e["error"].reason)},error:function(e,t){Gn.error(e+":",t)}})}else Gn.warn("Invalid handle")}else Gn.warn("Is the server down? (connected=false)")}function R(e,t,n,i,r){var a=y[e];if(a&&a.webrtcStuff){var s=a.webrtcStuff;if(s.pc){var o=function(e){var t=e.target.label;a.ondata(e.data,t)},c=function(e){Gn.log("Received state change on data channel:",e);var t=e.target.label,n=e.target.protocol,i=s.dataChannel[t]?s.dataChannel[t].readyState:"null";if(Gn.log("State change on <"+t+"> data channel: "+i),"open"===i){if(s.dataChannel[t].pending&&s.dataChannel[t].pending.length>0){Gn.log("Sending pending messages on <"+t+">:",s.dataChannel[t].pending.length);var r,o=Object(Vn["a"])(s.dataChannel[t].pending);try{for(o.s();!(r=o.n()).done;){var c=r.value;Gn.log("Sending data on data channel <"+t+">"),Gn.debug(c),s.dataChannel[t].send(c)}}catch(l){o.e(l)}finally{o.f()}s.dataChannel[t].pending=[]}a.ondataopen(t,n)}},l=function(e){Gn.error("Got error on data channel:",e)};if(i)s.dataChannel[t]=i;else{var d={ordered:!0};n&&(d.protocol=n),s.dataChannel[t]=s.pc.createDataChannel(t,d)}s.dataChannel[t].onmessage=o,s.dataChannel[t].onopen=c,s.dataChannel[t].onclose=c,s.dataChannel[t].onerror=l,s.dataChannel[t].pending=[],r&&s.dataChannel[t].pending.push(r)}else Gn.warn("Invalid PeerConnection")}else Gn.warn("Invalid handle")}function N(e,t){t=t||{},t.success="function"==typeof t.success?t.success:Gn.noop,t.error="function"==typeof t.error?t.error:Gn.noop;var n=y[e];if(!n||!n.webrtcStuff)return Gn.warn("Invalid handle"),void t.error("Invalid handle");var i=n.webrtcStuff,r=t.text||t.data;if(!r)return Gn.warn("Invalid data"),void t.error("Invalid data");var a=t.label?t.label:Gn.dataChanDefaultLabel;return i.dataChannel[a]?"open"!==i.dataChannel[a].readyState?(i.dataChannel[a].pending.push(r),void t.success()):(Gn.log("Sending data on data channel <"+a+">"),Gn.debug(r),i.dataChannel[a].send(r),void t.success()):(R(e,a,t.protocol,!1,r,t.protocol),void t.success())}function M(e,t){t=t||{},t.success="function"==typeof t.success?t.success:Gn.noop,t.error="function"==typeof t.error?t.error:Gn.noop;var n=y[e];if(!n||!n.webrtcStuff)return Gn.warn("Invalid handle"),void t.error("Invalid handle");var i=n.webrtcStuff;if(!i.dtmfSender){if(i.pc){var r=i.pc.getSenders(),a=r.find((function(e){return e.track&&"audio"===e.track.kind}));if(!a)return Gn.warn("Invalid DTMF configuration (no audio track)"),void t.error("Invalid DTMF configuration (no audio track)");i.dtmfSender=a.dtmf,i.dtmfSender&&(Gn.log("Created DTMF Sender"),i.dtmfSender.ontonechange=function(e){Gn.debug("Sent DTMF tone: "+e.tone)})}if(!i.dtmfSender)return Gn.warn("Invalid DTMF configuration"),void t.error("Invalid DTMF configuration")}var s=t.dtmf;if(!s)return Gn.warn("Invalid DTMF parameters"),void t.error("Invalid DTMF parameters");var o=s.tones;if(!o)return Gn.warn("Invalid DTMF string"),void t.error("Invalid DTMF string");var c="number"===typeof s.duration?s.duration:500,l="number"===typeof s.gap?s.gap:50;Gn.debug("Sending DTMF string "+o+" (duration "+c+"ms, gap "+l+"ms)"),i.dtmfSender.insertDTMF(o,c,l),t.success()}function L(e,i){i=i||{},i.success="function"==typeof i.success?i.success:Gn.noop,i.error="function"==typeof i.error?i.error:Gn.noop;var r=!0===i.noRequest;Gn.log("Destroying handle "+e+" (only-locally="+r+")"),K(e);var a=y[e];if(!a||a.detached)return delete y[e],void i.success();if(a.detached=!0,r)return delete y[e],void i.success();if(!w)return Gn.warn("Is the server down? (connected=false)"),void i.error("Is the server down? (connected=false)");var s={janus:"detach",transaction:Gn.randomString(12)};if(a.token&&(s["token"]=a.token),m&&(s["apisecret"]=m),t)return s["session_id"]=C,s["handle_id"]=e,n.send(JSON.stringify(s)),delete y[e],void i.success();Gn.httpAPICall(o+"/"+C+"/"+e,{verb:"POST",withCredentials:p,body:s,success:function(t){Gn.log("Destroyed handle:"),Gn.debug(t),"success"!==t["janus"]&&Gn.error("Ooops: "+t["error"].code+" "+t["error"].reason),delete y[e],i.success()},error:function(t,n){Gn.error(t+":",n),delete y[e],i.success()}})}function B(e,t,n,i,r){var a=y[e];if(!a||!a.webrtcStuff)return Gn.warn("Invalid handle"),i.stream||Gn.stopAllTracks(r),void i.error("Invalid handle");var s=a.webrtcStuff;Gn.debug("streamsDone:",r),r&&(Gn.debug("  -- Audio tracks:",r.getAudioTracks()),Gn.debug("  -- Video tracks:",r.getVideoTracks()));var o=!1;if(s.myStream&&n.update&&(!s.streamExternal||n.replaceAudio||n.replaceVideo)){if((!n.update&&Z(n)||n.update&&(n.addAudio||n.replaceAudio))&&r.getAudioTracks()&&r.getAudioTracks().length)if(s.myStream.addTrack(r.getAudioTracks()[0]),Gn.unifiedPlan){Gn.log((n.replaceAudio?"Replacing":"Adding")+" audio track:",r.getAudioTracks()[0]);var p=null,f=s.pc.getTransceivers();if(f&&f.length>0){var h,m=Object(Vn["a"])(f);try{for(m.s();!(h=m.n()).done;){var v=h.value;if(v.sender&&v.sender.track&&"audio"===v.sender.track.kind||v.receiver&&v.receiver.track&&"audio"===v.receiver.track.kind){p=v;break}}}catch(I){m.e(I)}finally{m.f()}}p&&p.sender?p.sender.replaceTrack(r.getAudioTracks()[0]):s.pc.addTrack(r.getAudioTracks()[0],r)}else Gn.log((n.replaceAudio?"Replacing":"Adding")+" audio track:",r.getAudioTracks()[0]),s.pc.addTrack(r.getAudioTracks()[0],r);if((!n.update&&te(n)||n.update&&(n.addVideo||n.replaceVideo))&&r.getVideoTracks()&&r.getVideoTracks().length)if(s.myStream.addTrack(r.getVideoTracks()[0]),Gn.unifiedPlan){Gn.log((n.replaceVideo?"Replacing":"Adding")+" video track:",r.getVideoTracks()[0]);var g=null;f=s.pc.getTransceivers();if(f&&f.length>0){var w,C=Object(Vn["a"])(f);try{for(C.s();!(w=C.n()).done;){v=w.value;if(v.sender&&v.sender.track&&"video"===v.sender.track.kind||v.receiver&&v.receiver.track&&"video"===v.receiver.track.kind){g=v;break}}}catch(I){C.e(I)}finally{C.f()}}g&&g.sender?g.sender.replaceTrack(r.getVideoTracks()[0]):s.pc.addTrack(r.getVideoTracks()[0],r)}else Gn.log((n.replaceVideo?"Replacing":"Adding")+" video track:",r.getVideoTracks()[0]),s.pc.addTrack(r.getVideoTracks()[0],r)}else s.myStream=r,o=!0;if(!s.pc){var k={iceServers:c,iceTransportPolicy:l,bundlePolicy:d};"chrome"===Gn.webRTCAdapter.browserDetails.browser&&(k["sdpSemantics"]=Gn.webRTCAdapter.browserDetails.version<72?"plan-b":"unified-plan");var S={optional:[{DtlsSrtpKeyAgreement:!0}]};if(u&&S.optional.push({googIPv6:!0}),i.rtcConstraints&&"object"===Object(b["a"])(i.rtcConstraints))for(var P in Gn.debug("Adding custom PeerConnection constraints:",i.rtcConstraints),i.rtcConstraints)S.optional.push(i.rtcConstraints[P]);"edge"===Gn.webRTCAdapter.browserDetails.browser&&(k.bundlePolicy="max-bundle"),RTCRtpSender&&(RTCRtpSender.prototype.createEncodedStreams||RTCRtpSender.prototype.createEncodedAudioStreams&&RTCRtpSender.prototype.createEncodedVideoStreams)&&(i.senderTransforms||i.receiverTransforms)&&(s.senderTransforms=i.senderTransforms,s.receiverTransforms=i.receiverTransforms,k["forceEncodedAudioInsertableStreams"]=!0,k["forceEncodedVideoInsertableStreams"]=!0,k["encodedInsertableStreams"]=!0),Gn.log("Creating PeerConnection"),Gn.debug(S),s.pc=new RTCPeerConnection(k,S),Gn.debug(s.pc),s.pc.getStats&&(s.volume={}),Gn.log("Preparing local SDP and gathering candidates (trickle="+s.trickle+")"),s.pc.oniceconnectionstatechange=function(e){s.pc&&a.iceState(s.pc.iceConnectionState)},s.pc.onicecandidate=function(t){if(!t.candidate||"edge"===Gn.webRTCAdapter.browserDetails.browser&&t.candidate.candidate.indexOf("endOfCandidates")>0)Gn.log("End of candidates."),s.iceDone=!0,!0===s.trickle?F(e,{completed:!0}):W(e,i);else{var n={candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex};!0===s.trickle&&F(e,n)}},s.pc.ontrack=function(e){if(Gn.log("Handling Remote Track"),Gn.debug(e),e.streams&&(s.remoteStream=e.streams[0],a.onremotestream(s.remoteStream),!e.track.onended)){if(s.receiverTransforms){var t=null;RTCRtpSender.prototype.createEncodedStreams?t=e.receiver.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===e.track.kind&&s.receiverTransforms["audio"]?t=e.receiver.createEncodedAudioStreams():"video"===e.track.kind&&s.receiverTransforms["video"]&&(t=e.receiver.createEncodedVideoStreams())),t&&(console.log(t),t.readableStream&&t.writableStream?t.readableStream.pipeThrough(s.receiverTransforms[e.track.kind]).pipeTo(t.writableStream):t.readable&&t.writable&&t.readable.pipeThrough(s.receiverTransforms[e.track.kind]).pipeTo(t.writable))}var n=null;Gn.log("Adding onended callback to track:",e.track),e.track.onended=function(e){Gn.log("Remote track removed:",e),s.remoteStream&&(clearTimeout(n),s.remoteStream.removeTrack(e.target),a.onremotestream(s.remoteStream))},e.track.onmute=function(e){Gn.log("Remote track muted:",e),s.remoteStream&&null==n&&(n=setTimeout((function(){Gn.log("Removing remote track"),s.remoteStream&&(s.remoteStream.removeTrack(e.target),a.onremotestream(s.remoteStream),a.ontrackmuted()),n=null}),2520))},e.track.onunmute=function(e){if(Gn.log("Remote track flowing again:",e),null!=n)clearTimeout(n),n=null;else try{s.remoteStream.addTrack(e.target),a.onremotestream(s.remoteStream),a.ontrackunmuted()}catch(t){Gn.error(t)}}}}}if(o&&r){Gn.log("Adding local stream");var x=!0===i.simulcast2;r.getTracks().forEach((function(e){Gn.log("Adding local track:",e);var t=null;if(x&&"audio"!==e.kind){Gn.log("Enabling rid-based simulcasting:",e);var n=_(i.simulcastMaxBitrates),a=s.pc.addTransceiver(e,{direction:"sendrecv",streams:[r],sendEncodings:i.sendEncodings||[{rid:"h",active:!0,maxBitrate:n.high},{rid:"m",active:!0,maxBitrate:n.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:n.low,scaleResolutionDownBy:4}]});a&&(t=a.sender)}else t=s.pc.addTrack(e,r);if(t&&s.senderTransforms){var o=null;RTCRtpSender.prototype.createEncodedStreams?o=t.createEncodedStreams():(RTCRtpSender.prototype.createAudioEncodedStreams||RTCRtpSender.prototype.createEncodedVideoStreams)&&("audio"===t.track.kind&&s.senderTransforms["audio"]?o=t.createEncodedAudioStreams():"video"===t.track.kind&&s.senderTransforms["video"]&&(o=t.createEncodedVideoStreams())),o&&(console.log(o),o.readableStream&&o.writableStream?o.readableStream.pipeThrough(s.senderTransforms[t.track.kind]).pipeTo(o.writableStream):o.readable&&o.writable&&o.readable.pipeThrough(s.senderTransforms[t.track.kind]).pipeTo(o.writable))}}))}if(ae(n)&&!s.dataChannel[Gn.dataChanDefaultLabel]&&(Gn.log("Creating default data channel"),R(e,Gn.dataChanDefaultLabel,null,!1),s.pc.ondatachannel=function(t){Gn.log("Data channel created by Janus:",t),R(e,t.channel.label,t.channel.protocol,t.channel)}),s.myStream&&a.onlocalstream(s.myStream),t){var T=t["sdp"],O=/420029/gi,D=T.replace(O,"42e01f");Gn.log(D),t["sdp"]=D,s.pc.setRemoteDescription(t).then((function(){if(Gn.log("Remote description accepted!"),s.remoteSdp=t.sdp,s.candidates&&s.candidates.length>0){for(var r=0;r<s.candidates.length;r++){var a=s.candidates[r];Gn.debug("Adding remote candidate:",a),a&&!0!==a.completed?s.pc.addIceCandidate(a):s.pc.addIceCandidate(Gn.endOfCandidates)}s.candidates=[]}V(e,n,i)}),i.error)}else z(e,n,i)}function $(e,t,n){n=n||{},n.success="function"==typeof n.success?n.success:Gn.noop,n.error="function"==typeof n.error?n.error:Y;var i=n.jsep;if(t&&i)return Gn.error("Provided a JSEP to a createOffer"),void n.error("Provided a JSEP to a createOffer");if(!t&&(!i||!i.type||!i.sdp))return Gn.error("A valid JSEP is required for createAnswer"),void n.error("A valid JSEP is required for createAnswer");n.media="object"===Object(b["a"])(n.media)&&n.media?n.media:{audio:!0,video:!0};var r=n.media,a=y[e];if(!a||!a.webrtcStuff)return Gn.warn("Invalid handle"),void n.error("Invalid handle");var s=a.webrtcStuff;if(s.trickle=se(n.trickle),s.pc){if(Gn.log("Updating existing media session"),r.update=!0,n.stream)n.stream!==s.myStream&&Gn.log("Renegotiation involves a new external stream");else{if(r.addAudio){if(r.keepAudio=!1,r.replaceAudio=!1,r.removeAudio=!1,r.audioSend=!0,s.myStream&&s.myStream.getAudioTracks()&&s.myStream.getAudioTracks().length)return Gn.error("Can't add audio stream, there already is one"),void n.error("Can't add audio stream, there already is one")}else r.removeAudio?(r.keepAudio=!1,r.replaceAudio=!1,r.addAudio=!1,r.audioSend=!1):r.replaceAudio&&(r.keepAudio=!1,r.addAudio=!1,r.removeAudio=!1,r.audioSend=!0);if(s.myStream&&s.myStream.getAudioTracks()&&0!==s.myStream.getAudioTracks().length?!Z(r)||r.removeAudio||r.replaceAudio||(r.keepAudio=!0):(r.replaceAudio&&(r.keepAudio=!1,r.replaceAudio=!1,r.addAudio=!0,r.audioSend=!0),Z(r)&&(r.keepAudio=!1,r.addAudio=!0)),r.addVideo){if(r.keepVideo=!1,r.replaceVideo=!1,r.removeVideo=!1,r.videoSend=!0,s.myStream&&s.myStream.getVideoTracks()&&s.myStream.getVideoTracks().length)return Gn.error("Can't add video stream, there already is one"),void n.error("Can't add video stream, there already is one")}else r.removeVideo?(r.keepVideo=!1,r.replaceVideo=!1,r.addVideo=!1,r.videoSend=!1):r.replaceVideo&&(r.keepVideo=!1,r.addVideo=!1,r.removeVideo=!1,r.videoSend=!0);s.myStream&&s.myStream.getVideoTracks()&&0!==s.myStream.getVideoTracks().length?!te(r)||r.removeVideo||r.replaceVideo||(r.keepVideo=!0):(r.replaceVideo&&(r.keepVideo=!1,r.replaceVideo=!1,r.addVideo=!0,r.videoSend=!0),te(r)&&(r.keepVideo=!1,r.addVideo=!0)),r.addData&&(r.data=!0)}if(Z(r)&&r.keepAudio&&te(r)&&r.keepVideo)return a.consentDialog(!1),void B(e,i,r,n,s.myStream)}else r.update=!1,r.keepAudio=!1,r.keepVideo=!1;if(r.update&&(!s.streamExternal||s.streamExternal&&(r.replaceAudio||r.replaceVideo))){if(r.removeAudio||r.replaceAudio){if(s.myStream&&s.myStream.getAudioTracks()&&s.myStream.getAudioTracks().length){var o=s.myStream.getAudioTracks()[0];Gn.log("Removing audio track:",o),s.myStream.removeTrack(o);try{o.stop()}catch(j){}}if(s.pc.getSenders()&&s.pc.getSenders().length){var c=!0;if(r.replaceAudio&&Gn.unifiedPlan&&(c=!1),c){var l,d=Object(Vn["a"])(s.pc.getSenders());try{for(d.s();!(l=d.n()).done;){var u=l.value;u&&u.track&&"audio"===u.track.kind&&(Gn.log("Removing audio sender:",u),s.pc.removeTrack(u))}}catch(E){d.e(E)}finally{d.f()}}}}if(r.removeVideo||r.replaceVideo){if(s.myStream&&s.myStream.getVideoTracks()&&s.myStream.getVideoTracks().length){var p=s.myStream.getVideoTracks()[0];Gn.log("Removing video track:",p),s.myStream.removeTrack(p);try{p.stop()}catch(j){}}if(s.pc.getSenders()&&s.pc.getSenders().length){var f=!0;if(r.replaceVideo&&Gn.unifiedPlan&&(f=!1),f){var h,m=Object(Vn["a"])(s.pc.getSenders());try{for(m.s();!(h=m.n()).done;){var v=h.value;v&&v.track&&"video"===v.track.kind&&(Gn.log("Removing video sender:",v),s.pc.removeTrack(v))}}catch(E){m.e(E)}finally{m.f()}}}}}if(n.stream){var g=n.stream;return Gn.log("MediaStream provided by the application"),Gn.debug(g),!r.update||!s.myStream||s.myStream===n.stream||s.streamExternal||r.replaceAudio||r.replaceVideo||(Gn.stopAllTracks(s.myStream),s.myStream=null),s.streamExternal=!0,a.consentDialog(!1),void B(e,i,r,n,g)}if(Z(r)||te(r)){if(!Gn.isGetUserMediaAvailable())return void n.error("getUserMedia not available");var _={mandatory:{},optional:[]};a.consentDialog(!0);var w=Z(r);w&&r&&"object"===Object(b["a"])(r.audio)&&(w=r.audio);var C=te(r);if(C&&r){var k=!0===n.simulcast,S=!0===n.simulcast2;if(!k&&!S||i||r.video||(r.video="hires"),r.video&&"screen"!=r.video&&"window"!=r.video)if("object"===Object(b["a"])(r.video))C=r.video;else{var P=0,x=0;"lowres"===r.video?(x=240,240,P=320):"lowres-16:9"===r.video?(x=180,180,P=320):"hires"===r.video||"hires-16:9"===r.video||"hdres"===r.video?(x=720,720,P=1280):"fhdres"===r.video?(x=1080,1080,P=1920):"4kres"===r.video?(x=2160,2160,P=3840):"stdres"===r.video?(x=480,480,P=640):"stdres-16:9"===r.video?(x=360,360,P=640):(Gn.log("Default video setting is stdres 4:3"),x=480,480,P=640),Gn.log("Adding media constraint:",r.video),C={height:{ideal:x},width:{ideal:P}},Gn.log("Adding video constraint:",C)}else if("screen"===r.video||"window"===r.video){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return _.video={},r.screenshareFrameRate&&(_.video.frameRate=r.screenshareFrameRate),r.screenshareHeight&&(_.video.height=r.screenshareHeight),r.screenshareWidth&&(_.video.width=r.screenshareWidth),_.audio=r.captureDesktopAudio,void navigator.mediaDevices.getDisplayMedia(_).then((function(t){a.consentDialog(!1),Z(r)&&!r.keepAudio?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(a){t.addTrack(a.getAudioTracks()[0]),B(e,i,r,n,t)})):B(e,i,r,n,t)}),(function(e){a.consentDialog(!1),n.error(e)}));function T(t,s){a.consentDialog(!1),t?n.error(t):B(e,i,r,n,s)}function O(e,t,n){Gn.log("Adding media constraint (screen capture)"),Gn.debug(e),navigator.mediaDevices.getUserMedia(e).then((function(e){n?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(n){e.addTrack(n.getAudioTracks()[0]),t(null,e)})):t(null,e)})).catch((function(e){a.consentDialog(!1),t(e)}))}if("chrome"===Gn.webRTCAdapter.browserDetails.browser){var D=Gn.webRTCAdapter.browserDetails.version,I=33;window.navigator.userAgent.match("Linux")&&(I=35),D>=26&&D<=I?(_={video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:r.screenshareFrameRate,maxFrameRate:r.screenshareFrameRate,chromeMediaSource:"screen"}},audio:Z(r)&&!r.keepAudio},O(_,T)):Gn.extension.getScreen((function(e,t){if(e)return a.consentDialog(!1),n.error(e);_={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:r.screenshareFrameRate,maxFrameRate:r.screenshareFrameRate},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},_.video.mandatory.chromeMediaSourceId=t,O(_,T,Z(r)&&!r.keepAudio)}))}else if("firefox"===Gn.webRTCAdapter.browserDetails.browser){if(!(Gn.webRTCAdapter.browserDetails.version>=33)){var A=new Error("NavigatorUserMediaError");return A.name="Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)",a.consentDialog(!1),void n.error(A)}_={video:{mozMediaSource:r.video,mediaSource:r.video},audio:Z(r)&&!r.keepAudio},O(_,(function(e,t){if(T(e,t),!e)var n=t.currentTime,i=window.setInterval((function(){t||window.clearInterval(i),t.currentTime==n&&(window.clearInterval(i),t.onended&&t.onended()),n=t.currentTime}),500)}))}return}}r&&"screen"===r.video||navigator.mediaDevices.enumerateDevices().then((function(t){var s=t.some((function(e){return"audioinput"===e.kind})),o=re(r)||t.some((function(e){return"videoinput"===e.kind})),c=Z(r),l=te(r),d=X(r),u=ne(r);if(c||l||d||u){var p=!!c&&s,f=!!l&&o;if(!p&&!f)return a.consentDialog(!1),n.error("No capture device found"),!1;if(!p&&d)return a.consentDialog(!1),n.error("Audio capture is required, but no capture device found"),!1;if(!f&&u)return a.consentDialog(!1),n.error("Video capture is required, but no capture device found"),!1}var h={audio:!(!s||r.keepAudio)&&w,video:!(!o||r.keepVideo)&&C};Gn.debug("getUserMedia constraints",h),h.audio||h.video?navigator.mediaDevices.getUserMedia(h).then((function(t){a.consentDialog(!1),B(e,i,r,n,t)})).catch((function(e){a.consentDialog(!1),n.error({code:e.code,name:e.name,message:e.message})})):(a.consentDialog(!1),B(e,i,r,n,g))})).catch((function(e){a.consentDialog(!1),n.error(e)}))}else B(e,i,r,n)}function U(e,t){t=t||{},t.success="function"==typeof t.success?t.success:Gn.noop,t.error="function"==typeof t.error?t.error:Y,t.customizeSdp="function"==typeof t.customizeSdp?t.customizeSdp:Gn.noop;var n=t.jsep,i=y[e];if(!i||!i.webrtcStuff)return Gn.warn("Invalid handle"),void t.error("Invalid handle");var r=i.webrtcStuff;if(n){if(!r.pc)return Gn.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"),void t.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep");t.customizeSdp(n),r.pc.setRemoteDescription(n).then((function(){if(Gn.log("Remote description accepted!"),r.remoteSdp=n.sdp,r.candidates&&r.candidates.length>0){for(var e=0;e<r.candidates.length;e++){var i=r.candidates[e];Gn.debug("Adding remote candidate:",i),i&&!0!==i.completed?r.pc.addIceCandidate(i):r.pc.addIceCandidate(Gn.endOfCandidates)}r.candidates=[]}t.success()}),t.error)}else t.error("Invalid JSEP")}function z(e,t,n){n=n||{},n.success="function"==typeof n.success?n.success:Gn.noop,n.error="function"==typeof n.error?n.error:Gn.noop,n.customizeSdp="function"==typeof n.customizeSdp?n.customizeSdp:Gn.noop;var i=y[e];if(!i||!i.webrtcStuff)return Gn.warn("Invalid handle"),void n.error("Invalid handle");var r=i.webrtcStuff,a=!0===n.simulcast;a?Gn.log("Creating offer (iceDone="+r.iceDone+", simulcast="+a+")"):Gn.log("Creating offer (iceDone="+r.iceDone+")");var s={};if(Gn.unifiedPlan){var o=null,c=null,l=r.pc.getTransceivers();if(l&&l.length>0){var d,u=Object(Vn["a"])(l);try{for(u.s();!(d=u.n()).done;){var p=d.value;p.sender&&p.sender.track&&"audio"===p.sender.track.kind||p.receiver&&p.receiver.track&&"audio"===p.receiver.track.kind?o||(o=p):(p.sender&&p.sender.track&&"video"===p.sender.track.kind||p.receiver&&p.receiver.track&&"video"===p.receiver.track.kind)&&(c||(c=p))}}catch(S){u.e(S)}finally{u.f()}}var f=Z(t),h=ee(t);f||h?f&&h?o&&(o.setDirection?o.setDirection("sendrecv"):o.direction="sendrecv",Gn.log("Setting audio transceiver to sendrecv:",o)):f&&!h?o&&(o.setDirection?o.setDirection("sendonly"):o.direction="sendonly",Gn.log("Setting audio transceiver to sendonly:",o)):!f&&h&&(o?(o.setDirection?o.setDirection("recvonly"):o.direction="recvonly",Gn.log("Setting audio transceiver to recvonly:",o)):(o=r.pc.addTransceiver("audio",{direction:"recvonly"}),Gn.log("Adding recvonly audio transceiver:",o))):t.removeAudio&&o&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive",Gn.log("Setting audio transceiver to inactive:",o));var m=te(t),v=ie(t);m||v?m&&v?c&&(c.setDirection?c.setDirection("sendrecv"):c.direction="sendrecv",Gn.log("Setting video transceiver to sendrecv:",c)):m&&!v?c&&(c.setDirection?c.setDirection("sendonly"):c.direction="sendonly",Gn.log("Setting video transceiver to sendonly:",c)):!m&&v&&(c?(c.setDirection?c.setDirection("recvonly"):c.direction="recvonly",Gn.log("Setting video transceiver to recvonly:",c)):(c=r.pc.addTransceiver("video",{direction:"recvonly"}),Gn.log("Adding recvonly video transceiver:",c))):t.removeVideo&&c&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive",Gn.log("Setting video transceiver to inactive:",c))}else s["offerToReceiveAudio"]=ee(t),s["offerToReceiveVideo"]=ie(t);var g=!0===n.iceRestart;g&&(s["iceRestart"]=!0),Gn.debug(s);var b=te(t);if(b&&a&&"firefox"===Gn.webRTCAdapter.browserDetails.browser){Gn.log("Enabling Simulcasting for Firefox (RID)");var w=r.pc.getSenders().find((function(e){return e.track&&"video"===e.track.kind}));if(w){var C=w.getParameters();C||(C={});var k=_(n.simulcastMaxBitrates);C.encodings=n.sendEncodings||[{rid:"h",active:!0,maxBitrate:k.high},{rid:"m",active:!0,maxBitrate:k.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:k.low,scaleResolutionDownBy:4}],w.setParameters(C)}}r.pc.createOffer(s).then((function(e){Gn.debug(e);var t={type:e.type,sdp:e.sdp};n.customizeSdp(t),e.sdp=t.sdp,Gn.log("Setting local description"),b&&a&&("chrome"===Gn.webRTCAdapter.browserDetails.browser||"safari"===Gn.webRTCAdapter.browserDetails.browser?(Gn.log("Enabling Simulcasting for Chrome (SDP munging)"),e.sdp=Q(e.sdp)):"firefox"!==Gn.webRTCAdapter.browserDetails.browser&&Gn.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),r.mySdp={type:"offer",sdp:e.sdp},r.pc.setLocalDescription(e).catch(n.error),r.mediaConstraints=s,r.iceDone||r.trickle?((r.senderTransforms||r.receiverTransforms)&&(e["e2ee"]=!0),n.success(e)):Gn.log("Waiting for all candidates...")}),n.error)}function V(e,t,n){n=n||{},n.success="function"==typeof n.success?n.success:Gn.noop,n.error="function"==typeof n.error?n.error:Gn.noop,n.customizeSdp="function"==typeof n.customizeSdp?n.customizeSdp:Gn.noop;var i=y[e];if(!i||!i.webrtcStuff)return Gn.warn("Invalid handle"),void n.error("Invalid handle");var r=i.webrtcStuff,a=!0===n.simulcast;a?Gn.log("Creating answer (iceDone="+r.iceDone+", simulcast="+a+")"):Gn.log("Creating answer (iceDone="+r.iceDone+")");var s=null;if(Gn.unifiedPlan){s={};var o=null,c=null,l=r.pc.getTransceivers();if(l&&l.length>0){var d,u=Object(Vn["a"])(l);try{for(u.s();!(d=u.n()).done;){var p=d.value;p.sender&&p.sender.track&&"audio"===p.sender.track.kind||p.receiver&&p.receiver.track&&"audio"===p.receiver.track.kind?o||(o=p):(p.sender&&p.sender.track&&"video"===p.sender.track.kind||p.receiver&&p.receiver.track&&"video"===p.receiver.track.kind)&&(c||(c=p))}}catch(k){u.e(k)}finally{u.f()}}var f=Z(t),h=ee(t);if(f||h){if(f&&h){if(o)try{o.setDirection?o.setDirection("sendrecv"):o.direction="sendrecv",Gn.log("Setting audio transceiver to sendrecv:",o)}catch(S){Gn.error(S)}}else if(f&&!h)try{o&&(o.setDirection?o.setDirection("sendonly"):o.direction="sendonly",Gn.log("Setting audio transceiver to sendonly:",o))}catch(S){Gn.error(S)}else if(!f&&h)if(o)try{o.setDirection?o.setDirection("recvonly"):o.direction="recvonly",Gn.log("Setting audio transceiver to recvonly:",o)}catch(S){Gn.error(S)}else o=r.pc.addTransceiver("audio",{direction:"recvonly"}),Gn.log("Adding recvonly audio transceiver:",o)}else if(t.removeAudio&&o)try{o.setDirection?o.setDirection("inactive"):o.direction="inactive",Gn.log("Setting audio transceiver to inactive:",o)}catch(S){Gn.error(S)}var m=te(t),v=ie(t);if(m||v){if(m&&v){if(c)try{c.setDirection?c.setDirection("sendrecv"):c.direction="sendrecv",Gn.log("Setting video transceiver to sendrecv:",c)}catch(S){Gn.error(S)}}else if(m&&!v){if(c)try{c.setDirection?c.setDirection("sendonly"):c.direction="sendonly",Gn.log("Setting video transceiver to sendonly:",c)}catch(S){Gn.error(S)}}else if(!m&&v)if(c)try{c.setDirection?c.setDirection("recvonly"):c.direction="recvonly",Gn.log("Setting video transceiver to recvonly:",c)}catch(S){Gn.error(S)}else c=r.pc.addTransceiver("video",{direction:"recvonly"}),Gn.log("Adding recvonly video transceiver:",c)}else if(t.removeVideo&&c)try{c.setDirection?c.setDirection("inactive"):c.direction="inactive",Gn.log("Setting video transceiver to inactive:",c)}catch(S){Gn.error(S)}}else s="firefox"===Gn.webRTCAdapter.browserDetails.browser||"edge"===Gn.webRTCAdapter.browserDetails.browser?{offerToReceiveAudio:ee(t),offerToReceiveVideo:ie(t)}:{mandatory:{OfferToReceiveAudio:ee(t),OfferToReceiveVideo:ie(t)}};Gn.debug(s);var g=te(t);if(g&&a&&"firefox"===Gn.webRTCAdapter.browserDetails.browser){Gn.log("Enabling Simulcasting for Firefox (RID)");var b=r.pc.getSenders()[1];Gn.log(b);var w=b.getParameters();Gn.log(w);var C=_(n.simulcastMaxBitrates);b.setParameters({encodings:n.sendEncodings||[{rid:"h",active:!0,maxBitrate:C.high},{rid:"m",active:!0,maxBitrate:C.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:C.low,scaleResolutionDownBy:4}]})}r.pc.createAnswer(s).then((function(e){Gn.debug(e);var t={type:e.type,sdp:e.sdp};n.customizeSdp(t),e.sdp=t.sdp,Gn.log("Setting local description"),g&&a&&("chrome"===Gn.webRTCAdapter.browserDetails.browser?Gn.warn("simulcast=true, but this is an answer, and video breaks in Chrome if we enable it"):"firefox"!==Gn.webRTCAdapter.browserDetails.browser&&Gn.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),r.mySdp={type:"answer",sdp:e.sdp},r.pc.setLocalDescription(e).catch(n.error),r.mediaConstraints=s,r.iceDone||r.trickle?((r.senderTransforms||r.receiverTransforms)&&(e["e2ee"]=!0),n.success(e)):Gn.log("Waiting for all candidates...")}),n.error)}function W(e,t){t=t||{},t.success="function"==typeof t.success?t.success:Gn.noop,t.error="function"==typeof t.error?t.error:Gn.noop;var n=y[e];if(n&&n.webrtcStuff){var i=n.webrtcStuff;Gn.log("Sending offer/answer SDP..."),i.mySdp?(i.mySdp={type:i.pc.localDescription.type,sdp:i.pc.localDescription.sdp},!1===i.trickle&&(i.mySdp["trickle"]=!1),Gn.debug(t),i.sdpSent=!0,t.success(i.mySdp)):Gn.warn("Local SDP instance is invalid, not sending anything...")}else Gn.warn("Invalid handle, not sending anything")}function q(e,t){var n=y[e];if(!n||!n.webrtcStuff)return Gn.warn("Invalid handle"),0;var i=t?"remote":"local",r=n.webrtcStuff;return r.volume[i]||(r.volume[i]={value:0}),!r.pc.getStats||"chrome"!==Gn.webRTCAdapter.browserDetails.browser&&"safari"!==Gn.webRTCAdapter.browserDetails.browser?(Gn.warn("Getting the "+i+" volume unsupported by browser"),0):t&&!r.remoteStream?(Gn.warn("Remote stream unavailable"),0):t||r.myStream?r.volume[i].timer?r.volume[i].value:(Gn.log("Starting "+i+" volume monitor"),r.volume[i].timer=setInterval((function(){r.pc.getStats().then((function(e){e.forEach((function(e){e&&"audio"===e.kind&&(t&&!e.remoteSource||!t&&"media-source"!==e.type||(r.volume[i].value=e.audioLevel?e.audioLevel:0))}))}))}),200),0):(Gn.warn("Local stream unavailable"),0)}function G(e,t){var n=y[e];if(!n||!n.webrtcStuff)return Gn.warn("Invalid handle"),!0;var i=n.webrtcStuff;return i.pc?i.myStream?t?i.myStream.getVideoTracks()&&0!==i.myStream.getVideoTracks().length?!i.myStream.getVideoTracks()[0].enabled:(Gn.warn("No video track"),!0):i.myStream.getAudioTracks()&&0!==i.myStream.getAudioTracks().length?!i.myStream.getAudioTracks()[0].enabled:(Gn.warn("No audio track"),!0):(Gn.warn("Invalid local MediaStream"),!0):(Gn.warn("Invalid PeerConnection"),!0)}function H(e,t,n){var i=y[e];if(!i||!i.webrtcStuff)return Gn.warn("Invalid handle"),!1;var r=i.webrtcStuff;return r.pc?r.myStream?t?r.myStream.getVideoTracks()&&0!==r.myStream.getVideoTracks().length?(r.myStream.getVideoTracks()[0].enabled=!n,!0):(Gn.warn("No video track"),!1):r.myStream.getAudioTracks()&&0!==r.myStream.getAudioTracks().length?(r.myStream.getAudioTracks()[0].enabled=!n,!0):(Gn.warn("No audio track"),!1):(Gn.warn("Invalid local MediaStream"),!1):(Gn.warn("Invalid PeerConnection"),!1)}function J(e){var t=y[e];if(!t||!t.webrtcStuff)return Gn.warn("Invalid handle"),"Invalid handle";var n=t.webrtcStuff;return n.pc?n.pc.getStats?(n.bitrate.timer||(Gn.log("Starting bitrate timer (via getStats)"),n.bitrate.timer=setInterval((function(){n.pc.getStats().then((function(e){e.forEach((function(e){if(e){var t=!1;if(("video"===e.mediaType||e.id.toLowerCase().indexOf("video")>-1)&&"inbound-rtp"===e.type&&e.id.indexOf("rtcp")<0?t=!0:"ssrc"!=e.type||!e.bytesReceived||"VP8"!==e.googCodecName&&""!==e.googCodecName||(t=!0),t)if(n.bitrate.fps=e.framesPerSecond,n.bitrate.bsnow=e.bytesReceived,n.bitrate.tsnow=e.timestamp,null===n.bitrate.bsbefore||null===n.bitrate.tsbefore)n.bitrate.bsbefore=n.bitrate.bsnow,n.bitrate.tsbefore=n.bitrate.tsnow;else{var i=n.bitrate.tsnow-n.bitrate.tsbefore;"safari"===Gn.webRTCAdapter.browserDetails.browser&&(i/=1e3);var r=Math.round(8*(n.bitrate.bsnow-n.bitrate.bsbefore)/i);"safari"===Gn.webRTCAdapter.browserDetails.browser&&(r=parseInt(r/1e3)),n.bitrate.value=r+" kbps",n.bitrate.bsbefore=n.bitrate.bsnow,n.bitrate.tsbefore=n.bitrate.tsnow}}}))}))}),1e3)),n.bitrate):(Gn.warn("Getting the video bitrate unsupported by browser"),"Feature unsupported by browser"):"Invalid PeerConnection"}function Y(e){Gn.error("WebRTC error:",e)}function K(e,i){Gn.log("Cleaning WebRTC stuff");var r=y[e];if(r){var a=r.webrtcStuff;if(a){if(!0===i){var s={janus:"hangup",transaction:Gn.randomString(12)};r.token&&(s["token"]=r.token),m&&(s["apisecret"]=m),Gn.debug("Sending hangup request (handle="+e+"):"),Gn.debug(s),t?(s["session_id"]=C,s["handle_id"]=e,n.send(JSON.stringify(s))):Gn.httpAPICall(o+"/"+C+"/"+e,{verb:"POST",withCredentials:p,body:s})}a.remoteStream=null,a.volume&&(a.volume["local"]&&a.volume["local"].timer&&clearInterval(a.volume["local"].timer),a.volume["remote"]&&a.volume["remote"].timer&&clearInterval(a.volume["remote"].timer)),a.volume={},a.bitrate.timer&&clearInterval(a.bitrate.timer),a.bitrate.timer=null,a.bitrate.bsnow=null,a.bitrate.bsbefore=null,a.bitrate.tsnow=null,a.bitrate.tsbefore=null,a.bitrate.value=null,!a.streamExternal&&a.myStream&&(Gn.log("Stopping local stream tracks"),Gn.stopAllTracks(a.myStream)),a.streamExternal=!1,a.myStream=null;try{a.pc.close()}catch(c){}a.pc=null,a.candidates=null,a.mySdp=null,a.remoteSdp=null,a.iceDone=!1,a.dataChannel={},a.dtmfSender=null,a.senderTransforms=null,a.receiverTransforms=null}r.oncleanup()}}function Q(e){for(var t=e.split("\r\n"),n=!1,i=[-1],r=[-1],a=null,s=null,o=null,c=null,l=-1,d=0;d<t.length;d++){var u=t[d].match(/m=(\w+) */);if(u){var p=u[1];if("video"===p){if(!(i[0]<0)){l=d;break}n=!0}else if(i[0]>-1){l=d;break}}else if(n){var f=t[d].match(/a=ssrc-group:SIM (\d+) (\d+) (\d+)/);if(f)return Gn.warn("The SDP already contains a SIM attribute, munging will be skipped"),e;var h=t[d].match(/a=ssrc-group:FID (\d+) (\d+)/);if(h)i[0]=h[1],r[0]=h[2],t.splice(d,1),d--;else{if(i[0]){var m=t[d].match("a=ssrc:"+i[0]+" cname:(.+)");if(m&&(a=m[1]),m=t[d].match("a=ssrc:"+i[0]+" msid:(.+)"),m&&(s=m[1]),m=t[d].match("a=ssrc:"+i[0]+" mslabel:(.+)"),m&&(o=m[1]),m=t[d].match("a=ssrc:"+i[0]+" label:(.+)"),m&&(c=m[1]),0===t[d].indexOf("a=ssrc:"+r[0])){t.splice(d,1),d--;continue}if(0===t[d].indexOf("a=ssrc:"+i[0])){t.splice(d,1),d--;continue}}0!=t[d].length||(t.splice(d,1),d--)}}}if(i[0]<0){l=-1,n=!1;for(d=0;d<t.length;d++){u=t[d].match(/m=(\w+) */);if(u){p=u[1];if("video"===p){if(!(i[0]<0)){l=d;break}n=!0}else if(i[0]>-1){l=d;break}}else if(n){if(i[0]<0){var v=t[d].match(/a=ssrc:(\d+)/);if(v){i[0]=v[1],t.splice(d,1),d--;continue}}else{m=t[d].match("a=ssrc:"+i[0]+" cname:(.+)");if(m&&(a=m[1]),m=t[d].match("a=ssrc:"+i[0]+" msid:(.+)"),m&&(s=m[1]),m=t[d].match("a=ssrc:"+i[0]+" mslabel:(.+)"),m&&(o=m[1]),m=t[d].match("a=ssrc:"+i[0]+" label:(.+)"),m&&(c=m[1]),0===t[d].indexOf("a=ssrc:"+r[0])){t.splice(d,1),d--;continue}if(0===t[d].indexOf("a=ssrc:"+i[0])){t.splice(d,1),d--;continue}}0!==t[d].length||(t.splice(d,1),d--)}}}if(i[0]<0)return Gn.warn("Couldn't find the video SSRC, simulcasting NOT enabled"),e;l<0&&(l=t.length),i[1]=Math.floor(4294967295*Math.random()),i[2]=Math.floor(4294967295*Math.random()),r[1]=Math.floor(4294967295*Math.random()),r[2]=Math.floor(4294967295*Math.random());for(d=0;d<i.length;d++)a&&(t.splice(l,0,"a=ssrc:"+i[d]+" cname:"+a),l++),s&&(t.splice(l,0,"a=ssrc:"+i[d]+" msid:"+s),l++),o&&(t.splice(l,0,"a=ssrc:"+i[d]+" mslabel:"+o),l++),c&&(t.splice(l,0,"a=ssrc:"+i[d]+" label:"+c),l++),a&&(t.splice(l,0,"a=ssrc:"+r[d]+" cname:"+a),l++),s&&(t.splice(l,0,"a=ssrc:"+r[d]+" msid:"+s),l++),o&&(t.splice(l,0,"a=ssrc:"+r[d]+" mslabel:"+o),l++),c&&(t.splice(l,0,"a=ssrc:"+r[d]+" label:"+c),l++);return t.splice(l,0,"a=ssrc-group:FID "+i[2]+" "+r[2]),t.splice(l,0,"a=ssrc-group:FID "+i[1]+" "+r[1]),t.splice(l,0,"a=ssrc-group:FID "+i[0]+" "+r[0]),t.splice(l,0,"a=ssrc-group:SIM "+i[0]+" "+i[1]+" "+i[2]),e=t.join("\r\n"),e.endsWith("\r\n")||(e+="\r\n"),e}function Z(e){return Gn.debug("isAudioSendEnabled:",e),!e||!1!==e.audio&&(void 0===e.audioSend||null===e.audioSend||!0===e.audioSend)}function X(e){return Gn.debug("isAudioSendRequired:",e),!!e&&(!1!==e.audio&&!1!==e.audioSend&&(void 0!==e.failIfNoAudio&&null!==e.failIfNoAudio&&!0===e.failIfNoAudio))}function ee(e){return Gn.debug("isAudioRecvEnabled:",e),!e||!1!==e.audio&&(void 0===e.audioRecv||null===e.audioRecv||!0===e.audioRecv)}function te(e){return Gn.debug("isVideoSendEnabled:",e),!e||!1!==e.video&&(void 0===e.videoSend||null===e.videoSend||!0===e.videoSend)}function ne(e){return Gn.debug("isVideoSendRequired:",e),!!e&&(!1!==e.video&&!1!==e.videoSend&&(void 0!==e.failIfNoVideo&&null!==e.failIfNoVideo&&!0===e.failIfNoVideo))}function ie(e){return Gn.debug("isVideoRecvEnabled:",e),!e||!1!==e.video&&(void 0===e.videoRecv||null===e.videoRecv||!0===e.videoRecv)}function re(e){if(Gn.debug("isScreenSendEnabled:",e),!e)return!1;if("object"!==Object(b["a"])(e.video)||"object"!==Object(b["a"])(e.video.mandatory))return!1;var t=e.video.mandatory;return t.chromeMediaSource?"desktop"===t.chromeMediaSource||"screen"===t.chromeMediaSource:t.mozMediaSource?"window"===t.mozMediaSource||"screen"===t.mozMediaSource:!!t.mediaSource&&("window"===t.mediaSource||"screen"===t.mediaSource)}function ae(e){return Gn.debug("isDataEnabled:",e),"edge"===Gn.webRTCAdapter.browserDetails.browser?(Gn.warn("Edge doesn't support data channels yet"),!1):void 0!==e&&null!==e&&!0===e.data}function se(e){return Gn.debug("isTrickleEnabled:",e),!1!==e}D(e),this.getServer=function(){return o},this.isConnected=function(){return w},this.reconnect=function(e){e=e||{},e.success="function"==typeof e.success?e.success:Gn.noop,e.error="function"==typeof e.error?e.error:Gn.noop,e["reconnect"]=!0,D(e)},this.getSessionId=function(){return C},this.getInfo=function(e){I(e)},this.destroy=function(e){A(e)},this.attach=function(e){j(e)}}Gn.useDefaultDependencies=function(e){var t=e&&e.fetch||fetch,n=e&&e.Promise||Promise,i=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new i(e,t)},extension:e&&e.extension||qn,isArray:function(e){return Array.isArray(e)},webRTCAdapter:e&&e.adapter||Wn["a"],httpAPICall:function(e,i){var r={method:i.verb,headers:{Accept:"application/json, text/plain, */*"},cache:"no-cache"};"POST"===i.verb&&(r.headers["Content-Type"]="application/json"),void 0!==i.withCredentials&&(r.credentials=!0===i.withCredentials?"include":i.withCredentials?i.withCredentials:"omit"),i.body&&(r.body=JSON.stringify(i.body));var a=t(e,r).catch((function(e){return n.reject({message:"Probably a network error, is the server down?",error:e})}));if(i.timeout){var s=new n((function(e,t){var n=setTimeout((function(){return clearTimeout(n),t({message:"Request timed out",timeout:i.timeout})}),i.timeout)}));a=n.race([a,s])}return a.then((function(e){return e.ok?Object(b["a"])(i.success)===Object(b["a"])(Gn.noop)?e.json().then((function(e){try{i.success(e)}catch(t){Gn.error("Unhandled httpAPICall success callback error",t)}}),(function(t){return n.reject({message:"Failed to parse response body",error:t,response:e})})):void 0:n.reject({message:"API call failed",response:e})})).catch((function(e){Object(b["a"])(i.error)===Object(b["a"])(Gn.noop)&&i.error(e.message||"<< internal error >>",e)})),a}}},Gn.useOldDependencies=function(e){var t=e&&e.jQuery||jQuery,n=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new n(e,t)},isArray:function(e){return t.isArray(e)},extension:e&&e.extension||qn,webRTCAdapter:e&&e.adapter||Wn["a"],httpAPICall:function(e,n){var i=void 0!==n.body?{contentType:"application/json",data:JSON.stringify(n.body)}:{},r=void 0!==n.withCredentials?{xhrFields:{withCredentials:n.withCredentials}}:{};return t.ajax(t.extend(i,r,{url:e,type:n.verb,cache:!1,dataType:"json",async:n.async,timeout:n.timeout,success:function(e){Object(b["a"])(n.success)===Object(b["a"])(Gn.noop)&&n.success(e)},error:function(e,t,i){Object(b["a"])(n.error)===Object(b["a"])(Gn.noop)&&n.error(t,i)}}))}}},Gn.noop=function(){},Gn.dataChanDefaultLabel="JanusDataChannel",Gn.endOfCandidates=null,Gn.stopAllTracks=function(e){try{var t,n=e.getTracks(),i=Object(Vn["a"])(n);try{for(i.s();!(t=i.n()).done;){var r=t.value;Gn.log(r),r&&r.stop()}}catch(a){i.e(a)}finally{i.f()}}catch(s){}},Gn.init=function(e){if(e=e||{},e.callback="function"==typeof e.callback?e.callback:Gn.noop,Gn.initDone)e.callback();else{if("undefined"!=typeof console&&"undefined"!=typeof console.log||(console={log:function(){}}),Gn.trace=Gn.noop,Gn.debug=Gn.noop,Gn.vdebug=Gn.noop,Gn.log=Gn.noop,Gn.warn=Gn.noop,Gn.error=Gn.noop,!0===e.debug||"all"===e.debug)Gn.trace=console.trace.bind(console),Gn.debug=console.debug.bind(console),Gn.vdebug=console.debug.bind(console),Gn.log=console.log.bind(console),Gn.warn=console.warn.bind(console),Gn.error=console.error.bind(console);else if(Array.isArray(e.debug)){var t,n=Object(Vn["a"])(e.debug);try{for(n.s();!(t=n.n()).done;){var i=t.value;switch(i){case"trace":Gn.trace=console.trace.bind(console);break;case"debug":Gn.debug=console.debug.bind(console);break;case"vdebug":Gn.vdebug=console.debug.bind(console);break;case"log":Gn.log=console.log.bind(console);break;case"warn":Gn.warn=console.warn.bind(console);break;case"error":Gn.error=console.error.bind(console);break;default:console.error("Unknown debugging option '"+i+"' (supported: 'trace', 'debug', 'vdebug', 'log', warn', 'error')");break}}}catch(f){n.e(f)}finally{n.f()}}Gn.log("Initializing library");var r=e.dependencies||Gn.useDefaultDependencies();Gn.isArray=r.isArray,Gn.webRTCAdapter=r.webRTCAdapter,Gn.httpAPICall=r.httpAPICall,Gn.newWebSocket=r.newWebSocket,Gn.extension=r.extension,Gn.extension.init(),Gn.listDevices=function(e,t){e="function"==typeof e?e:Gn.noop,null==t&&(t={audio:!0,video:!0}),Gn.isGetUserMediaAvailable()?navigator.mediaDevices.getUserMedia(t).then((function(t){navigator.mediaDevices.enumerateDevices().then((function(n){Gn.debug(n),e(n),Gn.stopAllTracks(t)}))})).catch((function(t){Gn.error(t),e([])})):(Gn.warn("navigator.mediaDevices unavailable"),e([]))},Gn.attachMediaStream=function(e,t){try{e.srcObject=t}catch(n){try{e.src=URL.createObjectURL(t)}catch(n){Gn.error("Error attaching stream to element")}}},Gn.reattachMediaStream=function(e,t){try{e.srcObject=t.srcObject}catch(n){try{e.src=t.src}catch(n){Gn.error("Error reattaching stream to element")}}};var a=["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0,s=a?"pagehide":"beforeunload",o=window["on"+s];if(window.addEventListener(s,(function(e){for(var t in Gn.log("Closing window"),Gn.sessions)Gn.sessions[t]&&Gn.sessions[t].destroyOnUnload&&(Gn.log("Destroying session "+t),Gn.sessions[t].destroy({unload:!0,notifyDestroyed:!1}));o&&"function"==typeof o&&o()})),Gn.safariVp8=!1,"safari"===Gn.webRTCAdapter.browserDetails.browser&&Gn.webRTCAdapter.browserDetails.version>=605)if(RTCRtpSender&&RTCRtpSender.getCapabilities&&RTCRtpSender.getCapabilities("video")&&RTCRtpSender.getCapabilities("video").codecs&&RTCRtpSender.getCapabilities("video").codecs.length){var c,l=Object(Vn["a"])(RTCRtpSender.getCapabilities("video").codecs);try{for(l.s();!(c=l.n()).done;){var d=c.value;if(d&&d.mimeType&&"video/vp8"===d.mimeType.toLowerCase()){Gn.safariVp8=!0;break}}}catch(f){l.e(f)}finally{l.f()}Gn.safariVp8?Gn.log("This version of Safari supports VP8"):Gn.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu")}else{var u=new RTCPeerConnection({});u.createOffer({offerToReceiveVideo:!0}).then((function(e){Gn.safariVp8=-1!==e.sdp.indexOf("VP8"),Gn.safariVp8?Gn.log("This version of Safari supports VP8"):Gn.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu"),u.close(),u=null}))}if(Gn.unifiedPlan=!1,"firefox"===Gn.webRTCAdapter.browserDetails.browser&&Gn.webRTCAdapter.browserDetails.version>=59)Gn.unifiedPlan=!0;else if("chrome"===Gn.webRTCAdapter.browserDetails.browser&&Gn.webRTCAdapter.browserDetails.version>=72)Gn.unifiedPlan=!0;else if(window.RTCRtpTransceiver&&"currentDirection"in RTCRtpTransceiver.prototype){var p=new RTCPeerConnection;try{p.addTransceiver("audio"),Gn.unifiedPlan=!0}catch(h){}p.close()}else Gn.unifiedPlan=!1;Gn.initDone=!0,e.callback()}},Gn.isWebrtcSupported=function(){return!!window.RTCPeerConnection},Gn.isGetUserMediaAvailable=function(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia},Gn.randomString=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",i=0;i<e;i++){var r=Math.floor(Math.random()*t.length);n+=t.substring(r,r+1)}return n};var Hn=Gn,Jn=function(e){return"/ws/janus/".concat(e,"/")},Yn=function(e){return"/ws/share_token/janus/".concat(e,"/")};function Kn(e){var t=window.location.hostname.replace("app","turn");return[{urls:["stun:stun.l.google.com:19302"]},{urls:"turn:".concat(t,":80?transport=udp"),credential:e,username:e},{urls:"turn:".concat(t,":80?transport=tcp"),credential:e,username:e}]}function Qn(){var e={callbacks:{},initialized:!1,mainWebRTCConn:Xn(),mjpegWebRTCConn:Zn(),openForShareToken:function(t){e.connect(Yn(t),t)},openForPrinter:function(t,n){e.connect(Jn(t),n)},connect:function(t,n){e.initialized=!0,e.mainWebRTCConn.connect(t,n),e.mjpegWebRTCConn.connect(t,n)},stopStream:function(){e.mainWebRTCConn.stopStream(),e.mjpegWebRTCConn.stopStream()},sendData:function(t){e.mainWebRTCConn.sendData(t)},startStream:function(){e.mainWebRTCConn.startStream(),e.mjpegWebRTCConn.startStream()},setCallbacks:function(t){e.callbacks=Object(a["a"])(Object(a["a"])({},e.callbacks),t),e.mainWebRTCConn.callbacks=e.callbacks,e.mjpegWebRTCConn.callbacks=e.callbacks}};return e}function Zn(){var e={callbacks:{},streamId:void 0,streaming:void 0,bitrateInterval:null,connect:function(t,n){Hn.init({debug:"all",callback:function(){Hn.isWebrtcSupported()&&e.connectJanusWebSocket(t,n)}})},connectJanusWebSocket:function(t,n){var i=new Hn({server:window.location.protocol.replace("http","ws")+"//"+window.location.host+t,iceServers:Kn(n),ipv6:!0,success:function(){i.attach({plugin:"janus.plugin.streaming",opaqueId:"streamingtest-"+Hn.randomString(12),success:function(t){Hn.log("Plugin attached! ("+t.getPlugin()+", id="+t.getId()+")");var n={request:"info",id:2};Hn.debug("Sending message ("+JSON.stringify(n)+")"),t.send({message:n,success:function(n){var r=Q()(n,"info");r?(e.streamId=r.id,e.streaming=t,"data"===Q()(r,"media[0].type")&&e.callbacks.onStreamAvailable()):i.destroy()}})},error:function(e){Hn.error("  -- Error attaching plugin... ",e),i.destroy()},onmessage:function(t,n){e.onMessage(t,n)},onremotestream:function(e){},ondataopen:function(){},ondata:function(t){"onMJpegData"in e.callbacks&&e.callbacks.onMJpegData(t)},oncleanup:function(){}})},error:function(e){Hn.error("  -- Error -- ",e),i.destroy()},destroyed:function(){e.streaming=void 0,e.streamId=void 0}})},onMessage:function(e,t){var n=this;Hn.debug(" ::: Got a message :::"),Hn.debug(e);var i,r=e["result"];if(null!==r&&void 0!==r){if(void 0!==r["status"]&&null!==r["status"]){var a=r["status"];"starting"===a?console.log("Starting"):"started"===a?console.log("Started"):"stopped"===a&&n.stopStream()}}else if(void 0!==e["error"]&&null!==e["error"])return Hn.error(e),void n.stopStream();void 0!==t&&null!==t&&(null===(i=n.streaming)||void 0===i||i.createAnswer({jsep:t,media:{audioSend:!1,videoSend:!1,data:!0},success:function(e){var t;Hn.debug("Got SDP!"),Hn.debug(e);var i={request:"start"};null===(t=n.streaming)||void 0===t||t.send({message:i,jsep:e})},error:function(e){Hn.error("WebRTC error:",e)}}))},channelOpen:function(){return!(void 0===e.streamId||void 0===e.streaming)},startStream:function(){var t;if(e.channelOpen()){var n={request:"watch",offer_video:!1,id:parseInt(e.streamId)};null===(t=e.streaming)||void 0===t||t.send({message:n})}},stopStream:function(){var t,n,i={request:"stop"};null===(t=e.streaming)||void 0===t||t.send({message:i}),null===(n=e.streaming)||void 0===n||n.hangup()}};return e}function Xn(){var e={callbacks:{},streamId:void 0,streaming:void 0,bitrateInterval:null,connect:function(t,n){Hn.init({debug:"all",callback:function(){Hn.isWebrtcSupported()&&e.connectJanusWebSocket(t,n)}})},connectJanusWebSocket:function(t,n){var i=new Hn({server:window.location.protocol.replace("http","ws")+"//"+window.location.host+t,iceServers:Kn(n),ipv6:!0,success:function(){i.attach({plugin:"janus.plugin.streaming",opaqueId:"streamingtest-"+Hn.randomString(12),success:function(t){[0,1].forEach((function(n){var i={request:"info",id:n};Hn.debug("Sending message ("+JSON.stringify(i)+")"),t.send({message:i,success:function(n){var i=Q()(n,"info");if(i){e.streamId=i.id,e.streaming=t;var r=Q()(i,"video")||zn()(Q()(i,"media",[]),{type:"video"});r&&e.callbacks.onStreamAvailable()}}})}))},error:function(e){Hn.error("  -- Error attaching plugin... ",e),i.destroy()},onmessage:function(t,n){e.onMessage(t,n)},onremotestream:function(t){Hn.debug(" ::: Got a remote stream :::"),Hn.debug(t),"onRemoteStream"in e.callbacks&&e.callbacks.onRemoteStream(t)},ontrackmuted:function(){"onTrackMuted"in e.callbacks&&e.callbacks.onTrackMuted()},ontrackunmuted:function(){"onTrackUnmuted"in e.callbacks&&e.callbacks.onTrackUnmuted()},slowLink:function(t,n){"onSlowLink"in e.callbacks&&e.callbacks.onSlowLink(n)},ondataopen:function(){},ondata:function(t){"onData"in e.callbacks&&e.callbacks.onData(t)},oncleanup:function(){"onDefaultStreamCleanup"in e.callbacks&&e.callbacks.onDefaultStreamCleanup()}})},error:function(e){Hn.error("  -- Error -- ",e),i.destroy()},destroyed:function(){e.streaming=void 0,e.streamId=void 0,e.clearBitrateInterval()}})},onMessage:function(e,t){var n=this;Hn.debug(" ::: Got a message :::"),Hn.debug(e);var i,r=e["result"];if(null!==r&&void 0!==r){if(void 0!==r["status"]&&null!==r["status"]){var a=r["status"];"starting"===a?console.log("Starting"):"started"===a?console.log("Started"):"stopped"===a&&n.stopStream()}}else if(void 0!==e["error"]&&null!==e["error"])return Hn.error(e),void n.stopStream();void 0!==t&&null!==t&&(null===(i=n.streaming)||void 0===i||i.createAnswer({jsep:t,media:{audioSend:!1,videoSend:!1,data:!0},success:function(e){var t;Hn.debug("Got SDP!"),Hn.debug(e);var i={request:"start"};null===(t=n.streaming)||void 0===t||t.send({message:i,jsep:e})},error:function(e){Hn.error("WebRTC error:",e)}}))},channelOpen:function(){return!(void 0===e.streamId||void 0===e.streaming)},startStream:function(){var t;if(e.channelOpen()){var n={request:"watch",offer_video:!0,id:parseInt(e.streamId)};null===(t=e.streaming)||void 0===t||t.send({message:n}),e.clearBitrateInterval(),e.bitrateInterval=setInterval((function(){if(e.streaming){var t=e.streaming.getBitrate();t&&t.value?e.callbacks.onBitrateUpdated(e.streaming.getBitrate()):e.callbacks.onBitrateUpdated({value:null})}else e.callbacks.onBitrateUpdated({value:null})}),5e3)}},stopStream:function(){var t,n;if(e.clearBitrateInterval(),e.channelOpen()){var i={request:"stop"};null===(t=e.streaming)||void 0===t||t.send({message:i}),null===(n=e.streaming)||void 0===n||n.hangup()}},sendData:function(t){var n;e.channelOpen()&&(null===(n=e.streaming)||void 0===n||n.data({text:t,success:function(){}}))},clearBitrateInterval:function(){e.bitrateInterval&&(clearInterval(e.bitrateInterval),e.bitrateInterval=null,e.callbacks.onBitrateUpdated({value:null}))}};return e}var ei=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card-img-top webcam_container"},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.slowLinkLoss>50,expression:"slowLinkLoss > 50"}],ref:"slowLinkWrapper",staticClass:"slow-link-wrapper",on:{click:e.slowLinkClicked,mouseenter:function(t){e.fixSlowLinkTextWidth(),e.slowLinkShowing=!0,e.slowLinkHiding=!1},mouseleave:function(t){e.fixSlowLinkTextWidth(),e.slowLinkShowing=!1,e.slowLinkHiding=!0}}},[e._m(0),n("div",{ref:"slowLinkText",staticClass:"text",class:{"show-and-hide":!e.slowLinkShowing&&!e.slowLinkHiding,showing:e.slowLinkShowing&&!e.slowLinkHiding,hiding:!e.slowLinkShowing&&e.slowLinkHiding}},[e._v("Video frames dropped")])]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.trackMuted,expression:"trackMuted"}],staticClass:"muted-status-wrapper"},[n("div",{staticClass:"text"},[e._v("Buffering...")]),n("a",{attrs:{href:"#"},on:{click:function(t){return e.showMutedStatusDescription(t)}}},[e._v("Why is it stuck?")])]),e.isVideoAvailable&&!e.autoplay&&(e.isBasicStreamingReadyToPlay||e.isBasicStreamingFrozen)?n("b-button",{staticClass:"centered-element p-0",attrs:{disabled:e.isBasicStreamingFrozen},on:{click:e.onPlayBtnClicked}},[e.isBasicStreamingReadyToPlay?n("i",{staticClass:"fas fa-play ml-1"}):e._e(),e.isBasicStreamingFrozen?n("span",{staticClass:"medium"},[e._v(e._s(e.remainingSecondsUntilNextCycle)+"s")]):e._e()]):e._e(),e.trackMuted||e.videoLoading?n("b-spinner",{staticClass:"centered-element",attrs:{label:"Buffering..."}}):e._e(),e.isVideoAvailable?n("div",[!e.autoplay&&e.isBasicStreamingInProgress||e.currentBitrate?n("div",{staticClass:"streaming-info overlay-info small",class:{clickable:e.isBasicStreamingInProgress},on:{click:e.onInfoClicked}},[e.isBasicStreamingInProgress?n("div",{staticClass:"text-success"},[e._v(e._s(e.remainingSecondsCurrentVideoCycle))]):e._e(),e.currentBitrate?n("div",[e._v(e._s(e.currentBitrate))]):e._e()]):e._e(),e.autoplay||!e.isBasicStreamingReadyToPlay&&!e.isBasicStreamingFrozen?e._e():n("div",{staticClass:"streaming-guide overlay-info",on:{click:e.onInfoClicked}},[e.isBasicStreamingReadyToPlay?n("div",{staticClass:"message"},[e._v("Webcam streams up to 5 FPS for Free")]):e._e(),e.isBasicStreamingFrozen?n("div",{staticClass:"message text-warning"},[e._v(e._s(e.remainingSecondsUntilNextCycle)+"s left in the cooldown period")]):e._e(),n("a",{staticClass:"learn-more",attrs:{href:"#"}},[e._v("Learn more...")])])]):e._e(),n("div",{class:e.webcamRotateClass},[n("div",{staticClass:"webcam_fixed_ratio",class:e.webcamRatioClass},[n("div",{staticClass:"webcam_fixed_ratio_inner full"},[e.taggedSrc!==e.printerStockImgSrc?n("img",{staticClass:"tagged-jpg",class:{flipH:e.printer.settings.webcam_flipH,flipV:e.printer.settings.webcam_flipV},attrs:{src:e.taggedSrc,alt:e.printer.name+" current image"}}):n("svg",{staticClass:"poster-placeholder"},[n("use",{attrs:{href:e.printerStockImgSrc}})])]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showMJpeg,expression:"showMJpeg"}],staticClass:"webcam_fixed_ratio_inner ontop full"},[n("img",{staticClass:"tagged-jpg",attrs:{src:e.mjpgSrc}})]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showVideo,expression:"showVideo"}],staticClass:"webcam_fixed_ratio_inner ontop full"},[n("video",{ref:"video",staticClass:"remote-video",class:{flipH:e.printer.settings.webcam_flipH,flipV:e.printer.settings.webcam_flipV},attrs:{width:"960",height:e.webcamVideoHeight,poster:e.taggedSrc!==e.printerStockImgSrc?e.taggedSrc:"",autoplay:"",muted:"",playsinline:""},domProps:{muted:!0},on:{loadstart:function(t){return e.onLoadStart()},canplay:function(t){return e.onCanPlay()}}})])])])],1)},ti=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"icon bg-warning"},[n("i",{staticClass:"fas fa-exclamation"})])}];function ni(e,t){var n,i="tsNextVideoCycle-".concat(e),r={countDownTimer:null};if(r.startOrResumeVideoCycle=function(){r.countDownTimer||(r.countDownTimer=setInterval((function(){return r.countDown()}),1e3))},r.resumeVideoCycle=function(){n<60&&!r.countDownTimer&&(r.countDownTimer=setInterval((function(){return r.countDown()}),1e3))},r.countDown=function(){r.updateRemainingSeconds(n-1),Object(o["a"])()&&localStorage.setItem(i,(new Date).getTime()/1e3+n),n<0&&(r.updateRemainingSeconds(60),clearInterval(this.countDownTimer),this.countDownTimer=null)},r.updateRemainingSeconds=function(e){n=e;var i=n-30,r=n>30?-1:n;t(i,r)},Object(o["a"])()){var a=parseFloat(localStorage.getItem(i)),s=(new Date).getTime()/1e3;!a||s>a?r.updateRemainingSeconds(60):r.updateRemainingSeconds(Math.round(a-s))}else r.updateRemainingSeconds(60);return r}function ii(e){var t={onFrame:e,contentLength:NaN,imageBuffer:"",bytesRead:0,originalJpgLength:0,onMJpegChunk:function(e){Object(Nt["e"])(e,(function(e){var n=new TextDecoder("utf-8").decode(new Uint8Array(e));if(t.contentLength){if(t.imageBuffer+=n,t.bytesRead+=n.length,t.bytesRead>=t.contentLength){var i=t.imageBuffer,r=t.originalJpgLength;t.contentLength=NaN,t.imageBuffer="",t.bytesRead=0,t.originalJpgLength=0,t.onFrame(i,r)}}else if("\r\n"==n.slice(0,2)&&"\r\n"==n.slice(n.length-2)){var a=n.slice(2,n.length-2).split(":");t.contentLength=parseInt(a[0]),t.originalJpgLength=parseInt(a[1])}}))}};return t}var ri={name:"StreamingBox",created:function(){var e=this;this.mjpegStreamDecoder=new ii((function(t,n){e.mjpgSrc="data:image/jpg;base64, "+t,e.onCanPlay()})),this.webrtc&&(this.webrtc.setCallbacks({onStreamAvailable:this.onStreamAvailable,onRemoteStream:this.onWebRTCRemoteStream,onDefaultStreamCleanup:function(){return e.isVideoVisible=!1},onSlowLink:this.onSlowLink,onTrackMuted:function(){return e.trackMuted=!0},onTrackUnmuted:function(){return e.trackMuted=!1},onBitrateUpdated:function(t){return e.currentBitrate=t.value},onMJpegData:this.mjpegStreamDecoder.onMJpegChunk}),this.autoplay||(this.videoLimit=ni(this.printer.id,this.countDownCallback)),Ln.a.on("blur",(function(){e.webrtc&&e.webrtc.stopStream()})),Ln.a.on("focus",(function(){e.webrtc&&e.autoplay&&e.webrtc.startStream()})))},props:{printer:{type:Object,required:!0},webrtc:{type:Object,required:!1},autoplay:{type:Boolean,required:!0}},data:function(){return{stickyStreamingSrc:null,isVideoAvailable:!1,isVideoVisible:!1,remainingSecondsCurrentVideoCycle:30,remainingSecondsUntilNextCycle:-1,currentBitrate:null,slowLinkLoss:0,slowLinkShowing:!1,slowLinkHiding:!1,trackMuted:!1,videoLoading:!1,printerStockImgSrc:"#svg-3d-printer",mjpgSrc:null}},computed:{taggedImgAvailable:function(){return this.taggedSrc!==this.printerStockImgSrc},showVideo:function(){return this.isVideoVisible&&"IMAGE"!==this.stickyStreamingSrc},showMJpeg:function(){return this.mjpgSrc&&"IMAGE"!==this.stickyStreamingSrc},webcamRotateClass:function(){switch(this.printer.settings.webcam_rotate90){case!0:return"webcam_rotated";case!1:return"webcam_unrotated";default:return"webcam_unrotated"}},webcamRatioClass:function(){switch(this.printer.settings.ratio169){case!0:return"ratio169";case!1:return"ratio43";default:return"ratio43"}},webcamVideoHeight:function(){switch(this.printer.settings.ratio169){case!0:return 540;case!1:return 720;default:return 720}},taggedSrc:function(){return Q()(this.printer,"pic.img_url",this.printerStockImgSrc)},isBasicStreamingInProgress:function(){return this.remainingSecondsCurrentVideoCycle>0&&this.remainingSecondsCurrentVideoCycle<30},isBasicStreamingReadyToPlay:function(){return!this.isVideoVisible&&!this.trackMuted&&!this.videoLoading&&(30==this.remainingSecondsCurrentVideoCycle||0==this.remainingSecondsUntilNextCycle)},isBasicStreamingFrozen:function(){return this.remainingSecondsUntilNextCycle>0&&!this.isVideoVisible}},methods:{onCanPlay:function(){this.videoLoading=!1,this.autoplay||this.videoLimit.startOrResumeVideoCycle()},onLoadStart:function(){this.videoLoading=!0},onStreamAvailable:function(){if(this.autoplay)this.webrtc.startStream();else{if(!this.printer.basicStreamingInWebrtc())return;!this.autoplay&&this.isBasicStreamingInProgress&&this.webrtc.startStream(),this.videoLimit.resumeVideoCycle()}this.isVideoAvailable=!0},onWebRTCRemoteStream:function(e){Hn.attachMediaStream(this.$refs.video,e);var t=e.getVideoTracks();null===t||void 0===t||0===t.length?this.isVideoVisible=!1:this.isVideoVisible=!0},countDownCallback:function(e,t){this.remainingSecondsCurrentVideoCycle>0&&e<=0&&this.webrtc.stopStream(),this.remainingSecondsCurrentVideoCycle=e,this.remainingSecondsUntilNextCycle=t},onInfoClicked:function(){this.autoplay||this.$swal.Prompt.fire({title:"Upgrade for Better Streaming",html:'\n          <p>Because you are now on the <a target="_blank" href="https://www.obico.io/docs/user-guides/upgrade-to-pro/?source=basic_streaming">Obico Cloud Free plan</a>:</p>\n          <ul>\n            <li>Streaming is limited to 5 FPS (frames per second).</li>\n            <li>After 30 seconds of streaming there is a 30-second cooldown before you can resume streaming.</li>\n          </ul>\n          <p>Support the Obico project by <a href="https://app.obico.io/ent_pub/pricing/?source=basic_streaming">upgrading to the Pro plan for little more than 1 Starbucks a month.</a></p> The Pro plan offers many perks, including the <a target="_blank" href="https://www.obico.io/docs/user-guides/webcam-streaming-for-human-eyes/?source=basic_streaming">Premium Streaming</a>:</p>\n          <ul>\n            <li>Smooth 25 FPS.</li>\n            <li>Unlimited streaming with no cooldowns.</li>\n          </ul>\n\n        ',showCloseButton:!0})},onPlayBtnClicked:function(){this.webrtc.startStream()},fixSlowLinkTextWidth:function(){var e=window.getComputedStyle(this.$refs.slowLinkText).width;this.$refs.slowLinkText.style.width=e},onSlowLink:function(e){this.slowLinkLoss+=e},slowLinkClicked:function(){this.slowLinkShowing=!1,this.slowLinkHiding=!1,this.slowLinkLoss=0,this.$swal.Prompt.fire({title:"Video frames dropped",html:"\n          <p>The video frames are getting dropped because there is a bandwidth bottleneck along the route it they take to travel from your Raspberry Pi to your computer. The bottleneck can be anywhere but in most cases <Text bold>it's either your computer's internet connection, or your Raspberry Pi's</Text>.</p>\n          <p>Make sure your computer is connected to the same network as your Pi. If you still see this warning, you need to trouble-shoot your computer's Wi-Fi connection, probably by moving closer to the Wi-Fi router.</p>\n          <p>If the webcam stream is smooth when your computer is on the same Wi-Fi network as your Pi, the bottleneck is likely with the upload speed of your internet connection. You need to run a speed test to make sure you have high-enough upload speed, as well as <b>low latency (ping)</b>.</p>\n          <p>Check out <a target=\"_blank\" href=\"https://www.obico.io/docs/user-guides/webcam-feed-is-laggy/\">the step-by-step trouble-shooting guide.</a></p>\n        ",showCloseButton:!0})},showMutedStatusDescription:function(e){e.preventDefault(),this.$swal.Prompt.fire({title:"Webcam stream buffering",html:'\n          <p>When you see the messaging about webcam stream is "buffering" occasionally, you can just reload the page. If this message repeatedly appears, it may indicate one of the problems:</p>\n          <p class="lead">1. A constricted video stream on <strong>your Raspberry Pi. The most common reasons are:</p>\n          <ul>\n            <li>Camera resolution is set too high.</li>\n            <li>Camera framerate is set too high.</li>\n            <li>The upload speed of your Raspberry Pi is too low.</li>\n          </ul>\n          <p class="lead">2. The internet connection of your computer or phone is not fast enough.</p>\n          <p class="lead">3. Your webcam is not properly connected to your Raspberry Pi.</p>\n          <br>\n          <p>Check <a target="_blank" href="https://www.obico.io/docs/user-guides/webcam-feed-is-laggy">this step-by-step troubleshooting guide</a>.</p>\n        ',showCloseButton:!0})}}},ai=ri,si=(n("4ccf"),Object(Ce["a"])(ai,ei,ti,!1,null,"83d2bf4e",null)),oi=si.exports,ci=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.valid||e.printing?e._e():n("span",[e._v("-")]),!e.valid&&e.printing?n("b-spinner",{attrs:{small:"",type:"grow",label:"Calculating..."}}):e._e(),e.valid&&e.showHours?n("span",[e._v(" "+e._s(e.hours)),n("span",{staticClass:"text-subscript text-muted"},[e._v("h")])]):e._e(),e.valid&&e.showMinutes?n("span",[e._v(" "+e._s(e.minutes)),n("span",{staticClass:"text-subscript text-muted"},[e._v("m")])]):e._e(),e.valid&&e.showSeconds?n("span",[e._v(" "+e._s(e.seconds)),n("span",{staticClass:"text-subscript text-muted"},[e._v("s")])]):e._e()],1)},li=[],di={name:"DurationBlock",props:{valid:{type:Boolean,required:!0},printing:{type:Boolean,required:!0},hours:{type:Number,default:function(){return 0}},showHours:{type:Boolean,default:function(){return!1}},minutes:{type:Number,default:function(){return 0}},showMinutes:{type:Boolean,default:function(){return!1}},seconds:{type:Number,default:function(){return 0}},showSeconds:{type:Boolean,default:function(){return!1}}}},ui=di,pi=Object(Ce["a"])(ui,ci,li,!1,null,null,null),fi=pi.exports,hi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[!e.printer.isOffline()&&e.printer.hasError()?n("div",{staticClass:"row my-2"},[n("div",{staticClass:"col-12 bg-danger text-center"},[n("div",{staticClass:"lead"},[e._v(e._s(e.printer.agentDisplayName())+" Error")]),n("div",[e._v(e._s(e.printer.status.state.error))])])]):e._e(),e.printer.inUserInteractionRequired()?n("div",{staticClass:"row my-2"},[e._m(0)]):e._e(),e.printer.inTransientState()?n("div",{staticClass:"row my-2"},[n("div",{staticClass:"col-12 text-center my-3"},[n("b-spinner",{attrs:{label:"Processing..."}}),n("div",[e._v(e._s(e.printer.status.state.text)+" ...")])],1)]):n("div",{staticClass:"row my-2"},[e.printer.isOffline()||e.printer.isDisconnected()||!e.printer.isActive()?e._e():n("div",{staticClass:"col-sm-6"},[e.printer.isPaused()?n("button",{staticClass:"btn btn-block mt-2 btn-outline-success",attrs:{type:"button"},on:{click:function(t){return e.onPauseToggled(t)}}},[n("i",{staticClass:"fas fa-play"}),e._v(" Resume ")]):n("button",{staticClass:"btn btn-block mt-2 btn-outline-warning",attrs:{type:"button"},on:{click:function(t){return e.onPauseToggled(t)}}},[n("i",{staticClass:"fas fa-pause"}),e._v(" Pause ")])]),e.printer.isOffline()||e.printer.isDisconnected()||!e.printer.isActive()?e._e():n("div",{staticClass:"col-sm-6"},[n("button",{staticClass:"btn btn-outline-danger btn-block mt-2 mb-2",attrs:{id:"print-cancel",type:"button"},on:{click:function(t){return e.$emit("PrinterActionCancelClicked",t)}}},[n("i",{staticClass:"fas fa-stop"}),e._v(" Cancel ")])]),e.printer.isOffline()||e.printer.isDisconnected()||e.printer.isActive()?e._e():n("div",{staticClass:"col-sm-6"},[n("button",{staticClass:"btn btn-outline-primary btn-block mt-2",attrs:{id:"start-print",type:"button"},on:{click:function(t){return e.$emit("PrinterActionStartClicked",t)}}},[n("i",{staticClass:"fas fa-star"}),e._v(" Start Printing ")])]),e.printer.isOffline()||e.printer.isDisconnected()||e.printer.isActive()?e._e():n("div",{staticClass:"col-sm-6"},[n("button",{staticClass:"btn btn-outline-secondary btn-block mt-2 mb-2",attrs:{type:"button"},on:{click:function(t){return e.$emit("PrinterActionControlClicked",t)}}},[n("i",{staticClass:"fas fa-arrows-alt"}),e._v(" Control ")])])]),!e.printer.isOffline()&&e.printer.isDisconnected()?n("div",{staticClass:"row my-2"},[n("div",{staticClass:"col-12 text-center py-2 text-warning"},[n("div",[e._v("Printer not connected at the serial port.")]),e.printer.isAgentMoonraker()?e._e():n("button",{staticClass:"btn btn-outline-primary btn-block mt-2",attrs:{id:"connect-printer",type:"button",disabled:e.connecting},on:{click:this.onConnectClicked}},[e.connecting?n("b-spinner",{attrs:{small:""}}):n("i",{staticClass:"fab fa-usb"}),e._v(" "+e._s(e.connecting?"Contacting OctoPrint":"Connect")+" ")],1)])]):e._e(),e.printer.isOffline()?n("div",{staticClass:"row my-2"},[n("div",{staticClass:"col-12 text-center py-3 text-warning"},[n("div",[e._v(" Obico for "+e._s(e.printer.isAgentMoonraker()?"Klipper":"OctoPrint")+" is Offline. "),e._m(1)])])]):e._e()])},mi=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"col-12 bg-warning text-center"},[n("div",[e._v("Filament change or user interaction required")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{attrs:{target:"_blank",href:"https://www.obico.io/docs/user-guides/troubleshoot-server-connection-issues/"}},[e._v("Why? "),n("small",[n("i",{staticClass:"fas fa-external-link-alt"})])])}],vi={name:"PrinterActions",props:{printer:{}},data:function(){return{connectBtnClicked:!1}},computed:{connecting:function(){return this.connectBtnClicked&&this.printer.isDisconnected()}},methods:{onPauseToggled:function(e){this.printer.isPaused()?this.$emit("PrinterActionResumeClicked",e):this.$emit("PrinterActionPauseClicked",e)},onConnectClicked:function(e){var t=this;this.$emit("PrinterActionConnectClicked",e),this.connectBtnClicked=!0,setTimeout((function(){t.connectBtnClicked=!1}),1e4)}}},gi=vi,bi=Object(Ce["a"])(gi,hi,mi,!1,null,null,null),_i=bi.exports,wi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"py-2"},[e._m(0),e._l(e.temperatures,(function(t,i){return n("div",{key:i,staticClass:"row"},[n("div",{staticClass:"col-2 numbers"},[n("span",{staticClass:"text-subscript text-muted"},[e._v(e._s(e.temperatureDisplayName(i)))])]),n("div",{staticClass:"col-5 numbers"},[e._v(" "+e._s(parseFloat(t.actual).toFixed(1))),n("span",{staticClass:"text-subscript text-muted"},[e._v("°C")])]),e.isEditable(t)?n("div",{staticClass:"col-5 numbers",on:{click:function(n){return e.onEditClicked(i,t)}}},[e._v(e._s(Math.round(t.target))),n("span",{staticClass:"text-subscript text-muted"},[e._v("°C")]),e.editable?n("span",[e._v(" "),n("i",{staticClass:"fas fa-pencil-alt",staticStyle:{"font-size":"0.6em"}})]):e._e()]):n("div",{staticClass:"col-5 numbers"},[e._v("-")])])}))],2)},Ci=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"row text-muted"},[n("div",{staticClass:"col-2"},[n("i",{staticClass:"fas fa-thermometer-half fa-lg"})]),n("small",{staticClass:"col-5"},[e._v(" Actual ")]),n("small",{staticClass:"col-5"},[e._v(" Target ")])])}],yi={name:"StatusTemp",props:{temperatures:{type:Object,required:!0},editable:{type:Boolean,required:!0}},methods:{onEditClicked:function(e,t){this.editable&&this.$emit("TempEditClicked",e,t)},isEditable:function(e){return null!==e.target},temperatureDisplayName:Nt["d"]}},ki=yi,Si=Object(Ce["a"])(ki,wi,Ci,!1,null,null,null),Pi=Si.exports,xi=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._m(0),n("div",[n("b-form-select",{attrs:{id:"connect-port"},model:{value:e.selectedPort,callback:function(t){e.selectedPort=t},expression:"selectedPort"}},e._l(e.connectionOptions.ports,(function(t){return n("b-form-select-option",{key:t,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1)],1),n("br"),e._m(1),n("div",[n("b-form-select",{attrs:{id:"connect-baudrate"},model:{value:e.selectedBaudrate,callback:function(t){e.selectedBaudrate=t},expression:"selectedBaudrate"}},[n("b-form-select-option",{attrs:{value:""}},[e._v(" Auto ")]),e._l(e.connectionOptions.baudrates,(function(t){return n("b-form-select-option",{key:t,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])}))],2)],1)])},Ti=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h5",[e._v("Serial Port:")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h5",[e._v("Baudrate:")])])}],Oi={name:"ConnectPrinter",props:{connectionOptions:{type:Object,required:!0}},data:function(){return{selectedPort:this.connectionOptions.ports[0],selectedBaudrate:""}}},Di=Oi,Ii=Object(Ce["a"])(Di,xi,Ti,!1,null,null,null),Ai=Ii.exports,ji=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"text-center"},[e.value>0?n("h1",{staticClass:"target-temp-degree"},[e._v(e._s(e.value)+" "),n("span",{staticClass:"text-subscript text-muted"},[e._v("°C")])]):e._e(),e.value<1?n("h1",{staticClass:"target-temp-degree"},[e._v("OFF")]):e._e()]),n("br"),n("div",{staticClass:"mb-5"},[e._m(0),n("div",[n("b-form-select",{attrs:{id:"id_preset"},on:{change:e.onPresetChanged},model:{value:e.preset,callback:function(t){e.preset=t},expression:"preset"}},e._l(e.allPresets,(function(t){return n("b-form-select-option",{key:t.value,attrs:{value:parseInt(t.value)}},[e._v(" "+e._s(t.title)+" ")])})),1)],1),n("br"),n("h5",[e._v("Manual:")]),n("div",[n("vue-slider",{attrs:{min:0,max:e.maxTemp,step:1,tooltip:"none"},on:{change:e.onSliderChanged},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],attrs:{id:"target-temp",type:"hidden"},domProps:{value:e.value},on:{input:function(t){t.target.composing||(e.value=t.target.value)}}})],1)])])},Ei=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h5",[e._v("Presets:")])])}],Fi=n("4971"),Ri=n.n(Fi),Ni={name:"TempTargetEditor",components:{VueSlider:Ri.a},props:{presets:{type:Array,required:!0},maxTemp:{type:Number,required:!0},curTarget:{type:Number,required:!0}},data:function(){var e=this,t=this.presets.find((function(t){return t.target==e.curTarget}))||{target:0!=this.curTarget?-1:0};return{value:this.curTarget,preset:t.target}},computed:{allPresets:function(){var e=[];return e.push({value:-1,title:"Manual"}),e.push({value:0,title:"OFF"}),this.presets.forEach((function(t){t.target&&e.push({value:t.target,title:"".concat(t.name," (").concat(t.target,"°C)")})})),e}},methods:{onPresetChanged:function(){this.preset>-1&&(this.value=this.preset)},onSliderChanged:function(){0==this.value?this.preset=0:this.preset=-1}}},Mi=Ni,Li=Object(Ce["a"])(Mi,ji,Ei,!1,null,null,null),Bi=Li.exports,$i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h2",{staticClass:"text-center"},[e._v("Printer Feed Sharing")]),n("hr"),e.isProAccount?n("div",[n("div",{staticClass:"py-3"},[n("div",{staticClass:"custom-control custom-switch"},[n("input",{staticClass:"custom-control-input update-printer",attrs:{type:"checkbox",id:"sharing_enabled-toggle-"+e.printer.id},domProps:{checked:e.sharedResource},on:{click:e.onSharingToggled}}),n("label",{staticClass:"custom-control-label",staticStyle:{"font-size":"1rem"},attrs:{for:"sharing_enabled-toggle-"+e.printer.id}},[e._v('Share live feed for printer "'),n("b",[e._v(e._s(e.printer.name))]),e._v('"')])]),n("div",{staticClass:"form-group"},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.sharedLink,expression:"sharedLink"}]},[n("div",{staticClass:"input-group mt-4 mb-2"},[n("input",{ref:"sharedLink",staticClass:"form-control shared-link-text",attrs:{type:"text",id:"secret-token-input","aria-label":"Secret token",readonly:""},domProps:{value:e.sharedLink}}),n("div",{staticClass:"input-group-append"},[n("div",{staticClass:"copy-button",attrs:{id:"copy-link","data-clipboard-target":"#secret-token-input","aria-label":"Copy secure link to clipboard"},on:{click:e.copyToClipboard}},[n("i",{staticClass:"fas fa-clipboard"})]),n("b-tooltip",{attrs:{show:e.copyStatus,target:"copy-link",triggers:"click",placement:"bottom"},on:{"update:show":function(t){e.copyStatus=t}}},[e._v(e._s(e.copyMessage))])],1)]),n("div",{staticClass:"my-1"},[e._v("Click the clipboard icon above to copy the secure shareable link to your clipboard.")]),n("div",{staticClass:"my-1"},[e._v("You can test the shareable link by right-clicking "),n("a",{attrs:{href:e.sharedLink}},[e._v("here")]),e._v(' and select "Open Link in Incognito Window".')]),n("br"),e._m(3)])]),n("br")])]):n("div",[e._m(0),n("p",[e._v("Printer feed sharing is a Pro feature.")]),e._m(1),e._m(2)])])},Ui=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("h5",{staticClass:"mb-5"},[e._v("Wait! You need to "),n("a",{attrs:{href:"/ent_pub/pricing/"}},[e._v("upgrade to the Pro plan")]),e._v(" to enable Printer feed. ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("a",{attrs:{href:"https://www.obico.io/docs/user-guides/upgrade-to-pro#why-cant-the-detective-just-work-for-free-people-love-free-you-know"}},[e._v("Running the Obico app incurs non-trivial amount of costs")]),e._v(". With little more than 1 Starbucks per month, you can upgrade to a Pro account and help us run the Obico app smoothly.")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",[n("a",{attrs:{href:"/ent_pub/pricing/"}},[e._v("Check out Pro pricing >>>")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("em",{staticClass:"text-muted"},[n("small",[n("div",[e._v("Notes:")]),n("ul",[n("li",[e._v("Send the secure link to anyone you want to share your printer feed with. They do NOT need the Obico account to see your printer feed.")]),n("li",[e._v("Anyone with this shareable link will be able to see your printer feed. "),n("a",{attrs:{href:"https://www.obico.io/docs/user-guides/printer-feed-sharing/"}},[e._v("Learn more about what they can see.")])])])])])}],zi={props:{isProAccount:{type:Boolean,default:!1},printer:{type:Object,required:!0}},data:function(){return{share:!1,sharedResource:null,copyStatus:!1,copyMessage:""}},created:function(){this.fetchSharedResources()},computed:{sharedLink:function(){if(this.sharedResource){var e=window.location;return"".concat(e.protocol,"//").concat(e.host,"/printers/share_token/").concat(this.sharedResource.share_token,"/")}return""}},methods:{fetchSharedResources:function(){var e=this;return G.a.get(Y["a"].sharedResources({printer_id:this.printer.id})).then((function(t){t.data.length>0&&(e.sharedResource=t.data[0])}))},postSharedResources:function(){var e=this;return G.a.post(Y["a"].sharedResources({printer_id:this.printer.id})).then((function(t){t.data.length>0&&(e.sharedResource=t.data[0])}))},deleteSharedResources:function(){var e=this;return G.a.delete(Y["a"].sharedResource(this.sharedResource.id)).then((function(){e.sharedResource=null}))},onSharingToggled:function(){this.sharedResource?this.deleteSharedResources():this.postSharedResources()},copyToClipboard:function(){this.copyStatus=!0,this.$refs.sharedLink.focus(),this.$refs.sharedLink.select();try{document.execCommand("copy"),this.copyMessage="Copied!"}catch(e){console.error("Fallback: Oops, unable to copy",e),this.copyMessage="Failed!"}}}},Vi=zi,Wi=(n("d0e8"),Object(Ce["a"])(Vi,$i,Ui,!1,null,"584a6b50",null)),qi=Wi.exports,Gi="/pause_print/",Hi="/resume_print/",Ji="/cancel_print/",Yi="/mute_current_print/?mute_alert=true",Ki="/acknowledge_alert/?alert_overwrite=NOT_FAILED",Qi=!0,Zi=!1,Xi={Settings:"panel-settings",Time:"print-time",StatusTemp:"status_temp_block"},er={name:"PrinterCard",components:{StreamingBox:oi,Gauge:Wt,DurationBlock:fi,PrinterActions:_i,StatusTemp:Pi},props:{printer:{type:Object,required:!0},isProAccount:{type:Boolean,required:!0}},data:function(){return{section_toggles:{settings:c(Xi.Settings+String(this.printer.id),Qi),time:c(Xi.Time+String(this.printer.id),Zi),statusTemp:c(Xi.StatusTemp+String(this.printer.id),Qi)},webrtc:Qn()}},created:function(){var e=this;this.printerComm=$n(this.printer.id,Y["a"].printerWebSocket(this.printer.id),(function(t){e.$emit("PrinterUpdated",e.updatedPrinter(t))}),(function(t){var n=t.status||t.octoprint_data;e.$emit("PrinterUpdated",e.updatedPrinter({status:n}))})),this.printerComm.connect(),this.webrtc.openForPrinter(this.printer.id,this.printer.auth_token),this.printerComm.setWebRTC(this.webrtc)},computed:{isWatching:function(){return!this.printer.not_watching_reason},timeRemaining:function(){return this.toDuration(this.secondsLeft,this.printer.isActive())},timeTotal:function(){var e=null;return this.secondsPrinted&&this.secondsLeft&&(e=this.secondsPrinted+this.secondsLeft),this.toDuration(e,this.printer.isActive())},secondsLeft:function(){return Q()(this.printer,"status.progress.printTimeLeft")},secondsPrinted:function(){return Q()(this.printer,"status.progress.printTime")},watchForFailures:function(){return this.printer.watching_enabled},pauseOnFailure:function(){return"PAUSE"==this.printer.action_on_failure},hasCurrentPrintFilename:function(){return!(!this.printer.current_print||!this.printer.current_print.filename)},actionsProps:function(){return{printer:this.printer}},progressPct:function(){return Q()(this.printer,"status.progress.completion")||0},tempProps:function(){for(var e=void 0!=Q()(this.printer,"settings.temp_profiles"),t={},n=0,i=Object.entries(Q()(this.printer,"status.temperatures",{}));n<i.length;n++){var r=Object(Fn["a"])(i[n],2),a=r[0],s=r[1];Boolean(s.actual)&&!isNaN(s.actual)&&(t[a]=s)}return{temperatures:t,show:Object.keys(t).length>0,editable:e}},statusText:function(){return Q()(this.printer,"status.state.text","Offline")},statusClass:function(){return this.printer.hasError()?"text-danger":this.printer.isOffline()||this.printer.isDisconnected()||this.printer.inTransientState()?"text-warning":"text-success"}},methods:{updatedPrinter:function(e){return se(e,this.printer)},settingsUrl:function(){return"/printers/".concat(this.printer.id,"/")},octoPrintTunnelUrl:function(){return"/tunnels/".concat(this.printer.id,"/")},onSettingsToggleClicked:function(){this.section_toggles.settings=!this.section_toggles.settings,l(Xi.Settings+String(this.printer.id),this.section_toggles.settings)},onTimeToggleClicked:function(){this.section_toggles.time=!this.section_toggles.time,l(Xi.Time+String(this.printer.id),this.section_toggles.time)},onStatusTempToggleClicked:function(){this.section_toggles.statusTemp=!this.section_toggles.statusTemp,l(Xi.StatusTemp+String(this.printer.id),this.section_toggles.statusTemp)},onNotAFailureClicked:function(e,t){var n=this;this.$swal.Confirm.fire({title:"Noted!",html:'<p>Do you want to keep failure detection on for this print?</p><small>If you select "No", failure detection will be turned off for this print, but will be automatically turned on for your next print.</small>',confirmButtonText:"Yes",cancelButtonText:"No"}).then((function(e){"cancel"==e.dismiss&&setTimeout((function(){n.sendPrinterAction(n.printer.id,Yi,!1)}),1e3),t?n.sendPrinterAction(n.printer.id,Hi,!0):n.sendPrinterAction(n.printer.id,Ki,!1)})),e.preventDefault()},onWatchForFailuresToggled:function(){this.printer.watching_enabled=!this.printer.watching_enabled,this.updatePrinter(this.printer)},onPauseOnFailureToggled:function(){this.printer.action_on_failure="PAUSE"==this.printer.action_on_failure?"NONE":"PAUSE",this.updatePrinter(this.printer)},onPrinterActionPauseClicked:function(){var e=this;this.$swal.Confirm.fire({html:'If you haven\'t changed the default configuration, the heaters will be turned off, and the print head will be z-lifted. The reversed will be performed before the print is resumed. <a target="_blank" href="https://www.obico.io/docs/user-guides/detection-print-job-settings#when-print-is-paused">Learn more. <small><i class="fas fa-external-link-alt"></i></small></a>'}).then((function(t){t.value&&e.sendPrinterAction(e.printer.id,Gi,!0)}))},onPrinterActionResumeClicked:function(e){this.printer.alertUnacknowledged()?this.onNotAFailureClicked(e,!0):this.sendPrinterAction(this.printer.id,Hi,!0)},onPrinterActionCancelClicked:function(){var e=this;this.$swal.Confirm.fire({text:"Once cancelled, the print can no longer be resumed."}).then((function(t){t.value&&e.sendPrinterAction(e.printer.id,Ji,!0)}))},onPrinterActionConnectClicked:function(){var e=this;this.printerComm.passThruToPrinter({func:"get_connection_options",target:"_printer"},(function(t,n){t?e.$swal.Toast.fire({icon:"error",title:"Failed to connect!"}):n.ports.length<1?e.$swal.Toast.fire({icon:"error",title:"Uh-Oh. No printer is found on the serial port."}):e.$swal.openModalWithComponent(Ai,{connectionOptions:n},{confirmButtonText:"Connect",showCancelButton:!0,preConfirm:function(){return{port:document.getElementById("connect-port").value,baudrate:document.getElementById("connect-baudrate").value}}}).then((function(t){if(t.value){var n=[t.value.port,t.value.baudrate];e.printerComm.passThruToPrinter({func:"connect",target:"_printer",args:n})}}))}))},onPrinterActionStartClicked:function(){this.$emit("printModalOpened"),this.$bvModal.show("b-modal-gcodes")},onPrinterActionControlClicked:function(){window.location=Y["a"].printerControl(this.printer.id)},onTempEditClicked:function(e,t){var n,i=this,r=Q()(this.printer,"settings.temp_profiles",[]),a=350;e.search(/bed|chamber/)>-1&&(a=140),n=e.search(/tool/)>-1?r.map((function(e){return{name:e.name,target:e["extruder"]}})):r.map((function(t){return{name:t.name,target:t[e]}})),this.$swal.openModalWithComponent(Bi,{presets:n,maxTemp:a,curTarget:t.target},{title:"Set "+Object(Nt["d"])(e)+" Temperature",confirmButtonText:"Confirm",showCancelButton:!0,preConfirm:function(){return{target:parseInt(document.getElementById("target-temp").value)}}}).then((function(t){if(t.value){var n=t.value.target;i.printerComm.passThruToPrinter({func:"set_temperature",target:"_printer",args:[e,n]})}}))},updatePrinter:function(e){var t=this;return G.a.patch(Y["a"].printer(e.id),{watching_enabled:e.watching_enabled,action_on_failure:e.action_on_failure}).then((function(e){if(!e.data.succeeded)throw e;t.$emit("PrinterUpdated",se(e.data.printer,t.printer))})).catch((function(e){console.error(e),t.$swal.Toast.fire({icon:"error",title:"Failed to update printer!"})}))},sendPrinterAction:function(e,t,n){var i=this;G.a.post(Y["a"].printerAction(e,t)).then((function(){var e="";n&&(e+="<h6>Successfully sent command to ".concat(i.printer.name,"!</h6>")+"<p>It may take a while to be executed.</p>"),""!=e&&i.$swal.Toast.fire({icon:"success",html:e})}))},shouldVideoBeFull:function(e){var t=Q()(e,"pic.img_url"),n=e.alertUnacknowledged()&&t;return!n},toDuration:function(e,t){if(null==e||0==e)return{valid:!1,printing:t};var n=J.a.duration(e,"seconds"),i=Math.floor(n.asHours()),r=n.minutes(),a=n.seconds();return{valid:!0,printing:t,hours:i,showHours:i>0,minutes:r,showMinutes:i>0||r>0,seconds:a,showSeconds:0==i&&0==r}},onSharePrinter:function(){this.$swal.openModalWithComponent(qi,{isProAccount:this.isProAccount,printer:this.printer},{confirmButtonText:"Close"})}}},tr=er,nr=(n("bab6"),Object(Ce["a"])(tr,jn,En,!1,null,"7df4621a",null)),ir=nr.exports,rr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("layout",{attrs:{isPopup:e.isPopup},scopedSlots:e._u([{key:"topBarLeft",fn:function(){return[e.isPopup&&null!==e.parentFolder?n("a",{staticClass:"btn shadow-none icon-btn d-inline",attrs:{href:"#",title:"Go Back"},on:{click:function(t){return t.preventDefault(),e.goBack(t)}}},[n("i",{staticClass:"fas fa-chevron-left"})]):e._e(),n("search-input",{staticClass:"search-input mr-3",on:{input:e.updateSearch}})]},proxy:!0},{key:"topBarRight",fn:function(){return[n("div",{staticClass:"d-flex"},[e.isCloud?n("a",{staticClass:"btn shadow-none icon-btn d-none d-md-inline",attrs:{href:"#",title:"Create folder"},on:{click:function(t){return t.preventDefault(),e.createFolder(t)}}},[n("i",{staticClass:"fas fa-folder-plus"})]):e._e(),n("b-dropdown",{staticClass:"order-md-2",attrs:{right:"","no-caret":"","toggle-class":"icon-btn"},scopedSlots:e._u([{key:"button-content",fn:function(){return[n("i",{staticClass:"fas fa-server"})]},proxy:!0}])},[n("b-dropdown-text",{staticClass:"small text-secondary"},[e._v("STORAGE")]),n("b-dropdown-item",{on:{click:e.switchToCloudStorage}},[n("div",{staticClass:"dropdown-group"},[n("i",{staticClass:"fas fa-check text-primary",style:{visibility:e.isCloud?"visible":"hidden"}}),n("div",{staticClass:"text"},[n("div",{staticClass:"title"},[e._v("Obico Cloud")])])])]),e._l(e.printers,(function(t){return n("b-dropdown-item",{key:t.id,on:{click:function(){return e.switchToPrinterStorage(t)}}},[n("div",{staticClass:"dropdown-group"},[n("i",{staticClass:"fas fa-check text-primary",style:{visibility:e.selectedPrinterId===t.id?"visible":"hidden"}}),n("div",{staticClass:"text"},[n("div",{staticClass:"title"},[e._v(e._s(t.name))]),n("div",{staticClass:"subtitle",class:{"text-secondary":"offline"===t.storageAvailability.key,"text-success":"online"===t.storageAvailability.key,"text-warning":"plugin_outdated"===t.storageAvailability.key}},[e._v(" "+e._s(t.storageAvailability.text)+" ")])])])])}))],2),e.isCloud?n("b-dropdown",{staticClass:"order-md-1",attrs:{right:"","no-caret":"","toggle-class":"icon-btn"},scopedSlots:e._u([{key:"button-content",fn:function(){return[n("i",{staticClass:"fas fa-ellipsis-v d-md-none"}),n("i",{staticClass:"fas fa-sort-amount-down d-none d-md-block"})]},proxy:!0}],null,!1,3550382305)},[n("b-dropdown-item",{staticClass:"d-md-none",on:{click:e.createFolder}},[n("i",{staticClass:"fas fa-folder-plus"}),e._v("Create Folder ")]),n("b-dropdown-divider",{staticClass:"d-md-none"}),n("b-dropdown-text",{staticClass:"small text-secondary"},[e._v("ORDER")]),e._l(e.sorting.options,(function(t){return n("b-dropdown-item",{key:"s_"+t.id,on:{click:function(){return e.updateSorting(t)}}},[n("i",{staticClass:"fas fa-check text-primary",style:{visibility:e.activeSorting.id===t.id?"visible":"hidden"}}),e._v(" "+e._s(t.title)+" ")])})),n("b-dropdown-divider"),e._l(e.sorting.directions,(function(t){return n("b-dropdown-item",{key:"d_"+t.id,on:{click:function(){return e.updateSorting(e.activeSorting,t)}}},[n("i",{staticClass:"fas fa-check text-primary",style:{visibility:e.activeSortingDirection.id===t.id?"visible":"hidden"}}),e._v(" "+e._s(t.title)+" ")])}))],2):e._e(),e.onClose?n("a",{staticClass:"btn shadow-none icon-btn d-inline order-4",attrs:{href:"#",title:"Close"},on:{click:function(t){return t.preventDefault(),e.onClose(t)}}},[n("i",{staticClass:"fas fa-times text-danger"})]):e._e()],1)]},proxy:!0},{key:"content",fn:function(){return[n("b-container",[n("b-row",[n("b-col",[e.isCloud?n("vue-dropzone",{ref:"gcodesDropzone",staticClass:"upload-box",attrs:{id:"dropzone",options:e.dropzoneOptions,useCustomSlot:!0},on:{"vdropzone-queue-complete":e.gcodeUploadSuccess,"vdropzone-error":e.gcodeUploadError,"vdropzone-sending":e.addParentFolderParam}},[n("div",{staticClass:"dz-message needsclick"},[n("i",{staticClass:"fas fa-upload fa-2x"}),e._v(" "),n("br"),n("div",[e._v("G-Code file (*.gcode, *.gco, or *.g) only.")]),n("div",[e._v("Up to "+e._s(e.maxFilesize)+" MB each file, "+e._s(e.maxTotalFilesize)+" GB total.")])])]):e._e(),n("div",{staticClass:"gcodes-wrapper"},[n("div",{staticClass:"header-panel",class:{"without-action-buttons":!e.isCloud&&!e.targetPrinter}},[n("div",{staticClass:"text"},[e._v("Name")]),n("div",{staticClass:"text"},[e._v("Size")]),n("div",{staticClass:"text"},[e._v("Created")]),e.isCloud?n("div",{staticClass:"text"},[e._v("Last printed")]):e._e()]),n("div",{staticClass:"gcode-items-wrapper"},[e.searchStateIsActive?e._e():n("div",e._l(e.folders,(function(t){return n("div",{key:"folder_"+t.id,staticClass:"item folder",on:{click:function(n){return e.openFolder(n,t)}}},[n("div",{staticClass:"item-info"},[n("div",{staticClass:"filename"},[n("i",{staticClass:"fas fa-folder mr-1"}),e._v(" "+e._s(t.name)+" ")]),n("div",{staticClass:"size"},[e._v(e._s(t.numItems)+" item(s)")]),n("div",{staticClass:"created"},[e._v(e._s(t.created_at?t.created_at.fromNow():"-"))]),e.isCloud?n("div",{staticClass:"d-none d-md-block"},[e._v("-")]):e._e()]),e.isCloud?n("div",[n("b-dropdown",{attrs:{right:"","no-caret":"","toggle-class":"icon-btn py-0"},scopedSlots:e._u([{key:"button-content",fn:function(){return[n("i",{staticClass:"fas fa-ellipsis-v"})]},proxy:!0}],null,!0)},[n("b-dropdown-item",{on:{click:function(n){return e.renameItem(t)}}},[n("i",{staticClass:"fas fa-edit"}),e._v("Rename ")]),n("b-dropdown-item",{on:{click:function(n){return e.deleteItem(t)}}},[n("span",{staticClass:"text-danger"},[n("i",{staticClass:"fas fa-trash-alt"}),e._v("Delete ")])])],1)],1):e._e()])})),0),e.searchInProgress?e._e():n("div",e._l(e.files,(function(t,i){return n("div",{key:"gcode_"+i,staticClass:"item",on:{click:function(n){return e.openFile(n,t)}}},[n("div",{staticClass:"item-info"},[n("div",{staticClass:"filename"},[n("i",{staticClass:"fas fa-file-code mr-1"}),e._v(" "+e._s(t.filename)+" ")]),n("div",{staticClass:"size"},[e._v(e._s(t.filesize))]),n("div",{staticClass:"uploaded"},[e._v(e._s(t.created_at?t.created_at.fromNow():"-"))]),e.isCloud?n("div",{staticClass:"last-printed"},[t.print_set?t.print_set.length?t.last_print?n("span",[e._v(e._s(t.last_print.ended_at?t.last_print.ended_at.fromNow():"Printing..."))]):e._e():n("span",[e._v("No prints yet")]):n("span",[e._v("-")]),t.last_print_result?n("div",{staticClass:"circle-indicator",class:t.last_print_result}):e._e()]):e._e()]),e.isCloud||e.targetPrinter?n("div",[n("b-dropdown",{attrs:{right:"","no-caret":"","toggle-class":"icon-btn py-0"},scopedSlots:e._u([{key:"button-content",fn:function(){return[n("i",{staticClass:"fas fa-ellipsis-v"})]},proxy:!0}],null,!0)},[e.targetPrinter?n("b-dropdown-item",{on:{click:function(n){return e.onPrintClicked(n,t)}}},[n("span",{staticClass:"text-primary"},[n("i",{staticClass:"fas fa-play-circle"}),e._v("Print on "+e._s(e.targetPrinter.name)+" ")])]):e._e(),e.isCloud?n("b-dropdown-item",{on:{click:function(n){return e.renameItem(t)}}},[n("i",{staticClass:"fas fa-edit"}),e._v("Rename ")]):e._e(),e.isCloud?n("b-dropdown-item",{on:{click:function(n){return e.deleteItem(t)}}},[n("span",{staticClass:"text-danger"},[n("i",{staticClass:"fas fa-trash-alt"}),e._v("Delete ")])]):e._e()],1)],1):e._e()])})),0),e.isCloud?n("mugen-scroll",{staticClass:"text-center",attrs:{"v-show":!e.isFolderEmpty,handler:e.fetchFilesAndFolders,"should-handle":!e.loading,"scroll-container":e.scrollContainerId}},[e.noMoreFolders&&e.noMoreFiles&&!e.searchInProgress?e._e():n("div",{staticClass:"py-5"},[n("b-spinner",{attrs:{label:"Loading..."}})],1)]):e._e(),e.isCloud||!e.localFilesLoading&&!e.searchInProgress?n("div",[e.isFolderEmpty?n("div",{staticClass:"placeholder text-secondary"},[n("span",[e._v("Nothing here yet")])]):e.nothingFound?n("div",{staticClass:"placeholder text-secondary"},[n("span",[e._v("Nothing found")])]):e._e()]):n("div",{staticClass:"text-center py-5"},[n("b-spinner",{attrs:{label:"Loading..."}})],1)],1)])],1)],1)],1),n("rename-modal",{ref:"renameModal",attrs:{item:e.activeItem,preConfirm:e.verifyItemRename},on:{renamed:e.onItemRenamed}}),n("delete-confirmation-modal",{ref:"deleteConfirmationModal",attrs:{item:e.activeItem},on:{deleted:e.onItemDeleted}}),n("new-folder-modal",{ref:"newFolderModal",attrs:{preConfirm:e.verifyNewFolder,parentFolderId:e.parentFolder},on:{created:e.onFolderCreated}})]},proxy:!0}])})},ar=[],sr=(n("96cf"),n("c964")),or=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search-wrapper"},[e._m(0),n("input",{staticClass:"dark",attrs:{type:"text",placeholder:"Search"},domProps:{value:e.value},on:{input:function(t){return e.$emit("input",t.target.value)},focus:function(t){return e.$emit("focus")},blur:function(t){return e.$emit("blur")}}})])},cr=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search-icon"},[n("i",{staticClass:"fas fa-search"})])}],lr={name:"SearchInput",props:{value:{type:String,default:""}}},dr=lr,ur=(n("f249"),Object(Ce["a"])(dr,or,cr,!1,null,"13f49efa",null)),pr=ur.exports,fr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{attrs:{id:"b-modal-new-folder",title:"Enter new folder name","ok-title":"Create",centered:""},on:{ok:e.handleOk,hidden:e.resetModal,shown:e.focusInput}},[n("form",{on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[n("div",{staticClass:"my-2"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.newFolderName,expression:"newFolderName"}],ref:"input",staticClass:"input-lg",attrs:{type:"text",name:"name",placeholder:"Folder name",required:"required"},domProps:{value:e.newFolderName},on:{input:function(t){t.target.composing||(e.newFolderName=t.target.value)}}}),e.errorMessage?n("b-alert",{staticClass:"mt-3",attrs:{variant:"danger",show:""}},[e._v(" "+e._s(e.errorMessage)+" ")]):e._e()],1)])])},hr=[],mr={name:"NewFolderModal",props:{preConfirm:{type:Function,default:null},parentFolderId:{type:String,default:null},targetPrinterId:{type:Number,required:!1}},data:function(){return{newFolderName:"",errorMessage:"",isOpen:!1}},methods:{show:function(){this.isOpen=!0,this.$bvModal.show("b-modal-new-folder")},focusInput:function(){this.$refs.input.select()},resetModal:function(){this.isOpen=!1,this.newFolderName="",this.errorMessage=""},handleOk:function(e){e.preventDefault(),this.handleSubmit()},handleSubmit:function(){var e=this;return Object(sr["a"])(regeneratorRuntime.mark((function t(){var n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.newFolderName){t.next=2;break}return t.abrupt("return");case 2:if(!e.preConfirm){t.next=7;break}if(n=e.preConfirm(e.newFolderName),!0===n){t.next=7;break}return e.errorMessage=n,t.abrupt("return");case 7:return t.prev=7,t.next=10,G.a.post(Y["a"].gcodeFolders(),{name:e.newFolderName,parent_folder:e.parentFolderId});case 10:i=t.sent,e.$emit("created",i.data.id),e.$bvModal.hide("b-modal-new-folder"),t.next=19;break;case 15:return t.prev=15,t.t0=t["catch"](7),console.log(t.t0),t.abrupt("return");case 19:case"end":return t.stop()}}),t,null,[[7,15]])})))()}}},vr=mr,gr=(n("899c"),Object(Ce["a"])(vr,fr,hr,!1,null,"6829136c",null)),br=gr.exports,_r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-modal",{attrs:{id:"b-modal-rename",title:"Enter new name","ok-title":"Rename",centered:""},on:{ok:e.handleOk,hidden:e.resetModal,shown:e.focusInput}},[n("form",{on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[n("div",{staticClass:"my-2"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.newItemName,expression:"newItemName"}],ref:"input",staticClass:"input-lg",attrs:{type:"text",name:"name",placeholder:"New name",required:"required"},domProps:{value:e.newItemName},on:{input:function(t){t.target.composing||(e.newItemName=t.target.value)}}}),e.errorMessage?n("b-alert",{staticClass:"mt-3",attrs:{variant:"danger",show:""}},[e._v(" "+e._s(e.errorMessage)+" ")]):e._e()],1)])])},wr=[],Cr={name:"RenameModal",components:{},props:{item:{type:Object,default:null},preConfirm:{type:Function,default:null}},data:function(){return{newItemName:"",errorMessage:"",isOpen:!1}},computed:{itemType:function(){return this.item.filename?"file":"folder"},fullName:function(){return"file"===this.itemType?"".concat(this.newItemName,".").concat(this.fileExt):this.newItemName},fileExt:function(){return"folder"===this.itemType?null:this.item.filename.split(".").at(-1)},nameWithoutExt:function(){if("folder"===this.itemType)return this.item.name;var e=this.item.filename;return e.slice(0,e.length-this.fileExt.length-1)},newNameWithExt:function(){return"folder"===this.itemType?this.newItemName:"".concat(this.newItemName,".").concat(this.fileExt)}},methods:{show:function(){var e=this;this.isOpen=!0,setTimeout((function(){e.item?(e.newItemName=e.nameWithoutExt,e.$bvModal.show("b-modal-rename")):e.isOpen=!1}),100)},focusInput:function(){this.$refs.input.select()},close:function(){this.$bvModal.hide("b-modal-rename"),this.resetModal()},resetModal:function(){this.isOpen=!1,this.newItemName="",this.errorMessage=""},handleOk:function(e){this.newNameWithExt!==(this.item.filename||this.item.name)?(e.preventDefault(),this.handleSubmit()):this.close()},handleSubmit:function(){var e=this;return Object(sr["a"])(regeneratorRuntime.mark((function t(){var n,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.item.id,e.newItemName){t.next=3;break}return t.abrupt("return");case 3:if(e.newNameWithExt!==(e.item.filename||e.item.name)){t.next=6;break}return e.close(),t.abrupt("return");case 6:if(!e.preConfirm){t.next=11;break}if(i=e.preConfirm(e.newNameWithExt),!0===i){t.next=11;break}return e.errorMessage=i,t.abrupt("return");case 11:return t.prev=11,r="file"===e.itemType?Y["a"].gcodeFile(n):Y["a"].gcodeFolder(n),t.next=15,G.a.patch(r,"".concat("file"===e.itemType?"filename":"name","=").concat(e.newNameWithExt));case 15:t.next=22;break;case 17:return t.prev=17,t.t0=t["catch"](11),e.errorMessage="Server error",console.log(t.t0),t.abrupt("return");case 22:e.$emit("renamed",e.newNameWithExt),e.close();case 24:case"end":return t.stop()}}),t,null,[[11,17]])})))()}}},yr=Cr,kr=(n("8c3a"),Object(Ce["a"])(yr,_r,wr,!1,null,"2642e784",null)),Sr=kr.exports,Pr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div")},xr=[],Tr={name:"RenameModal",props:{item:{type:Object,default:null}},data:function(){return{isOpen:!1}},created:function(){},mounted:function(){},methods:{show:function(){var e=this;this.isOpen=!0,this.$bvModal.msgBoxConfirm("Are you sure?",{id:"b-modal-confirm-delete",centered:!0,okTitle:"Delete",okVariant:"danger",size:"sm",autoFocusButton:"ok"}).then(function(){var t=Object(sr["a"])(regeneratorRuntime.mark((function t(n){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isOpen=!1,n){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,i=e.item.filename?Y["a"].gcodeFile(e.item.id):Y["a"].gcodeFolder(e.item.id),t.next=7,G.a.delete(i);case 7:t.next=13;break;case 9:return t.prev=9,t.t0=t["catch"](3),console.log(t.t0),t.abrupt("return");case 13:e.$emit("deleted");case 14:case"end":return t.stop()}}),t,null,[[3,9]])})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.log(e)}))}}},Or=Tr,Dr=(n("667b"),Object(Ce["a"])(Or,Pr,xr,!1,null,null,null)),Ir=Dr.exports,Ar=function(e){var t=e.printerId,n=e.gcode,i=e.isCloud,r=e.Swal,a=e.onCommandSent,s=e.onPrinterStatusChanged,o=$n(t,Y["a"].printerWebSocket(t),(function(e){}),(function(e){}));o.connect((function(){var e;e=i?{func:"download",target:"file_downloader",args:[n]}:{func:"select_file",target:"_printer",args:["".concat(n.path),null],kwargs:{printAfterSelect:"true"}},o.passThruToPrinter(e,(function(e,n){if(e||(null===n||void 0===n?void 0:n.error))r.Toast.fire({icon:"error",title:e||n.error});else{a&&a(),r.Prompt.fire({html:'\n            <div class="text-center">\n              <i class="fas fa-spinner fa-spin fa-lg py-3"></i>\n              <h5 class="pt-3">\n                Starting the print...\n              </h5>\n            </div>\n          ',showConfirmButton:!1});var i=function(){var e=Object(sr["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,G.a.get(Y["a"].printer(t));case 3:n=e.sent,n=n.data,e.next=11;break;case 7:return e.prev=7,e.t0=e["catch"](0),console.error(e.t0),e.abrupt("return");case 11:"Operational"===Q()(n,"status.state.text")?setTimeout(i,1e3):(r.close(),s&&s());case 12:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();i()}}))}))},jr=function(e){return e.isOffline()||e.isDisconnected()||e.isActive()?{key:"unavailable",text:"Unavailable"}:{key:"ready",text:"Ready"}},Er=function(e,t){var n,i=t.query,r=t.path,a=t.onRequestEnd;n=i?{filter:String(i),recursive:!0}:{path:r,recursive:!1,level:1},e.passThruToPrinter({func:"list_files",target:"_file_manager",kwargs:n},(function(e,t){if(e)a();else if(t){var n=[],r=[];if(!(null===t||void 0===t?void 0:t.local)||!Object.keys(t.local).length)return void a();delete t.local.ObicoUpload;var s,o=Boolean(i)?Fr(t.local):Object.values(t.local),c=Object(Vn["a"])(o);try{for(c.s();!(s=c.n()).done;){var l=s.value;"folder"===l.type?n.push({id:l.path,path:l.path,name:l.display,numItems:Object.keys(l.children).length}):r.push({id:l.path,path:l.path,filename:l.name,num_bytes:l.size,filesize:X()(l.size),created_at:ne(new Date(1e3*l.date))})}}catch(e){c.e(e)}finally{c.f()}a({folders:n,files:r})}else a()}))},Fr=function e(t){for(var n=[],i=0,r=Object.values(t);i<r.length;i++){var a=r[i];a.children?n.push.apply(n,Object(R["a"])(e(a.children))):n.push(a)}return n},Rr=function(e){var t=e.agentDisplayName(),n="2.3.0",i="1.2.0";return e.isOffline()?{key:"offline",text:"".concat(t," is offline"),rejectMessage:"".concat(t," is offline. You can't browse the files on the ").concat(t," when it's offline.")}:e.isAgentMoonraker()||te()(Q()(e,"settings.agent_version","0.0.0"),n)?e.isAgentMoonraker()&&!te()(Q()(e,"settings.agent_version","0.0.0"),i)?{key:"plugin_outdated",text:"Obico plugin outdated",rejectMessage:"Please upgrade your Obico for ".concat(t," to ").concat(i," or later")}:{key:"online",text:"".concat(e.agentDisplayName()," is online")}:{key:"plugin_outdated",text:"Obico plugin outdated",rejectMessage:"Please upgrade your Obico for ".concat(t," to ").concat(n," or later")}},Nr=1e3,Mr=24,Lr={options:{name:{id:1,title:"Name",file_query:"filename",folder_query:"name"},size:{id:2,title:"Size",file_query:"num_bytes"},created_at:{id:3,title:"Created",file_query:"created_at",folder_query:"created_at"}},directions:{asc:{id:1,title:"Ascending",query:"asc"},desc:{id:2,title:"Descending",query:"desc"}}},Br={sorting:"gcode-folders-sorting-id",sortingDirection:"gcode-folders-sorting-direction-id"},$r=function(e){return Object.values(Lr.options).find((function(t){return t.id===e}))},Ur=function(e){return Object.values(Lr.directions).find((function(t){return t.id===e}))},zr={name:"GCodeFoldersPage",components:{Layout:Ct,SearchInput:pr,vueDropzone:kn.a,MugenScroll:Dt.a,RenameModal:Sr,DeleteConfirmationModal:Ir,NewFolderModal:br},props:{isPopup:{type:Boolean,default:!1},onClose:{type:Function,required:!1},scrollContainerId:{type:String,default:null},targetPrinter:{type:Object,required:!1},savedPath:{type:Array,required:!1},routeParams:{type:Object,default:function(){return{printerId:null,parentFolder:null}}}},data:function(){return{csrf:null,user:null,loading:!1,parentFolder:null,path:[],files:[],folders:[],noMoreFolders:!1,noMoreFiles:!1,currentFoldersPage:1,currentFilesPage:1,sorting:Lr,activeSorting:$r(c(Br.sorting,Lr.options.created_at.id)),activeSortingDirection:Ur(c(Br.sortingDirection,Lr.directions.desc.id)),searchQuery:null,searchStateIsActive:!1,searchTimeoutId:null,activeItem:null,printers:[],selectedPrinterId:void 0,selectedPrinterComm:void 0,localFilesLoading:!1}},created:function(){var e=this;return Object(sr["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.csrf=Object(Nt["a"])(),e.user=Object(ce["f"])(),e.savedPath&&e.savedPath.length>=1?(e.parentFolder=e.savedPath.at(-1),e.path=e.savedPath.slice(0,e.savedPath.length-1)):e.parentFolder=e.getRouteParam("parentFolder")||null,e.selectedPrinterId=Number(e.getRouteParam("printerId"))||null,e.isPopup||e.$watch((function(){return e.$route.params}),(function(t,n){e.parentFolder=t.parentFolder||null,e.selectedPrinterId=Number(e.getRouteParam("printerId"))||null,e.fetchFilesAndFolders(!0)})),t.next=7,e.fetchPrinters();case 7:e.fetchFilesAndFolders(!0);case 8:case"end":return t.stop()}}),t)})))()},computed:{isCloud:function(){return!this.selectedPrinterId},isFolderEmpty:function(){return!this.searchStateIsActive&&!this.loading&&!this.files.length&&!this.folders.length},nothingFound:function(){return this.searchStateIsActive&&!this.searchTimeoutId&&!this.files.length},searchInProgress:function(){return this.searchStateIsActive&&!!this.searchTimeoutId},maxFilesize:function(){return this.user.is_pro?500:50},maxTotalFilesize:function(){return this.user.is_pro?50:1},dropzoneOptions:function(){return{withCredentials:!0,maxFilesize:this.maxFilesize,timeout:36e5,acceptedFiles:".g,.gcode,.gco",url:Y["a"].gcodeFiles(),headers:{"X-CSRFToken":this.csrf}}}},methods:{switchToCloudStorage:function(){this.parentFolder=null,this.path=[],this.selectedPrinterId=null,this.selectedPrinterComm=null,this.isPopup?this.fetchFilesAndFolders(!0):"/g_code_folders/cloud/"!==this.$route.path&&this.$router.replace("/g_code_folders/cloud/")},switchToPrinterStorage:function(e){e.storageAvailability.rejectMessage?this.$swal.Reject.fire({text:e.storageAvailability.rejectMessage}):(this.parentFolder=null,this.path=[],this.selectedPrinterId=e.id,this.selectedPrinterComm=null,this.isPopup?this.fetchFilesAndFolders(!0):Number(this.getRouteParam("printerId"))!==e.id&&this.$router.replace("/g_code_folders/local/".concat(e.id,"/")))},getRouteParam:function(e){return this.isPopup?this.routeParams[e]:this.$route.params[e]},goBack:function(){this.path.length&&(this.parentFolder=this.path.pop(),this.fetchFilesAndFolders(!0))},resetFiles:function(){this.folders=[],this.files=[],this.noMoreFolders=!1,this.noMoreFiles=!1,this.currentFoldersPage=1,this.currentFilesPage=1},fetchPrinters:function(){var e=this;return Object(sr["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,G.a.get(Y["a"].printers());case 3:n=t.sent,n=n.data,t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),console.error(t.t0);case 10:if(n){t.next=12;break}return t.abrupt("return");case 12:n=n.map((function(e){return se(e)})),n=n.map((function(e){return Object(a["a"])(Object(a["a"])({},e),{},{storageAvailability:Rr(e)})})),e.printers=e.targetPrinter?n.filter((function(t){return t.id===e.targetPrinter.id})):n;case 15:case"end":return t.stop()}}),t,null,[[0,7]])})))()},fetchLocalFiles:function(){var e=this;return Object(sr["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.selectedPrinterComm){t.next=2;break}return t.abrupt("return");case 2:e.localFilesLoading=!0,Er(e.selectedPrinterComm,{query:e.searchQuery,path:e.parentFolder?decodeURIComponent(e.parentFolder):null,onRequestEnd:function(t){if(e.localFilesLoading=!1,t){var n=t.folders,i=t.files;e.folders=n,e.files=i}}});case 4:case"end":return t.stop()}}),t)})))()},fetchFilesAndFolders:function(){var e=arguments,t=this;return Object(sr["a"])(regeneratorRuntime.mark((function n(){var i,r,a,s,o,c,l,d,u,p,f;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=e.length>0&&void 0!==e[0]&&e[0],!t.loading){n.next=3;break}return n.abrupt("return");case 3:if(i&&t.resetFiles(),!t.selectedPrinterId){n.next=9;break}return t.printers.find((function(e){return e.id===t.selectedPrinterId}))||t.$swal.Reject.fire({title:"Error",text:"Printer not found or unavailable"}).then((function(){t.isPopup&&t.onClose?t.onClose():window.location.assign("/g_code_folders/cloud/")})),t.localFilesLoading=!0,t.selectedPrinterComm?t.fetchLocalFiles():(t.selectedPrinterComm=$n(t.selectedPrinterId,Y["a"].printerWebSocket(t.selectedPrinterId),(function(e){}),(function(e){})),t.selectedPrinterComm.connect(t.fetchLocalFiles)),n.abrupt("return");case 9:if(t.searchQuery&&(t.noMoreFolders=!0),!t.noMoreFolders||!t.noMoreFiles){n.next=12;break}return n.abrupt("return");case 12:if(t.loading=!0,r=[],a=[],t.noMoreFolders){n.next=32;break}return n.prev=16,n.next=19,G.a.get(Y["a"].gcodeFolders(),{params:{parent_folder:t.parentFolder||"null",page:t.currentFoldersPage,page_size:Mr,sorting:"".concat(t.activeSorting.folder_query,"_").concat(t.activeSortingDirection.query)}});case 19:l=n.sent,l=l.data,t.noMoreFolders=null===(null===(o=l)||void 0===o?void 0:o.next),r=(null===(c=l)||void 0===c?void 0:c.results)||[],n.next=30;break;case 25:n.prev=25,n.t0=n["catch"](16),t.loading=!1,t.$swal.Reject.fire({title:"Error",text:n.t0.message}),console.error(n.t0);case 30:(s=t.folders).push.apply(s,Object(R["a"])(r.map((function(e){return ae(e)})))),t.currentFoldersPage+=1;case 32:if(t.noMoreFiles||!(r.length<Mr)){n.next=49;break}return n.prev=33,n.next=36,G.a.get(Y["a"].gcodeFiles(),{headers:{"Cache-Control":"no-cache"},params:{parent_folder:t.parentFolder||"null",page:t.currentFilesPage,page_size:Mr,sorting:"".concat(t.activeSorting.file_query,"_").concat(t.activeSortingDirection.query),q:t.searchQuery}});case 36:f=n.sent,f=f.data,t.noMoreFiles=null===(null===(u=f)||void 0===u?void 0:u.next),a=(null===(p=f)||void 0===p?void 0:p.results)||[],n.next=47;break;case 42:n.prev=42,n.t1=n["catch"](33),t.loading=!1,t.$swal.Reject.fire({title:"Error",text:n.t1.message}),console.error(n.t1);case 47:(d=t.files).push.apply(d,Object(R["a"])(a.map((function(e){return re(e)})))),t.currentFilesPage+=1;case 49:t.loading=!1;case 50:case"end":return n.stop()}}),n,null,[[16,25],[33,42]])})))()},updateSearch:function(e){var t=this;if(clearTimeout(this.searchTimeoutId),this.searchTimeoutId=null,this.searchStateIsActive=!!e,!this.searchStateIsActive)return this.searchQuery=null,void this.fetchFilesAndFolders(!0);this.searchTimeoutId=setTimeout(Object(sr["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.searchQuery=e,t.fetchFilesAndFolders(!0),t.searchTimeoutId=null;case 3:case"end":return n.stop()}}),n)}))),Nr)},updateSorting:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeSortingDirection,n=!1;this.activeSorting.id!==e.id&&(this.activeSorting=e,l(Br.sorting,e.id),n=!0),this.activeSortingDirection.id!==t.id&&(this.activeSortingDirection=t,l(Br.sortingDirection,t.id),n=!0),n&&this.fetchFilesAndFolders(!0)},addParentFolderParam:function(e,t,n){n.append("filename",e.name),null!==this.parentFolder&&n.append("parent_folder",this.parentFolder)},gcodeUploadSuccess:function(){this.$refs.gcodesDropzone.removeAllFiles(),this.files=[],this.fetchFilesAndFolders(!0)},gcodeUploadError:function(e,t){this.$swal.Reject.fire({html:'<p class="text-center">'.concat(t,"</p>")})},renameItem:function(e){this.activeItem=e,this.$refs.renameModal.show()},verifyItemRename:function(e){return!(!this.activeItem.filename&&this.folders.find((function(t){return t.name===e})))||"Folder with this name already exists"},onItemRenamed:function(e){if(this.activeItem){var t=this.activeItem.filename?this.files:this.folders;for(var n in t)if(t[n].id===this.activeItem.id){if(this.activeItem.filename){this.files[n].filename=e;break}this.folders[n].name=e;break}this.activeItem=null}},deleteItem:function(e){this.activeItem=e,this.$refs.deleteConfirmationModal.show()},onItemDeleted:function(){if(this.activeItem){var e=this.activeItem.filename?this.files:this.folders;for(var t in e)if(e[t].id===this.activeItem.id){if(this.activeItem.filename){this.files.splice(t,1);break}this.folders.splice(t,1);break}this.activeItem=null}},createFolder:function(){this.$refs.newFolderModal.show()},verifyNewFolder:function(e){return!this.folders.find((function(t){return t.name===e}))||"Folder with this name already exists"},onFolderCreated:function(e){this.fetchFilesAndFolders(!0)},openFolder:function(e,t){Object(Nt["f"])(e,"dropdown-item")||(this.isPopup?(this.path.push(this.parentFolder),this.parentFolder=t.id,this.fetchFilesAndFolders(!0)):this.selectedPrinterId?this.$router.push("/g_code_folders/local/".concat(this.selectedPrinterId,"/").concat(encodeURIComponent(t.path),"/")):this.$router.push("/g_code_folders/cloud/".concat(t.id,"/")))},openFile:function(e,t){Object(Nt["f"])(e,"dropdown-item")||(this.isPopup?this.$emit("openFile",this.selectedPrinterId?encodeURIComponent(t.path):t.id,this.selectedPrinterId,[].concat(Object(R["a"])(this.path),[this.parentFolder])):this.selectedPrinterId?window.location.assign("/g_code_files/local/".concat(this.selectedPrinterId,"/").concat(encodeURIComponent(t.path),"/")):window.location.assign("/g_code_files/cloud/".concat(t.id,"/")))},onPrintClicked:function(e,t){var n=this;Ar({printerId:this.targetPrinter.id,gcode:t,isCloud:this.isCloud,Swal:this.$swal,onCommandSent:function(){n.isPopup&&n.$bvModal.hide("b-modal-gcodes")}})}}},Vr=zr,Wr=(n("9fd0"),Object(Ce["a"])(Vr,rr,ar,!1,null,"affe7756",null)),qr=Wr.exports,Gr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("layout",{attrs:{isPopup:e.isPopup},scopedSlots:e._u([{key:"topBarLeft",fn:function(){return[e.isPopup?n("a",{staticClass:"btn shadow-none icon-btn d-inline",attrs:{href:"#",title:"Go Back"},on:{click:function(t){return t.preventDefault(),e.goBack(t)}}},[n("i",{staticClass:"fas fa-chevron-left"})]):e._e()]},proxy:!0},{key:"topBarRight",fn:function(){return[n("div",[e.isCloud?n("b-dropdown",{attrs:{right:"","no-caret":"","toggle-class":"icon-btn"},scopedSlots:e._u([{key:"button-content",fn:function(){return[n("i",{staticClass:"fas fa-ellipsis-v"})]},proxy:!0}],null,!1,3452768261)},[n("b-dropdown-item",{on:{click:e.renameFile}},[n("i",{staticClass:"fas fa-edit"}),e._v("Rename ")]),n("b-dropdown-item",{on:{click:e.deleteFile}},[n("span",{staticClass:"text-danger"},[n("i",{staticClass:"fas fa-trash-alt"}),e._v("Delete ")])])],1):e._e(),e.onClose?n("a",{staticClass:"btn shadow-none icon-btn d-inline",attrs:{href:"#",title:"Close"},on:{click:function(t){return t.preventDefault(),e.onClose(t)}}},[n("i",{staticClass:"fas fa-times text-danger"})]):e._e()],1)]},proxy:!0},{key:"content",fn:function(){return[e.loading||e.gcodeNotFound?n("b-container",[n("b-row",[n("b-col",{staticClass:"text-center mt-5"},[e.gcodeNotFound?n("div",[n("p",[e._v("This G-Code file doesn't exists")])]):n("div",[n("b-spinner")],1)])],1)],1):n("b-container",[n("b-row",[n("b-col",{attrs:{lg:e.isPopup?12:8}},[n("div",{staticClass:"card-container"},[n("b-container",{attrs:{fluid:""}},[n("b-row",[n("b-col",[n("h1",{staticClass:"file-name truncate-overflow-text"},[e._v(e._s(e.gcode.filename))])])],1),n("b-row",[n("b-col",{attrs:{sm:e.isCloud?6:12}},[n("div",{staticClass:"file-info-line"},[n("div",[n("i",{staticClass:"fas fa-history"}),e._v("Uploaded")]),n("div",{staticClass:"value"},[e._v(e._s(e.gcode.created_at.fromNow()))])]),n("div",{staticClass:"file-info-line"},[n("div",[n("i",{staticClass:"far fa-file-code"}),e._v("File size")]),n("div",{staticClass:"value"},[e._v(e._s(e.gcode.filesize))])])]),n("b-col",{directives:[{name:"show",rawName:"v-show",value:e.isCloud,expression:"isCloud"}],attrs:{sm:"6"}},[n("div",{staticClass:"file-info-line"},[n("div",[n("i",{staticClass:"fas fa-circle"}),e._v("Times printed")]),n("div",{staticClass:"value"},[e._v(e._s(e.gcode.totalPrints))])]),n("div",{staticClass:"file-info-line"},[n("div",[n("i",{staticClass:"fas fa-circle text-success"}),e._v("Succeeded")]),n("div",{staticClass:"value"},[e._v(e._s(e.gcode.successPrints)+"/"+e._s(e.gcode.totalPrints))])]),n("div",{staticClass:"file-info-line"},[n("div",[n("i",{staticClass:"fas fa-circle text-danger"}),e._v("Failed or cancelled")]),n("div",{staticClass:"value"},[e._v(e._s(e.gcode.failedPrints)+"/"+e._s(e.gcode.totalPrints))])])])],1)],1)],1),n("available-printers",{staticClass:"card-container mt-4",class:[e.isPopup?"d-lg-block":"d-lg-none"],attrs:{isPopup:e.isPopup,targetPrinterId:e.targetPrinterId||e.selectedPrinterId,gcode:e.gcode,isCloud:e.isCloud},on:{refresh:e.onRefresh}}),e.isCloud?n("div",{staticClass:"mt-5"},[n("h2",{staticClass:"section-title"},[e._v("Print history")]),e._l(e.gcode.print_set,(function(t){return n("div",{key:"print_"+t.id,staticClass:"print-history-card"},[n("div",{staticClass:"print-info"},[t.finished_at?n("div",{staticClass:"result text-success font-weight-bold"},[e._v("Succeeded")]):t.cancelled_at?n("div",{staticClass:"result text-danger font-weight-bold"},[e._v("Cancelled / Failed")]):n("div",{staticClass:"result font-weight-bold"},[e._v("Printing...")]),n("div",{staticClass:"printer truncate-overflow-text"},[e._v("Printer: "+e._s(t.printer.name))]),n("div",{staticClass:"file truncate-overflow-text"},[e._v("File: "+e._s(t.filename))]),n("div",{staticClass:"date"},[e._v(" Ended: "),t.ended_at?n("span",[e._v(e._s(t.ended_at.fromNow()))]):n("span",[e._v("-")])])]),t.poster_url?n("div",{staticClass:"poster"},[n("div",{staticClass:"img",style:{backgroundImage:"url("+t.poster_url+")"}})]):e._e()])})),e.gcode.print_set.length?e._e():n("div",[n("div",{staticClass:"print-history-card p-4 justify-content-center text-secondary"},[e._v(" This file doesn't have any prints yet ")])])],2):e._e()],1),n("b-col",{attrs:{lg:e.isPopup?12:4}},[n("available-printers",{staticClass:"card-container d-none",class:[e.isPopup?"d-lg-none":"d-lg-block"],attrs:{isPopup:e.isPopup,targetPrinterId:e.targetPrinterId||Number(e.selectedPrinterId),gcode:e.gcode,isCloud:e.isCloud},on:{refresh:e.onRefresh}})],1)],1)],1),n("rename-modal",{ref:"renameModal",attrs:{item:e.gcode},on:{renamed:e.onItemRenamed}}),n("delete-confirmation-modal",{ref:"deleteConfirmationModal",attrs:{item:e.gcode},on:{deleted:e.onItemDeleted}})]},proxy:!0}])})},Hr=[],Jr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.printersLoading||!e.gcode?n("div",{staticClass:"my-5 text-center"},[n("b-spinner")],1):n("div",[e._l(e.printers,(function(t){return n("div",{key:"printer_"+t.id,staticClass:"printer-item",class:{active:e.selectedPrinter&&t.id===e.selectedPrinter.id},on:{click:function(n){return e.selectPrinter(t)}}},[n("div",{staticClass:"selected-indicator"}),n("div",{staticClass:"printer-name"},[e._v(e._s(t.name))]),n("div",{staticClass:"printer-status",class:{"text-success":"ready"===t.printAvailability.key,"text-warning":"unavailable"===t.printAvailability.key}},[e._v(e._s(t.printAvailability.text))])])})),e.printersLoading||e.printers.length?e._e():n("p",{staticClass:"text-center text-secondary mt-3 mb-3"},[e._v("No available printers")]),n("button",{staticClass:"btn btn-primary mt-3",attrs:{disabled:!e.selectedPrinter||e.isSending},on:{click:e.onPrintClicked}},[e.isSending?n("b-spinner",{attrs:{small:""}}):n("div",[e.selectedPrinter?n("div",{staticClass:"truncate-overflow-text"},[e._v("Print on "+e._s(e.selectedPrinter.name))]):n("div",{staticClass:"truncate-overflow-text"},[e._v("Print")])])],1)],2)])},Yr=[],Kr=(n("b6802"),3e3),Qr={name:"AvailablePrinters",components:{Layout:Ct,RenameModal:Sr,DeleteConfirmationModal:Ir},props:{isPopup:{type:Boolean,default:!1},targetPrinterId:{type:Number,required:!1},gcode:{type:Object,default:null},isCloud:{type:Boolean,default:!0}},data:function(){return{printers:[],selectedPrinter:null,printersLoading:!0,isSending:!1}},created:function(){this.fetchPrinters()},methods:{fetchPrinters:function(){var e=this;return Object(sr["a"])(regeneratorRuntime.mark((function t(){var n,i,r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.printersLoading=!0,t.prev=1,t.next=4,G.a.get(Y["a"].printers());case 4:r=t.sent,t.next=11;break;case 7:t.prev=7,t.t0=t["catch"](1),e.printersLoading=!1,console.error(t.t0);case 11:if(null===(n=r)||void 0===n?void 0:n.data){t.next=14;break}return e.printersLoading=!1,t.abrupt("return");case 14:r=null===(i=r)||void 0===i?void 0:i.data,r=r.map((function(e){return se(e)})),r=r.map((function(e){return Object(a["a"])(Object(a["a"])({},e),{},{printAvailability:jr(e)})})),e.targetPrinterId?(s=r.find((function(t){return t.id===e.targetPrinterId})),e.printers=[s],"ready"===s.printAvailability.key&&(e.selectedPrinter=s)):(e.printers=r,e.selectedPrinter=r.filter((function(e){return"ready"===e.printAvailability.key}))[0]),e.printersLoading=!1;case 19:case"end":return t.stop()}}),t,null,[[1,7]])})))()},selectPrinter:function(e){"ready"===e.printAvailability.key?this.selectedPrinter=e:this.$swal.Reject.fire({title:"".concat(e.name," isn't ready for print for one of the following reasons:"),html:'<ul style="text-align: left">\n            <li>'.concat(e.agentDisplayName()," is powered off or not connected to the Internet</li>\n            <li>Printer is not connected to ").concat(e.agentDisplayName(),"</li>\n            <li>Printer is currently busy</li>\n          </ul>")})},onPrintClicked:function(){var e,t=this;(null===(e=this.selectedPrinter)||void 0===e?void 0:e.id)&&(this.isSending=!0,Ar({printerId:this.selectedPrinter.id,gcode:this.gcode,isCloud:this.isCloud,Swal:this.$swal,onCommandSent:function(){t.isPopup&&t.$bvModal.hide("b-modal-gcodes")},onPrinterStatusChanged:function(){t.isPopup||t.showRedirectModal(),t.isSending=!1,t.fetchPrinters()}}))},showRedirectModal:function(){var e,t=this;this.$swal.Prompt.fire({html:'\n          <div class="text-center">\n            <h5 class="py-3">\n              You\'ll be redirected to printers page in <strong>'.concat(Math.round(Kr/1e3),"</strong> seconds\n            </h5>\n          </div>\n        "),timer:Kr,showConfirmButton:!0,showCancelButton:!0,confirmButtonText:"Go now",onOpen:function(){var n=t.$swal.getHtmlContainer();n.querySelector.bind(n);e=setInterval((function(){t.$swal.getHtmlContainer().querySelector("strong").textContent=(t.$swal.getTimerLeft()/1e3).toFixed(0)}),1e3)},onClose:function(){clearInterval(e),e=null}}).then((function(e){e.isConfirmed||"timer"===e.dismiss?window.location.assign("/printers/"):t.$emit("refresh")}))}}},Zr=Qr,Xr=(n("fb23"),Object(Ce["a"])(Zr,Jr,Yr,!1,null,"ccb2488c",null)),ea=Xr.exports,ta={name:"GCodeDetailsPage",components:{Layout:Ct,RenameModal:Sr,DeleteConfirmationModal:Ir,availablePrinters:ea},props:{isPopup:{type:Boolean,default:!1},targetPrinterId:{type:Number,required:!1},onClose:{type:Function,required:!1},routeParams:{type:Object,default:function(){return{fileId:null,printerId:null}}}},data:function(){return{gcode:null,loading:!0,gcodeNotFound:!1}},created:function(){this.selectedPrinterId=Number(this.getRouteParam("printerId"))||null,this.gcodeId=this.getRouteParam("fileId"),this.fetchGcode()},computed:{isCloud:function(){return!Boolean(this.selectedPrinterId)}},methods:{getRouteParam:function(e){return this.isPopup?this.routeParams[e]:this.$route.params[e]},goBack:function(){this.$emit("goBack")},fetchLocalFile:function(){var e=this;return Object(sr["a"])(regeneratorRuntime.mark((function t(){var n,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.printerComm){t.next=2;break}return t.abrupt("return");case 2:e.loading=!0,n=decodeURIComponent(e.gcodeId),i=n.split("/").at(-1),r=i===n?"":n.slice(0,n.length-i.length-1),Er(e.printerComm,{query:i,path:r,onRequestEnd:function(t){var i;if(e.loading=!1,null===t||void 0===t||null===(i=t.files)||void 0===i?void 0:i.length){var r=t.files.filter((function(e){return e.path===n}))[0];if(!r)return void(e.gcodeNotFound=!0);e.gcode=Object(a["a"])(Object(a["a"])({},r),{},{print_set:[]})}else e.gcodeNotFound=!0}});case 7:case"end":return t.stop()}}),t)})))()},fetchGcode:function(){var e=this;return Object(sr["a"])(regeneratorRuntime.mark((function t(){var n,i,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.selectedPrinterId){t.next=4;break}return e.printerComm=$n(e.selectedPrinterId,Y["a"].printerWebSocket(e.selectedPrinterId),(function(e){}),(function(e){})),e.printerComm.connect(e.fetchLocalFile),t.abrupt("return");case 4:return e.loading=!0,r=e.getRouteParam("fileId"),t.prev=6,t.next=9,G.a.get(Y["a"].gcodeFile(r));case 9:a=t.sent,t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](6),e.loading=!1,console.error(t.t0);case 16:if(null===(n=a)||void 0===n?void 0:n.data){t.next=20;break}return e.loading=!1,e.gcodeNotFound=!0,t.abrupt("return");case 20:a=null===(i=a)||void 0===i?void 0:i.data,e.gcode=re(a),e.loading=!1;case 23:case"end":return t.stop()}}),t,null,[[6,12]])})))()},renameFile:function(){this.$refs.renameModal.show()},onItemRenamed:function(e){this.gcode.filename=e},deleteFile:function(){this.$refs.deleteConfirmationModal.show()},onItemDeleted:function(){this.isPopup?this.$emit("goBack"):window.location.replace("/g_code_folders/cloud/")},onRefresh:function(){this.$router.go()}}},na=ta,ia=(n("f12f"),Object(Ce["a"])(na,Gr,Hr,!1,null,"d34d0cb6",null)),ra=ia.exports,aa={asc:"fas fa-long-arrow-alt-up",desc:"fas fa-long-arrow-alt-down"},sa={StateFilter:"printer-filtering",SortFilter:"printer-sorting"},oa={name:"PrinterListPage",components:{PrinterCard:ir,Layout:Ct,CascadedDropdown:on,GCodeFoldersPage:qr,GCodeFilePage:ra},created:function(){var e=Object(ce["e"])(),t=e.IS_ENT;this.isEnt=!!t,this.user=Object(ce["f"])(),this.fetchPrinters()},data:function(){return{user:null,printers:[],loading:!0,isEnt:!1,menuSelections:{"Sort By":c(sa.SortFilter,"by-date-desc"),"Filter By":c(sa.StateFilter,"all")},menuOptions:{"Sort By":{iconClass:"fas fa-sort-amount-up",options:[{value:"by-date-asc",title:"Sort By Date",iconClass:aa["asc"]},{value:"by-date-desc",title:"Sort By Date",iconClass:aa["desc"]},{value:"by-name-asc",title:"Sort By Name",iconClass:aa["asc"]},{value:"by-name-desc",title:"Sort By Name",iconClass:aa["desc"]}]},"Filter By":{iconClass:"fas fa-filter",options:[{value:"all",title:"All Printers"},{value:"online",title:"Online Printers"},{value:"active",title:"Active Printers"}]}},dontShowFilterWarning:!1,archivedPrinterNum:0,selectedGcodeId:null,selectedPrinterId:null,targetPrinter:null,savedPath:[null]}},computed:{dhBadgeNum:function(){return this.user&&this.user.is_dh_unlimited?"∞":Math.round(this.user.dh_balance)},visiblePrinters:function(){var e=this.printers;switch(this.menuSelections["Filter By"]){case"online":e=e.filter((function(e){return!e.isDisconnected()}));break;case"active":e=e.filter((function(e){return e.isActive()}));break;case"all":break}switch(this.menuSelections["Sort By"]){case"by-date-asc":e=Re()(e,(function(e){return e.createdAt()}));break;case"by-date-desc":e=An()(Re()(e,(function(e){return e.createdAt()})));break;case"by-name-asc":e=Re()(e,(function(e){return e.name}));break;case"by-name-desc":e=An()(Re()(e,(function(e){return e.name})));break}return e},hiddenPrinterCount:function(){return this.printers.length-this.visiblePrinters.length},shouldShowFilterWarning:function(){return"all"!==this.menuSelections["Filter By"]},shouldShowArchiveWarning:function(){return this.archivedPrinterNum>0},activeFiltering:function(){var e=this,t=this.menuOptions["Filter By"].options.filter((function(t){return t.value===e.menuSelections["Filter By"]}));return t.length?t[0].title:null}},methods:{menuSelectionChanged:function(e,t){var n=t.value;this.$set(this.menuSelections,e,n);var i="Sort By"===e?sa.SortFilter:sa.StateFilter;l(i,n)},fetchPrinters:function(){var e=this;return this.loading=!0,G.a.get(Y["a"].printers(),{params:{with_archived:!0}}).then((function(t){e.loading=!1,t.data.forEach((function(t){t.archived_at?e.archivedPrinterNum+=1:e.insertPrinter(se(t))}))}))},onShowAllClicked:function(){this.$set(this.menuSelections,"Filter By","all"),l(sa.StateFilter,"all")},insertPrinter:function(e){this.printers.push(e)},onPrinterUpdated:function(e){var t=this.printers.findIndex((function(t){return t.id==e.id}));t<0||this.$set(this.printers,t,e)},scrollToTop:function(){document.querySelector("#b-modal-gcodes").scrollTo(0,0)},resetGcodesModal:function(){this.selectedGcodeId=null,this.targetPrinter=null}}},ca=oa,la=(n("a12a"),n("e39f"),Object(Ce["a"])(ca,On,Dn,!1,null,"776b4002",null)),da=la.exports,ua=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("navbar",{attrs:{"view-name":"printer_shared"}}),n("div",{staticClass:"row justify-content-center"},[e.loading?n("b-spinner",{staticClass:"mt-5",attrs:{label:"Loading..."}}):e._e(),e.printer?n("div",{staticClass:"col-sm-12 col-lg-6 printer-card"},[n("div",{staticClass:"card"},[n("div",{staticClass:"card-header"},[n("div",[e._v(e._s(e.printer.name))])]),n("streaming-box",{attrs:{printer:e.printer,webrtc:e.webrtc,autoplay:!0}}),n("div",{staticClass:"p-3 p-md-5"},[n("p",{staticClass:"text-center"},[e._v("You are viewing an awesome 3D print your friend shared specifically with you on")]),n("a",{attrs:{href:"https://www.obico.io/"}},[n("svg",{staticClass:"logo-img",attrs:{width:"100%"}},[n("use",{attrs:{href:"#svg-logo-full"}})])]),n("hr"),n("br"),n("br"),n("p",{staticClass:"text-center"},[e._v("Obico let you monitor and control your printer from anywhere, on your phone.")]),n("a",{staticClass:"btn btn-block btn-primary",attrs:{href:"/accounts/signup/"}},[e._v("Sign up for a free Obico account")])])],1)]):e._e()],1)],1)},pa=[],fa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.inMobileWebView?e._e():n("b-navbar",{class:{"navbar-dark":e.theme===e.themes.Dark,"navbar-light":e.theme===e.themes.Light},attrs:{toggleable:"xl"}},[n("b-container",{staticClass:"p-0"},[n("b-navbar-brand",{attrs:{href:"/"}},[n("svg",{attrs:{width:"100",height:"40"}},[n("use",{attrs:{href:"#svg-logo-full"}})])]),n("b-navbar-toggle",{attrs:{target:"navbar-toggle-collapse"}},[[n("span",{staticClass:"navbar-toggler-icon"})]],2),n("b-collapse",{attrs:{id:"navbar-toggle-collapse","is-nav":""},model:{value:e.showMainMenu,callback:function(t){e.showMainMenu=t},expression:"showMainMenu"}},[n("b-navbar-nav",[e.user?n("b-nav-item",{class:{active:e.viewName.includes("printers")},attrs:{href:"/printers/"}},[e._v("Printer")]):e._e(),e.user?n("b-nav-item",{class:{active:e.viewName.includes("prints")},attrs:{href:"/prints/"}},[e._v("Time-lapse")]):e._e(),e.user?n("b-nav-item",{class:{active:e.viewName.includes("g_code_folders")},attrs:{href:"/g_code_folders/cloud/"}},[e._v("G-Code")]):e._e(),e.isEnt&&!e.user?n("b-nav-item",{staticClass:"glowing",class:{active:"publictimelapse_list"===e.viewName},attrs:{href:"/ent_pub/publictimelapses/"}},[e._v("Spaghetti Gallery")]):e._e(),e.isEnt?n("b-nav-item",{class:{active:"pricing"===e.viewName},attrs:{href:"/ent_pub/pricing/"}},[e._v("Pricing")]):e._e(),n("b-nav-item",{attrs:{href:"https://www.obico.io/help/"}},[e._v("Help")]),n("b-nav-item",{attrs:{href:"https://obico.io/discord"}},[e._v("Community")])],1),n("b-navbar-nav",{staticClass:"ml-auto"},[e.user?e._e():n("b-nav-item",{attrs:{href:"/accounts/login/"}},[e._v("SIGN IN")]),!e.user&&e.allowSignUp?n("b-nav-item",{attrs:{href:"/accounts/signup/"}},[e._v("SIGN UP")]):e._e(),e.user?n("b-nav-item-dropdown",{ref:"accountDropdown",attrs:{right:"","toggle-class":"user-menu",text:e.user.first_name||e.user.email}},[n("b-dropdown-item",{attrs:{href:"/user_preferences/"}},[n("i",{staticClass:"fas fa-cog mr-2"}),e._v("Preferences ")]),n("b-dropdown-divider"),n("b-dropdown-item",{attrs:{href:"/accounts/logout/"}},[n("i",{staticClass:"fas fa-sign-out-alt mr-2"}),e._v("Log out ")])],1):e._e()],1)],1)],1)],1)],1)},ha=[],ma={name:"Navbar",components:{},data:function(){return{user:null,allowSignUp:!1,isEnt:!1,themes:$t["a"],showMainMenu:!1}},props:{viewName:{default:function(){return""},type:String}},created:function(){var e=Object(ce["e"])(),t=e.ACCOUNT_ALLOW_SIGN_UP,n=e.IS_ENT;this.allowSignUp=!!t,this.isEnt=!!n,this.user=Object(ce["f"])()},computed:{inMobileWebView:function(){return Object(ce["a"])()},theme:function(){return Object(D["a"])()}},methods:{hideDropdowns:function(){this.showMainMenu=!1;var e=this.$refs.accountDropdown;e&&e.hide()}}},va=ma,ga=(n("75c7"),Object(Ce["a"])(va,fa,ha,!1,null,"23bd4875",null)),ba=ga.exports,_a={name:"SharedPrinterPage",components:{StreamingBox:oi,Navbar:ba},created:function(){var e=this;this.shareToken=Te()(window.location.pathname,"/").slice(-2,-1).pop(),this.printerComm=$n(this.shareToken,Y["a"].printerSharedWebSocket(this.shareToken),(function(t){e.printer=se(t,e.printer),e.loading=!1})),this.printerComm.connect(),this.webrtc.openForShareToken(this.shareToken)},data:function(){return{printer:null,shareToken:null,videoAvailable:{},loading:!0,webrtc:Qn()}}},wa=_a,Ca=(n("c11f"),Object(Ce["a"])(wa,ua,pa,!1,null,"0554ad52",null)),ya=Ca.exports,ka=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("layout",{scopedSlots:e._u([{key:"content",fn:function(){return[n("b-container",[n("b-row",{staticClass:"justify-content-center"},[n("b-col",{attrs:{lg:"8"}},[e.printer?n("div",{staticClass:"surface with-loading-animation full-on-mobile"},[n("section",{staticClass:"settings"},[n("h2",{staticClass:"section-title"},[e._v("Settings")]),n("div",{staticClass:"form-group mb-4 mt-4"},[n("div",{staticClass:"form-label text-muted mb-2"},[e._v("Give your shiny new printer a name")]),n("saving-animation",{attrs:{errors:e.errorMessages.name,saving:e.saving.name}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.printer.name,expression:"printer.name"}],staticClass:"form-control field_required",attrs:{id:"id_name",type:"text",name:"name",maxlength:"200",placeholder:"",required:"required"},domProps:{value:e.printer.name},on:{input:function(t){t.target.composing||e.$set(e.printer,"name",t.target.value)}}})])],1),n("div",{staticClass:"failure-notification"},[n("div",{staticClass:"form-group mt-4 mb-4"},[n("div",{staticClass:"form-label text-muted"},[e._v("When a potential failure is detected:")]),n("saving-animation",{attrs:{errors:e.errorMessages.action_on_failure_NONE,saving:e.saving.action_on_failure_NONE}},[n("div",{staticClass:"custom-control custom-radio mt-1 radio"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.printer.action_on_failure,expression:"printer.action_on_failure"}],staticClass:"custom-control-input field_required",attrs:{type:"radio",name:"action_on_failure",id:"id_action_on_failure_0",value:"NONE"},domProps:{checked:e._q(e.printer.action_on_failure,"NONE")},on:{change:[function(t){return e.$set(e.printer,"action_on_failure","NONE")},function(t){return e.updateSetting("action_on_failure")}]}}),n("label",{staticClass:"custom-control-label",attrs:{for:"id_action_on_failure_0"}},[e._v("Just notify me")])])]),n("saving-animation",{attrs:{errors:e.errorMessages.action_on_failure_PAUSE,saving:e.saving.action_on_failure_PAUSE}},[n("div",{staticClass:"custom-control custom-radio mt-1 radio",attrs:{id:"action_on_failure_PAUSE"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.printer.action_on_failure,expression:"printer.action_on_failure"}],staticClass:"custom-control-input field_required",attrs:{type:"radio",name:"action_on_failure",id:"id_action_on_failure_1",value:"PAUSE"},domProps:{checked:e._q(e.printer.action_on_failure,"PAUSE")},on:{change:[function(t){return e.$set(e.printer,"action_on_failure","PAUSE")},function(t){return e.updateSetting("action_on_failure")}]}}),n("label",{staticClass:"custom-control-label",attrs:{for:"id_action_on_failure_1"}},[e._v("Pause the printer and notify me")])])])],1)])]),n("section",{staticClass:"mt-5"},[n("h2",{staticClass:"section-title"},[e._v("Failure Detection")]),n("div",{staticClass:"card-body p-0 pt-3"},[n("p",{staticClass:"text-warning"},[n("i",{staticClass:"fas fa-exclamation-triangle"}),e._v(" If you are not sure about the settings below, leave the default values to minimize surprises. ")]),n("div",{staticClass:"form-group mt-4"},[n("div",{staticClass:"form-label text-muted"},[e._v("When print is paused,")]),n("saving-animation",{attrs:{errors:e.errorMessages.tools_off_on_pause,saving:e.saving.tools_off_on_pause}},[n("div",{staticClass:"custom-control custom-checkbox mt-2 checkbox"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.printer.tools_off_on_pause,expression:"printer.tools_off_on_pause"}],staticClass:"custom-control-input",attrs:{type:"checkbox",name:"tools_off_on_pause",id:"id_tools_off_on_pause"},domProps:{checked:Array.isArray(e.printer.tools_off_on_pause)?e._i(e.printer.tools_off_on_pause,null)>-1:e.printer.tools_off_on_pause},on:{change:[function(t){var n=e.printer.tools_off_on_pause,i=t.target,r=!!i.checked;if(Array.isArray(n)){var a=null,s=e._i(n,a);i.checked?s<0&&e.$set(e.printer,"tools_off_on_pause",n.concat([a])):s>-1&&e.$set(e.printer,"tools_off_on_pause",n.slice(0,s).concat(n.slice(s+1)))}else e.$set(e.printer,"tools_off_on_pause",r)},function(t){return e.updateSetting("tools_off_on_pause")}]}}),n("label",{staticClass:"custom-control-label",attrs:{for:"id_tools_off_on_pause"}},[e._v(" Turn off hotend heater(s) ")])])]),n("saving-animation",{attrs:{errors:e.errorMessages.bed_off_on_pause,saving:e.saving.bed_off_on_pause}},[n("div",{staticClass:"custom-control custom-checkbox mt-2 checkbox"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.printer.bed_off_on_pause,expression:"printer.bed_off_on_pause"}],staticClass:"custom-control-input",attrs:{type:"checkbox",name:"bed_off_on_pause",id:"id_bed_off_on_pause"},domProps:{checked:Array.isArray(e.printer.bed_off_on_pause)?e._i(e.printer.bed_off_on_pause,null)>-1:e.printer.bed_off_on_pause},on:{change:[function(t){var n=e.printer.bed_off_on_pause,i=t.target,r=!!i.checked;if(Array.isArray(n)){var a=null,s=e._i(n,a);i.checked?s<0&&e.$set(e.printer,"bed_off_on_pause",n.concat([a])):s>-1&&e.$set(e.printer,"bed_off_on_pause",n.slice(0,s).concat(n.slice(s+1)))}else e.$set(e.printer,"bed_off_on_pause",r)},function(t){return e.updateSetting("bed_off_on_pause")}]}}),n("label",{staticClass:"custom-control-label",attrs:{for:"id_bed_off_on_pause"}},[e._v(" Turn off bed heater ")])])]),n("saving-animation",{staticClass:"mobile-full-width",attrs:{errors:e.errorMessages.retract_on_pause,saving:e.saving.retract_on_pause}},[n("div",{staticClass:"form-inline my-1 checkbox-with-input"},[n("div",{staticClass:"custom-control custom-checkbox"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.retractFilamentByEnabled,expression:"retractFilamentByEnabled"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"retract-checkbox"},domProps:{checked:Array.isArray(e.retractFilamentByEnabled)?e._i(e.retractFilamentByEnabled,null)>-1:e.retractFilamentByEnabled},on:{change:function(t){var n=e.retractFilamentByEnabled,i=t.target,r=!!i.checked;if(Array.isArray(n)){var a=null,s=e._i(n,a);i.checked?s<0&&(e.retractFilamentByEnabled=n.concat([a])):s>-1&&(e.retractFilamentByEnabled=n.slice(0,s).concat(n.slice(s+1)))}else e.retractFilamentByEnabled=r}}}),n("label",{staticClass:"custom-control-label",attrs:{for:"retract-checkbox"}},[e._v("Retract filament by")])]),n("number-input",{staticClass:"wrappable-field",attrs:{step:.5,disable:!e.retractFilamentByEnabled},model:{value:e.retractOnPause,callback:function(t){e.retractOnPause=t},expression:"retractOnPause"}})],1)]),n("saving-animation",{staticClass:"mobile-full-width",attrs:{errors:e.errorMessages.lift_z_on_pause,saving:e.saving.lift_z_on_pause}},[n("div",{staticClass:"form-inline my-1 checkbox-with-input"},[n("div",{staticClass:"custom-control custom-checkbox"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.liftExtruderByEnabled,expression:"liftExtruderByEnabled"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"lift-z-checkbox"},domProps:{checked:Array.isArray(e.liftExtruderByEnabled)?e._i(e.liftExtruderByEnabled,null)>-1:e.liftExtruderByEnabled},on:{change:function(t){var n=e.liftExtruderByEnabled,i=t.target,r=!!i.checked;if(Array.isArray(n)){var a=null,s=e._i(n,a);i.checked?s<0&&(e.liftExtruderByEnabled=n.concat([a])):s>-1&&(e.liftExtruderByEnabled=n.slice(0,s).concat(n.slice(s+1)))}else e.liftExtruderByEnabled=r}}}),n("label",{staticClass:"custom-control-label",attrs:{for:"lift-z-checkbox"}},[e._v("Lift extruder along Z axis by")])]),n("number-input",{staticClass:"wrappable-field",attrs:{step:.5,disable:!e.liftExtruderByEnabled},model:{value:e.liftExtruderBy,callback:function(t){e.liftExtruderBy=t},expression:"liftExtruderBy"}})],1)])],1),n("div",{staticClass:"form-group sensitivity my-4"},[n("div",{staticClass:"form-label text-muted"},[e._v("AI failure detection sensitivity")]),n("saving-animation",{attrs:{errors:e.errorMessages.detective_sensitivity,saving:e.saving.detective_sensitivity}},[n("div",{staticClass:"my-2 sensitivity-slider"},[n("vue-slider",{attrs:{lazy:!0,min:.8,max:1.2,interval:.05,tooltipFormatter:e.sensitivityTooltipFormatter},model:{value:e.detectiveSensitivity,callback:function(t){e.detectiveSensitivity=t},expression:"detectiveSensitivity"}})],1)]),"Low"===e.sensitivityTooltipFormatter(e.printer.detective_sensitivity)?n("div",[e._v(" Low - I don't want a lot of false alarms. Only alert me when you are absolutely sure. ")]):"Medium"===e.sensitivityTooltipFormatter(e.printer.detective_sensitivity)?n("div",[e._v(" Medium - A few false alarms won't bother me. But some well-disguised spaghetti will be missed. ")]):n("div",[e._v(" High - Hit me with all the false alarms. I want to catch as many failures as possible. ")])],1)])]),n("section",{staticClass:"mt-5"},[n("h2",{staticClass:"section-title"},[e._v("Time-lapse")]),e.timelapseOnFinishEnabled&&e.timelapseOnCancelEnabled?e._e():n("p",{staticClass:"text-warning"},[n("i",{staticClass:"fas fa-exclamation-triangle"}),e._v(" Focused Feedback won't be available when time-lapse recording is turned off. You won't be able to "),n("a",{attrs:{href:"https://www.obico.io/docs/user-guides/how-does-credits-work/"}},[e._v("help us get better while earning AI Detection Hours for yourself")]),e._v(". ")]),n("div",{staticClass:"form-group mt-4"},[n("saving-animation",{staticClass:"mobile-full-width",attrs:{errors:e.errorMessages.min_timelapse_secs_on_finish,saving:e.saving.min_timelapse_secs_on_finish}},[n("div",{staticClass:"form-inline my-1 checkbox-with-input"},[n("div",{staticClass:"custom-control custom-checkbox"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.timelapseOnFinishEnabled,expression:"timelapseOnFinishEnabled"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"timelapseOnFinishEnabled"},domProps:{checked:Array.isArray(e.timelapseOnFinishEnabled)?e._i(e.timelapseOnFinishEnabled,null)>-1:e.timelapseOnFinishEnabled},on:{change:function(t){var n=e.timelapseOnFinishEnabled,i=t.target,r=!!i.checked;if(Array.isArray(n)){var a=null,s=e._i(n,a);i.checked?s<0&&(e.timelapseOnFinishEnabled=n.concat([a])):s>-1&&(e.timelapseOnFinishEnabled=n.slice(0,s).concat(n.slice(s+1)))}else e.timelapseOnFinishEnabled=r}}}),n("label",{staticClass:"custom-control-label",attrs:{for:"timelapseOnFinishEnabled"}},[e._v("Record time-lapse when a print finishes successfully.")])])]),e.timelapseOnFinishEnabled?n("div",{staticClass:"form-inline my-1 checkbox-with-input"},[n("div",{staticClass:"custom-control custom-checkbox"},[e._v(" Skip if the print is finished in less than ")]),n("number-input",{staticClass:"wrappable-field",attrs:{step:5,unit:"minutes"},model:{value:e.minTimelapseMinutesOnFinish,callback:function(t){e.minTimelapseMinutesOnFinish=t},expression:"minTimelapseMinutesOnFinish"}})],1):e._e()]),n("saving-animation",{staticClass:"mobile-full-width",attrs:{errors:e.errorMessages.min_timelapse_secs_on_cancel,saving:e.saving.min_timelapse_secs_on_cancel}},[n("div",{staticClass:"form-inline mt-3 mb-1 checkbox-with-input"},[n("div",{staticClass:"custom-control custom-checkbox"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.timelapseOnCancelEnabled,expression:"timelapseOnCancelEnabled"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"timelapseOnCancelEnabled"},domProps:{checked:Array.isArray(e.timelapseOnCancelEnabled)?e._i(e.timelapseOnCancelEnabled,null)>-1:e.timelapseOnCancelEnabled},on:{change:function(t){var n=e.timelapseOnCancelEnabled,i=t.target,r=!!i.checked;if(Array.isArray(n)){var a=null,s=e._i(n,a);i.checked?s<0&&(e.timelapseOnCancelEnabled=n.concat([a])):s>-1&&(e.timelapseOnCancelEnabled=n.slice(0,s).concat(n.slice(s+1)))}else e.timelapseOnCancelEnabled=r}}}),n("label",{staticClass:"custom-control-label",attrs:{for:"timelapseOnCancelEnabled"}},[e._v("Record time-lapse when a print is cancelled.")])])]),e.timelapseOnCancelEnabled?n("div",{staticClass:"form-inline my-1 checkbox-with-input"},[n("div",{staticClass:"custom-control custom-checkbox"},[e._v(" Skip if the print is cancelled in less than ")]),n("number-input",{staticClass:"wrappable-field",attrs:{step:5,unit:"minutes"},model:{value:e.minTimelapseMinutesOnCancel,callback:function(t){e.minTimelapseMinutesOnCancel=t},expression:"minTimelapseMinutesOnCancel"}})],1):e._e()])],1)]),n("section",{staticClass:"danger mt-5"},[n("h2",{staticClass:"section-title"},[e._v("Danger Zone")]),n("div",{staticClass:"mt-4"},[n("a",{staticClass:"btn btn-outline-secondary",attrs:{href:e.printerWizardUrl}},[e._v(" Re-Link Printer ")]),n("div",{staticClass:"text-muted mt-1"},[n("small",[e._v('If your printer is always showing as "offline", and you have gone through '),n("a",{attrs:{href:"https://www.obico.io/docs/user-guides/troubleshoot-server-connection-issues/"}},[e._v("all the trouble-shooting steps")]),e._v(", you can try to re-link printer as the last resort.")])])]),n("div",{staticClass:"mt-4"},[n("button",{staticClass:"btn btn-outline-warning",on:{click:e.archivePrinter}},[e._v(" Archive Printer ")]),n("div",{staticClass:"text-muted mt-1"},[n("small",[e._v("Archived printers are not counted toward your subscription plan. You won't see them in the app either. Go to "),n("a",{attrs:{href:"/ent/printers/archived/"}},[e._v("this page")]),e._v(" to find all archived printers and/or un-archive them.")])])]),n("div",{staticClass:"mt-4"},[n("button",{staticClass:"btn btn-outline-danger",on:{click:e.deletePrinter}},[e._v(" Delete Printer ")]),n("div",{staticClass:"text-muted mt-1"},[n("small",[e._v("Bye-bye printer.")])])])])]):n("div",{staticClass:"text-center"},[n("b-spinner",{staticClass:"mt-5",attrs:{label:"Loading..."}})],1)])],1)],1)]},proxy:!0}])})},Sa=[],Pa=n("847e"),xa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"input-group input-group-sm input-wrapper"},[n("div",{staticClass:"input-group-prepend"},[n("button",{staticClass:"btn btn-outline-secondary control-button",attrs:{type:"button",disabled:e.disable},on:{click:function(t){e.inputValue=e.inputValue>0?Math.round(10*(e.inputValue-e.step))/10:0,e.$emit("input",e.inputValue)}}},[e._v("↓")])]),n("input",{staticClass:"form-control text-center field_required",style:{opacity:e.disable?.3:1},attrs:{type:"text",disabled:"","aria-describedby":"basic-addon1"},domProps:{value:e.inputValue+" "+e.unit}}),n("div",{staticClass:"input-group-append"},[n("button",{staticClass:"btn btn-outline-secondary control-button",attrs:{type:"button",disabled:e.disable},on:{click:function(t){e.inputValue=Math.round(10*(e.inputValue+e.step))/10,e.$emit("input",e.inputValue)}}},[e._v("↑")])])])},Ta=[],Oa={name:"NumberInput",props:{value:{type:Number,default:0},step:{type:Number,default:.5},disable:{type:Boolean,default:!1},unit:{type:String,default:"mm"}},data:function(){return{inputValue:this.value}},watch:{value:function(e){this.inputValue=e}}},Da=Oa,Ia=(n("9158"),Object(Ce["a"])(Da,xa,Ta,!1,null,"3cf24ad5",null)),Aa=Ia.exports,ja={components:{SavingAnimation:Pa["a"],NumberInput:Aa,Layout:Ct,VueSlider:Ri.a},data:function(){return{printer:null,printerId:"",saving:{},errorMessages:{},delayedSubmit:{name:{delay:1e3,timeoutId:null},retract_on_pause:{delay:1e3,timeoutId:null},lift_z_on_pause:{delay:1e3,timeoutId:null},min_timelapse_secs_on_finish:{delay:1e3,timeoutId:null},min_timelapse_secs_on_cancel:{delay:1e3,timeoutId:null}}}},computed:{retractFilamentByEnabled:{get:function(){return this.printer.retract_on_pause>0},set:function(e){this.printer.retract_on_pause=e?6.5:0}},retractOnPause:{get:function(){return this.printer?this.printer.retract_on_pause:void 0},set:function(e){this.printer&&(this.printer.retract_on_pause=e)}},liftExtruderByEnabled:{get:function(){return this.printer.lift_z_on_pause>0},set:function(e){this.printer.lift_z_on_pause=e?2.5:0}},liftExtruderBy:{get:function(){return this.printer?this.printer.lift_z_on_pause:void 0},set:function(e){this.printer&&(this.printer.lift_z_on_pause=e)}},timelapseOnFinishEnabled:{get:function(){return this.printer.min_timelapse_secs_on_finish>=0},set:function(e){this.printer.min_timelapse_secs_on_finish=e?600:-1}},minTimelapseMinutesOnFinish:{get:function(){return this.printer?this.printer.min_timelapse_secs_on_finish/60:void 0},set:function(e){this.printer&&(this.printer.min_timelapse_secs_on_finish=60*e)}},timelapseOnCancelEnabled:{get:function(){return this.printer.min_timelapse_secs_on_cancel>=0},set:function(e){this.printer.min_timelapse_secs_on_cancel=e?300:-1}},minTimelapseMinutesOnCancel:{get:function(){return this.printer?this.printer.min_timelapse_secs_on_cancel/60:void 0},set:function(e){this.printer&&(this.printer.min_timelapse_secs_on_cancel=60*e)}},printerWizardUrl:function(){return Y["a"].printerWizard(this.printer.id)},printerName:{get:function(){return this.printer?this.printer.name:void 0},set:function(e){this.printer.name=e}},detectiveSensitivity:{get:function(){return this.printer.detective_sensitivity},set:function(e){this.printer.detective_sensitivity=e,this.updateSetting("detective_sensitivity")}}},watch:{printerName:function(e,t){void 0!==t&&this.updateSetting("name")},retractOnPause:function(e,t){void 0!==t&&this.changeRetractOnPause(e)},liftExtruderBy:function(e,t){void 0!==t&&this.changeLiftExtruderBy(e)},minTimelapseMinutesOnFinish:function(e,t){void 0!==t&&this.updateSetting("min_timelapse_secs_on_finish")},minTimelapseMinutesOnCancel:function(e,t){void 0!==t&&this.updateSetting("min_timelapse_secs_on_cancel")}},created:function(){this.printerId=Te()(window.location.pathname,"/").slice(-2,-1).pop(),this.fetchPrinter()},methods:{fetchPrinter:function(){var e=this;return G.a.get(Y["a"].printer(this.printerId)).then((function(t){e.printer=se(t.data,e.printer)}))},patchPrinter:function(e,t){var n=this,i=this.getSettingsItemInput(e,t);return this.setSavingStatus(i,!0),G.a.patch(Y["a"].printer(this.printerId),Object(N["a"])({},e,t)).catch((function(e){if(e.response&&e.response.data&&"object"===Object(b["a"])(e.response.data))if(e.response.data.non_field_errors)n.errorAlert(e.response.data.non_field_errors);else for(var t in e.response.data)n.errorMessages[i]=e.response.data[t];else n.errorAlert()})).then((function(){n.setSavingStatus(i,!1)}))},errorAlert:function(){this.$swal.Toast.fire({icon:"error",html:'<div>Can not update printer settings.</div><div>Get help from <a href="https://obico.io/discord">the Obico app discussion forum</a> if this error persists.</div>'})},updateSetting:function(e){var t=this;if(e in this.delayedSubmit){var n=this.delayedSubmit[e];return n["timeoutId"]&&clearTimeout(n["timeoutId"]),void(this.delayedSubmit[e]["timeoutId"]=setTimeout((function(){t.patchPrinter(e,t.printer[e])}),n["delay"]))}this.patchPrinter(e,this.printer[e])},sensitivityTooltipFormatter:function(e){return e<.95?"Low":e>1.05?"High":"Medium"},deletePrinter:function(e){var t=this;this.$swal.Prompt.fire({title:"Are you sure?",text:"Delete ".concat(this.printer.name," printer? This action can not be undone."),showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"No"}).then((function(e){e.isConfirmed&&G.a.delete(Y["a"].printer(t.printerId)+"?with_archived=true").then((function(){window.location.href="/printers/"}))}))},archivePrinter:function(){var e=this;this.$swal.Confirm.fire().then((function(t){t.isConfirmed&&G.a.post(Y["a"].printerAction(e.printerId,"/archive/")).then((function(){e.$swal.Prompt.fire({title:"Printer archived",html:"<p>".concat(e.printer.name,' is archived.</p><p>You can find it on <a href="/ent/printers/archived/">this page</a> and un-archive it.</p>'),confirmButtonText:"Go to the printer page"}).then((function(){window.location.href="/printers/"}))}))}))},getSettingsItemInput:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";switch(e){case"action_on_failure":return"".concat(e,"_").concat(t);default:return"".concat(e)}},setSavingStatus:function(e,t){t&&delete this.errorMessages[e],this.$set(this.saving,e,t)},changeRetractOnPause:function(e){this.printer.retract_on_pause=e,this.updateSetting("retract_on_pause")},changeLiftExtruderBy:function(e){this.printer.lift_z_on_pause=e,this.updateSetting("lift_z_on_pause")}}},Ea=ja,Fa=(n("c5ee"),Object(Ce["a"])(Ea,ka,Sa,!1,null,"3b3386e6",null)),Ra=Fa.exports,Na=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("layout",{scopedSlots:e._u([{key:"content",fn:function(){return[i("b-container",[i("b-row",[i("b-col",[i("div",{staticClass:"wizard-container form-container full-on-mobile"},[e.verifiedPrinter?i("div",{staticClass:"text-center py-5"},[i("svg",{staticClass:"success-checkmark"},[i("use",{attrs:{href:"#svg-success-checkmark"}})]),i("h3",{staticClass:"pb-4"},[e._v("Successfully linked to your account!")]),i("div",{staticClass:"col-sm-12 col-md-8 offset-md-2 col-lg-6 offset-lg-3 d-flex flex-column align-center justify-content-center"},[i("saving-animation",{attrs:{errors:e.errorMessages.printer_name,saving:e.saving.printer_name}},[i("div",{staticClass:"printer-name-input"},[i("div",{staticClass:"edit-icon"},[i("i",{staticClass:"fas fa-pen"})]),i("input",{directives:[{name:"model",rawName:"v-model",value:e.verifiedPrinter.name,expression:"verifiedPrinter.name"}],staticClass:"dark",attrs:{type:"text",placeholder:"Printer name"},domProps:{value:e.verifiedPrinter.name},on:{input:[function(t){t.target.composing||e.$set(e.verifiedPrinter,"name",t.target.value)},e.updatePrinterName]}})])]),i("div",[i("div",{staticClass:"text-muted mx-auto text-center font-weight-light"},[e._v("Give your printer a shiny name.")])])],1),i("br"),i("br"),i("div",{staticClass:"col-sm-12 col-md-8 offset-md-2 col-lg-6 offset-lg-3 d-flex flex-column align-center justify-content-center"},[e.redirectToTunnelCreation?i("div",{staticClass:"mt-4"},[i("a",{staticClass:"btn btn-primary btn-block mx-auto btn-lg",attrs:{href:e.redirectToTunnelCreation}},[e._v("Authorize App Access")])]):i("div",[i("div",{staticClass:"mt-4"},[i("a",{staticClass:"btn btn-primary btn-block mx-auto btn-lg",attrs:{href:"/printers/"}},[e._v("Go Check Out Printer Feed!")])]),i("div",{staticClass:"mt-5"},[i("a",{staticClass:"btn btn-outline-secondary btn-block mx-auto",attrs:{href:"/user_preferences/notification_twilio/"}},[e._v("Add Phone Number")])]),i("div",[i("div",{staticClass:"text-muted mx-auto text-center font-weight-light"},[e._v("Receive text (SMS) in case of print failures.")])]),i("div",{staticClass:"mt-4"},[i("a",{staticClass:"btn btn-outline-secondary btn-block mx-auto",attrs:{href:e.editPrinterUrl}},[e._v("Change Printer Settings")])]),i("div",[i("div",{staticClass:"text-muted mx-auto text-center font-weight-light"},[e._v("You can always change it later.")])])])])]):i("div",[e.$route.path===e.routes.printerWizardSetup?i("div",[i("form-wizard",{attrs:{color:"var(--color-primary)","step-size":"sm"},scopedSlots:e._u([{key:"footer",fn:function(t){return[i("div",{staticClass:"wizard-footer-left"},[t.activeTabIndex>0?i("wizard-button",{staticClass:"btn btn-link btn-back",nativeOn:{click:function(n){t.prevTab(),e.prevTab(t.activeTabIndex)}}},[e._v("< Back")]):e._e()],1),i("div",{staticClass:"wizard-footer-right"},[t.isLastStep?e._e():i("wizard-button",{staticClass:"wizard-footer-right wizard-btn",style:Object.assign({},t.fillButtonStyle,{color:"var(--color-on-primary)"}),nativeOn:{click:function(n){t.nextTab(),e.nextTab(t.activeTabIndex)}}},[e._v("Next >")])],1)]}}],null,!1,223951993)},[i("h3",{attrs:{slot:"title"},slot:"title"},[e._v(" "+e._s(e.title)+" ")]),e.targetMoonraker?i("tab-content",{attrs:{title:"Install Obico for Klipper"}},[i("div",{staticClass:"container"},[i("div",{staticClass:"row justify-content-center pb-3"},[i("div",{staticClass:"col-sm-12 col-lg-8"},[i("ol",[i("li",[e._v("SSH to the Raspberry Pi your Klipper runs on.")]),i("li",[i("div",[e._v("Run:")]),i("pre",{staticClass:"mt-2"},[e._v("cd ~\ngit clone https://github.com/TheSpaghettiDetective/moonraker-obico.git\ncd moonraker-obico\n./install.sh\n                              ")])]),i("li",[e._v("Follow the installation steps.")]),i("li",[e._v("At the end, you will be asked to enter a 6-digit verification code.")])])])])])]):e._e(),e.printerIdToLink&&e.targetOctoPrint?i("tab-content",{attrs:{title:"Open Plugin Settings"}},[i("div",{staticClass:"container"},[i("div",{staticClass:"row justify-content-center pb-3"},[i("div",{staticClass:"col-sm-12 col-lg-8"},[i("div",{staticClass:"text-warning"},[e._v(" Warning: Re-Linking OctoPrint should be your last resort to solve issues. Please make sure you have exhausted all options on "),i("a",{attrs:{href:"https://www.obico.io/help/"}},[e._v("Obico's help website")]),e._v(". ")]),i("ol",[i("li",[e._v("Open OctoPrint in another browser tab. ")]),i("li",[e._v("Select "),i("em",[e._v('"OctoPrint settings menu → Obico for OctoPrint"')]),e._v(".")]),i("li",[e._v("Select "),i("em",[e._v('"Troubleshooting → Re-run Wizard"')]),e._v(".")])])])]),i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-12 col-lg-8 img-container"},[i("img",{staticClass:"mx-auto",attrs:{src:n("b231")}})])])])]):e._e(),!e.printerIdToLink&&e.targetOctoPrint?i("tab-content",{attrs:{title:"Install Plugin"}},[i("div",{staticClass:"container"},[i("div",{staticClass:"row justify-content-center pb-3"},[i("div",{staticClass:"col-sm-12 col-lg-8"},[i("ol",[i("li",[e._v("Open OctoPrint in another browser tab. ")]),i("li",[e._v("Select "),i("em",[e._v('"OctoPrint settings menu → Plugin Manager → Get More..."')]),e._v(".")]),i("li",[e._v('Enter "Obico" to locate the plugin. Click '),i("em",[e._v('"Install"')]),e._v(".")]),i("li",[e._v("Restart OctoPrint when prompted.")])])])]),i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-12 col-lg-8 img-container"},[i("img",{staticClass:"mx-auto screenshot",attrs:{src:n("2814")},on:{click:function(t){return e.zoomIn(t)}}})])])])]):e._e(),e.discoveryEnabled?[e.targetOctoPrint?i("tab-content",{attrs:{title:"Link It!"}},[i("loading",{attrs:{active:null!=e.chosenDeviceId,"can-cancel":!1}}),i("div",{staticClass:"discover"},[i("div",{staticClass:"discover-body"},[e.canStartLinking?i("div",[i("div",{staticClass:"lead my-3"},[i("div",{staticClass:"spinner-border",attrs:{role:"status"}},[i("span",{staticClass:"sr-only"})]),i("span",{staticClass:"sr-only"}),e._v("Scanning..., "+e._s(e.discoveredPrinters.length)+" OctoPrint(s) found on your local network:")]),e._l(e.discoveredPrinters,(function(t){return i("discovered-printer",{key:t.device_id,attrs:{discoveredPrinter:t},on:{"auto-link-printer":e.autoLinkPrinter}})}))],2):i("div",{staticStyle:{"text-align":"center"}},[i("div",{staticClass:"spinner-border big",attrs:{role:"status"}},[i("span",{staticClass:"sr-only"})]),i("div",{staticClass:"lead"},[e._v(" Scanning... ")])]),i("div",{staticClass:"mt-5 mb-3"},[e._v(" Can't find the OctoPrint you want to link? Switch to "),i("a",{staticClass:"link",on:{click:function(t){e.discoveryEnabled=!1}}},[e._v("Manual Setup")]),e._v(" instead. ")]),e.discoveryCount>=2?i("div",{staticClass:"text-muted"},[i("div",[e._v("To link your OctoPrint, please make sure:")]),i("ul",[i("li",[e._v("The Raspberry Pi is powered on.")]),i("li",[e._v("The Raspberry Pi is connected to the same local network as your phone/computer.")]),i("li",[e._v("The Obico plugin version is 1.8.0 or above.")])])]):e._e()])])],1):e._e()]:[e.targetOctoPrint?i("tab-content",{attrs:{title:"Plugin Wizard"}},[i("div",{staticClass:"container"},[i("div",{staticClass:"row justify-content-center pb-3"},[i("div",{staticClass:"col-sm-12 col-lg-8"},[i("ol",[i("li",[e._v("Wait for "),i("em",[e._v('"Obico for OctoPrint"')]),e._v(" wizard to popup.")]),i("li",[e._v("Follow the instructions in the wizard.")]),i("li",[e._v("Select "),i("em",[e._v('"Web Setup"')]),e._v(" when asked.")])])])]),i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-12 col-lg-8 img-container"},[i("img",{staticClass:"mx-auto screenshot",attrs:{src:n("4e03")},on:{click:function(t){return e.zoomIn(t)}}})])])])]):e._e(),i("tab-content",{attrs:{title:"Enter Code"}},[i("div",{staticClass:"container"},[i("div",{staticClass:"row justify-content-center pb-3"},[i("div",{staticClass:"col-sm-12 col-lg-8  d-flex flex-column align-items-center"},[i("input",{ref:"code",staticClass:"code-btn",attrs:{disabled:""},domProps:{value:""+(e.verificationCode&&e.verificationCode.code)}}),i("small",{staticClass:"mx-auto py-1",class:{"text-muted":!e.copied}},[e._v(e._s(e.copied?"Code copied to system clipboard":"Ctrl-C/Cmd-C to copy the code"))]),i("div",{staticClass:"mx-auto pt-1 pb-4"},[i("span",{staticClass:"text-muted"},[e._v("Code will expire in ")]),e._v(e._s(e.timeToExpire))]),i("div",{staticClass:"lead"},[e._v("Enter the "),i("strong",[e._v("6-digit verification code")])])])]),i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-12 col-lg-8 img-container"},[e.targetOctoPrint?i("img",{staticClass:"screenshot",attrs:{src:n("f1f6")},on:{click:function(t){return e.zoomIn(t)}}}):e._e(),e.targetMoonraker?i("img",{staticClass:"screenshot",attrs:{src:n("1c3a")},on:{click:function(t){return e.zoomIn(t)}}}):e._e(),i("div",{staticClass:"helper mx-auto py-2"},[i("a",{staticClass:"link font-weight-bold",on:{click:e.showVerificationCodeHelpModal}},[e._v("Can't find the page to enter the 6-digit code?")])])])])])])]],2),i("div",{staticClass:"row"},[i("div",{staticClass:"helper col-sm-12"},[e._v("Need help? Check out the "),i("a",{attrs:{target:"_blank",href:e.targetMoonraker?"https://www.obico.io/docs/user-guides/klipper-setup/":"https://www.obico.io/docs/user-guides/octoprint-plugin-setup/"}},[e._v("step-by-step set up guide.")])])])],1):i("div",{staticClass:"container"},[i("div",{staticClass:"row"},[i("h3",{staticClass:"col-sm-12 text-center p-3"},[e._v("Which platform are you using?")])]),i("div",{staticClass:"row"},[i("div",{staticClass:"col-sm-12 col-lg-6 p-4"},[i("div",{staticClass:"wizard-card",on:{click:function(t){return e.setTargetPlatform("octoprint")}}},[i("img",{attrs:{src:n("2e7f")}}),i("h3",{staticClass:"mt-4"},[e._v("OctoPrint")]),i("div",[e._v("Including OctoPrint for Klipper such as OctoKlipper.")])])]),i("div",{staticClass:"col-sm-12 col-lg-6 p-4"},[i("div",{staticClass:"wizard-card",on:{click:function(t){return e.setTargetPlatform("moonraker")}}},[i("div",[i("img",{attrs:{src:n("886f")}}),i("img",{attrs:{src:n("1f6a")}}),i("img",{attrs:{src:n("a085")}})]),i("h3",{staticClass:"mt-4"},[e._v("Klipper")]),i("h5",[e._v("with Mainsail/Fluidd/Moonraker")])])])])])])])])],1)],1)]},proxy:!0}])})},Ma=[],La=n("ccf6"),Ba=n("2ee4"),$a=(n("da93"),n("767e")),Ua=n.n($a),za=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"discovered-printers mt-4"},[i("div",{staticClass:"flex-grow-0 pt-1 mr-2"},[e.discoveredPrinter.rpi_model?i("img",{staticClass:"logo-img",attrs:{src:n("9605")}}):i("img",{staticClass:"logo-img",attrs:{src:n("2e7f")}})]),i("div",{staticClass:"row flex-grow-1 ml-1 link-action"},[i("div",{staticClass:"col-sm-12 col-md-10 pb-2"},[e.discoveredPrinter.rpi_model?i("div",[e._v(" "+e._s(e.discoveredPrinter.rpi_model)+" ")]):e._e(),e.discoveredPrinter.machine_type?i("div",[e._v(" "+e._s(e.discoveredPrinter.machine_type)+" ")]):e._e(),e.discoveredPrinter.agent?i("div",{staticClass:"text-muted small"},[e._v(" Platform: "+e._s(e.discoveredPrinter.agent)+" ")]):e._e(),e.discoveredPrinter.host_or_ip?i("div",{staticClass:"text-muted small"},[e._v(" IP address: "+e._s(e.discoveredPrinter.host_or_ip)+" ")]):e._e(),e.discoveredPrinter.hostname?i("div",{staticClass:"text-muted small"},[e._v(" Hostname: "+e._s(e.discoveredPrinter.hostname)+" ")]):e._e(),e.discoveredPrinter.octopi_version?i("div",{staticClass:"text-muted small"},[e._v(" OctoPi: "+e._s(e.discoveredPrinter.octopi_version)+" ")]):e._e(),!e.discoveredPrinter.octopi_version&&e.discoveredPrinter.os?i("div",{staticClass:"text-muted small"},[e._v(" OS: "+e._s(e.discoveredPrinter.os)+" ")]):e._e()]),i("div",{staticClass:"col-sm-12 col-md-2 center px-3"},[i("button",{staticClass:"btn btn-block btn-primary",on:{click:function(t){return e.$emit("auto-link-printer",Object.assign({},e.discoveredPrinter))}}},[e._v("Link")])])])])},Va=[],Wa={name:"DiscoveredPrinter",props:{discoveredPrinter:{type:Object,required:!0}}},qa=Wa,Ga=(n("7876"),Object(Ce["a"])(qa,za,Va,!1,null,null,null)),Ha=Ga.exports,Ja=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"px-2"},[i("div",{staticClass:"title-pic"},[i("img",{staticClass:"pic-item",attrs:{src:n("4de7")}}),e._m(0),i("img",{staticClass:"pic-item",attrs:{src:n("2e7f")}})]),e._m(1),i("div",[i("div",{staticClass:"row my-2"},[i("div",{staticClass:"col-sm-6"},[i("button",{staticClass:"btn btn-block btn-primary mt-2",attrs:{disabled:e.linking},on:{click:e.autoLinkPrinter}},[e.linking?i("b-spinner",{attrs:{small:""}}):e._e(),e._v("Link Now "),i("i",{staticClass:"fas fa-external-link-alt"})],1)]),i("div",{staticClass:"col-sm-6"},[i("button",{staticClass:"btn btn-block btn-secondary mt-2",on:{click:e.cancel}},[e._v("Cancel")])])])])])},Ya=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pic-item"},[n("i",{staticClass:"fas fa-ellipsis-h fa-2x"}),n("i",{staticClass:"fas fa-ellipsis-h fa-2x"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"my-4"},[n("p",[e._v("The Obico app needs to make sure you have access to selected OctoPrint.")]),n("p",[e._v('When you press "Link Now" button below, a new browser window will pop up to finish a handshake with this OctoPrint.')])])}],Ka={name:"AutoLinkPopup",data:function(){return{linking:!1}},props:{discoveredPrinter:{type:Object,required:!0},switchToManualLinking:{type:Function,required:!0},secretObtained:{type:Function,required:!0}},mounted:function(){window.addEventListener("message",this.gotWindowMessage)},beforeDestroy:function(){window.removeEventListener("message",this.gotWindowMessage)},methods:{autoLinkPrinter:function(){var e=this;if(this.linking=!0,this.gotSecret=null,this.obicoDiscoveryPopup=window.open(this.destUrl(),"_blank","toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no,width=500,height=100"),!this.obicoDiscoveryPopup)return this.cancel(),void this.$swal.Prompt.fire({icon:"error",title:"Oops!",html:"<p>Handshake failed because the pop-up was blcoked.</p><p>Please unblock the pop-up in your browser and try it again.</p>",confirmButtonText:"Okay!",showCancelButton:!0,cancelButtonText:"Switch to Manual Setup"}).then((function(t){t.isDismissed&&"cancel"===t.dismiss&&e.switchToManualLinking()}));setTimeout((function(){e.closeDiscoveryPopup(),e.gotSecret||(e.cancel(),e.$swal.Prompt.fire({icon:"error",title:"Handshake failed!",html:"<p>Please make sure:</p>\n              <ul>\n                <li>The OctoPrint you want to link is at ".concat(e.discoveredPrinter.host_or_ip,":").concat(e.discoveredPrinter.port,", and it's connected to the same local network as your computer/phone.</li>\n                <li>The version of plugin is 1.8.0 or above.</li>\n              </ul>"),confirmButtonText:"Okay!",showCancelButton:!0,cancelButtonText:"Switch to Manual Setup"}).then((function(t){t.isDismissed&&"cancel"===t.dismiss&&e.switchToManualLinking()})))}),5e3)},destUrl:function(){var e=this.discoveredPrinter.agent?"obico":"thespaghettidetective";return"http://".concat(this.discoveredPrinter.host_or_ip,":").concat(this.discoveredPrinter.port||"80","/plugin/").concat(e,"/grab-discovery-secret?device_id=").concat(this.discoveredPrinter.device_id)},switchToManual:function(){this.cancel(),this.switchToManualLinking()},closeDiscoveryPopup:function(){this.obicoDiscoveryPopup&&(this.obicoDiscoveryPopup.close(),this.obicoDiscoveryPopup=null)},gotWindowMessage:function(e){var t=Object(a["a"])({},(null===e||void 0===e?void 0:e.data)||{});!this.gotSecret&&this.discoveredPrinter.device_id&&t.device_secret?(this.gotSecret=t,this.secretObtained(this.discoveredPrinter.device_id,t.device_secret),this.cancel()):console.log("Ignored message",e)},cancel:function(){this.closeDiscoveryPopup(),this.$swal.close()}}},Qa=Ka,Za=(n("f01d"),Object(Ce["a"])(Qa,Ja,Ya,!1,null,"d8533ae2",null)),Xa=Za.exports,es=60,ts={components:{FormWizard:Ba["FormWizard"],TabContent:Ba["TabContent"],WizardButton:Ba["WizardButton"],Loading:Ue.a,Layout:Ct,SavingAnimation:Pa["a"],DiscoveredPrinter:Ha},data:function(){return{theme:Ua.a,verificationCode:null,verifiedPrinter:null,onVerificationStep:!1,copied:!1,saving:{},errorMessages:{},delayedSubmit:{printer_name:{delay:1e3,timeoutId:null}},discoveryEnabled:!0,discoveryCount:0,discoveredPrinters:[],chosenDeviceId:null,gotSecret:null,obicoDiscoveryPopup:null,apiCallIntervalId:null,targetPlatform:null,routes:z}},created:function(){this.printerIdToLink&&(this.discoveryEnabled=!1),this.getVerificationCode(),this.$route.path!==z.printerWizard&&this.$router.push(z.printerWizard+"?".concat(window.location.search))},computed:{printerIdToLink:function(){return new URLSearchParams(window.location.search.substring(1)).get("printerId")},title:function(){return this.printerIdToLink?"Re-Link Printer":"Link Printer"},editPrinterUrl:function(){return"/printers/".concat(this.verifiedPrinter.id,"/")},expiryMoment:function(){return this.verificationCode?J()(this.verificationCode.expired_at):null},timeToExpire:function(){return this.expiryMoment?J.a.duration(this.expiryMoment.diff(J()())).humanize():"-"},canStartLinking:function(){var e,t;return(null===(e=this.verificationCode)||void 0===e?void 0:e.code)&&(null===(t=this.discoveredPrinters)||void 0===t?void 0:t.length)>0},redirectToTunnelCreation:function(){return new URLSearchParams(window.location.search).get("redirectToTunnelCreation")},targetOctoPrint:function(){return"octoprint"===this.targetPlatform},targetMoonraker:function(){return"moonraker"===this.targetPlatform}},methods:{setTargetPlatform:function(e){this.targetPlatform=e,"moonraker"===e&&(this.discoveryEnabled=!1),this.$router.push(z.printerWizardSetup+"?".concat(window.location.search))},setSavingStatus:function(e,t){t&&delete this.errorMessages[e],this.$set(this.saving,e,t)},updatePrinterName:function(){var e=this;if("name"in this.verifiedPrinter&&this.verifiedPrinter.name){var t=this.delayedSubmit["printer_name"];return t["timeoutId"]&&clearTimeout(t["timeoutId"]),void(this.delayedSubmit["printer_name"]["timeoutId"]=setTimeout((function(){return e.setSavingStatus("printer_name",!0),G.a.patch(Y["a"].printer(e.verifiedPrinter.id),{name:e.verifiedPrinter.name}).catch((function(e){console.log(e)})).then((function(){e.setSavingStatus("printer_name",!1)}))}),t["delay"]))}var n=this.delayedSubmit["printer_name"];n["timeoutId"]&&clearTimeout(n["timeoutId"])},prevTab:function(){document.querySelector(".wizard-nav.wizard-nav-pills li.active .wizard-icon-circle").classList.remove("checked"),this.onVerificationStep=!1},nextTab:function(e){if(document.querySelector(".wizard-nav.wizard-nav-pills li.active .wizard-icon-circle").classList.add("checked"),this.onVerificationStep=1==e,0==e&&this.discoveryEnabled&&0==this.discoveryCount&&this.discoverPrinter(),this.onVerificationStep){var t=this.copyCode,n=!1,i=17,r=91,a=67;document.addEventListener("keydown",(function(e){e.keyCode!=i&&e.keyCode!=r||(n=!0)})),document.addEventListener("keyup",(function(e){e.keyCode!=i&&e.keyCode!=r||(n=!1)})),document.addEventListener("keydown",(function(e){n&&e.keyCode==a&&t()}))}},verificationCodeUrl:function(){var e=Y["a"].verificationCode();return this.verificationCode?this.verificationCode.verified_at||J()().isBefore(this.expiryMoment)?"".concat(e).concat(this.verificationCode.id,"/"):e:this.printerIdToLink?"".concat(e,"?printer_id=").concat(this.printerIdToLink):e},copyCode:function(){if(this.onVerificationStep&&this.verificationCode){var e=document.createElement("textarea");e.value=this.verificationCode.code,e.style.top="0",e.style.left="0",e.style.position="fixed",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy"),this.copied=!0}catch(t){console.error("Fallback: Oops, unable to copy",t)}document.body.removeChild(e)}},callVerificationCodeApi:function(){var e=this;G.a.get(this.verificationCodeUrl()).then((function(t){t.data&&(e.verificationCode=t.data,e.verificationCode.verified_at&&(e.verifiedPrinter=t.data.printer,La["onPrinterLinked"]&&Object(La["onPrinterLinked"])()))}))},getVerificationCode:function(){var e=this;this.callVerificationCodeApi(),this.apiCallIntervalId=setInterval((function(){e.verifiedPrinter?clearInterval(e.apiCallIntervalId):e.callVerificationCodeApi()}),5e3)},showVerificationCodeHelpModal:function(){var e='<p>The 6-digit code needs to be entered in the Obico plugin in OctoPrint. There are a few reasons why you can\'t find this page:</p>\n        <p><ul>\n        <li style="margin: 10px 0;">You don\'t have the plugin installed or you haven\'t restarted OctoPrint after installation. Click <a href="/printers/wizard/">here</a> to walk through the process again.</li>\n        <li style="margin: 10px 0;">The installed plugin is on a version earlier than 1.5.0. You need to upgrade the plugin to <b>1.5.0</b> or later.</li>\n        <li style="margin: 10px 0;">Still no dice? Check out the step-by-step <a target="_blank" href="https://www.obico.io/docs/user-guides/octoprint-plugin-setup/">set up guide</a>.</li>\n        </ul></p>';this.targetOctoPrint||(e='<p>The 6-digit code needs to be entered to the <em>Obico for OctoPrint</em> installation script.</p>\n        <p>Check <a target="_blank" href="https://www.obico.io/docs/user-guides/klipper-setup/">this set up guide</a> for detailed instructions.</p>'),this.$swal.fire({title:"Can't find the page to enter the 6-digit code?",html:e,customClass:{container:"dark-backdrop"}})},zoomIn:function(e){e.target.classList.toggle("zoomedIn")},callPrinterDiscoveryApi:function(){var e=this;this.discoveryEnabled&&(this.discoveryCount>=es&&0===this.discoveredPrinters.length&&(this.discoveryEnabled=!1,this.$swal.Toast.fire({title:"No OctoPrint discovered on your local network. Switched to manual linking."})),this.discoveryCount+=1,G.a.get(Y["a"].printerDiscovery()).then((function(t){e.discoveredPrinters=Re()(t.data,(function(e){return e.device_id}))})))},discoverPrinter:function(){var e=this;this.discoveryEnabled&&!this.verifiedPrinter&&(this.callPrinterDiscoveryApi(),setTimeout((function(){e.discoverPrinter()}),5e3))},autoLinkPrinter:function(e){var t=this;this.$swal.openModalWithComponent(Xa,{discoveredPrinter:e,switchToManualLinking:function(){return t.discoveryEnabled=!1},secretObtained:function(e,n){return t.secretObtained(e,n)}},{title:"Browser Pop-up",showConfirmButton:!1,allowOutsideClick:!1})},secretObtained:function(e,t){var n=this;this.chosenDeviceId=e,G.a.post(Y["a"].printerDiscovery(),{code:this.verificationCode.code,device_id:this.chosenDeviceId,device_secret:t}),setTimeout((function(){n.chosenDeviceId&&!n.verifiedPrinter&&(n.chosenDeviceId=null,n.$swal.Toast.fire({icon:"error",title:"Something went wrong. Switched to using 6-digit code to link OctoPrint."}),n.discoveryEnabled=!1),n.chosenDeviceId=null}),2e4)}}},ns=ts,is=(n("ff89"),n("ca15"),Object(Ce["a"])(ns,Na,Ma,!1,null,"9ec5aaa0",null)),rs=is.exports,as=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("layout",{scopedSlots:e._u([{key:"content",fn:function(){return[n("b-container",[n("b-row",{staticClass:"justify-content-center"},[n("b-col",{attrs:{lg:"8"}},[e.printer?n("div",{staticClass:"printer-card m-0"},[n("div",{staticClass:"card"},[n("div",{staticClass:"card-header"},[n("div",{staticClass:"title-box"},[n("div",{staticClass:"printer-name"},[e._v(e._s(e.printer.name))])])]),n("streaming-box",{attrs:{printer:e.printer,webrtc:e.webrtc,autoplay:e.user.is_pro}}),n("div",{staticClass:"card-body",class:{overlay:e.printer.isActive()}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.printer.isActive(),expression:"printer.isActive()"}],staticClass:"overlay-top text-center",staticStyle:{left:"0",width:"100%",top:"50%","margin-top":"-85px"}},[n("div",[e._v("Printer controls are disabled")]),n("div",[e._v("because the printer is not idle.")])]),n("div",{staticClass:"printer-controls"},[n("div",{staticClass:"xy-controls"},[n("button",{staticClass:"btn",attrs:{type:"button","data-axis":"y","data-dir":"up"},on:{click:function(t){return e.control(e.axis.y,e.directions.up)}}},[n("i",{staticClass:"fas fa-angle-up fa-lg"})]),n("div",{staticClass:"x-controls"},[n("button",{staticClass:"btn",attrs:{type:"button","data-axis":"x","data-dir":"down"},on:{click:function(t){return e.control(e.axis.x,e.directions.down)}}},[n("i",{staticClass:"fas fa-angle-left fa-lg"})]),n("button",{staticClass:"btn",attrs:{type:"button","data-axis":"xy","data-dir":"home"},on:{click:function(t){return e.control(e.axis.xy,e.directions.home)}}},[n("i",{staticClass:"fas fa-home fa-lg"})]),n("button",{staticClass:"btn",attrs:{type:"button","data-axis":"x","data-dir":"up"},on:{click:function(t){return e.control(e.axis.x,e.directions.up)}}},[n("i",{staticClass:"fas fa-angle-right fa-lg"})])]),n("button",{staticClass:"btn",attrs:{type:"button","data-axis":"y","data-dir":"down"},on:{click:function(t){return e.control(e.axis.y,e.directions.down)}}},[n("i",{staticClass:"fas fa-angle-down fa-lg"})])]),n("div",{staticClass:"z-controls"},[n("button",{staticClass:"btn",attrs:{type:"button","data-axis":"z","data-dir":"up"},on:{click:function(t){return e.control(e.axis.z,e.directions.up)}}},[n("i",{staticClass:"fas fa-angle-up fa-lg"})]),n("button",{staticClass:"btn",attrs:{type:"button","data-axis":"z","data-dir":"home"},on:{click:function(t){return e.control(e.axis.z,e.directions.home)}}},[n("i",{staticClass:"fas fa-home fa-lg"})]),n("button",{staticClass:"btn",attrs:{type:"button","data-axis":"z","data-dir":"down"},on:{click:function(t){return e.control(e.axis.z,e.directions.down)}}},[n("i",{staticClass:"fas fa-angle-down fa-lg"})])])]),n("br"),n("div",{staticClass:"control-options"},[n("b-form-group",{scopedSlots:e._u([{key:"default",fn:function(t){var i=t.ariaDescribedby;return[n("b-form-radio-group",{attrs:{options:e.jogDistanceOptions.map((function(e){return{text:e+"mm",value:e}})),name:"jogDistance","button-variant":"default","aria-describedby":i,buttons:""},model:{value:e.jogDistance,callback:function(t){e.jogDistance=t},expression:"jogDistance"}})]}}],null,!1,3731116910)})],1)])],1)]):e._e()])],1)],1)]},proxy:!0}])})},ss=[],os={x:"x",y:"y",z:"z",xy:["x","y"]},cs={up:1,down:-1,home:0},ls={name:"PrinterControlPage",components:{StreamingBox:oi,Layout:Ct},data:function(){return{axis:os,directions:cs,user:null,printerId:null,printer:null,webrtc:null,jogDistance:10,jogDistanceOptions:[.1,1,10,100]}},created:function(){var e=this;this.user=Object(ce["f"])(),this.printerId=Te()(window.location.pathname,"/").slice(-3,-2).pop();var t=Object(o["a"])()?localStorage.getItem("mm-per-step-".concat(this.printerId)):null;this.jogDistance=t||this.jogDistance,this.webrtc=Qn(),this.printerComm=$n(this.printerId,Y["a"].printerWebSocket(this.printerId),(function(t){e.printer=se(t,e.printer),e.webrtc&&!e.webrtc.initialized&&(e.webrtc.openForPrinter(e.printer.id,e.printer.auth_token),e.printerComm.setWebRTC(e.webrtc))})),this.printerComm.connect()},methods:{control:function(e,t){var n=this,i=[],r="jog";t===this.directions.home?(i.push(e),r="home"):i.push(Object(N["a"])({},e,t*this.jogDistance));var a={func:r,target:"_printer",args:i};this.printerComm.passThruToPrinter(a,(function(e,t){(null===t||void 0===t?void 0:t.error)&&n.$swal.Toast.fire({icon:"error",title:t.error})}))}},watch:{jogDistance:function(e){Object(o["a"])()&&localStorage.setItem("mm-per-step-".concat(this.printerId),e)}}},ds=ls,us=(n("b83e"),Object(Ce["a"])(ds,as,ss,!1,null,"1e285107",null)),ps=us.exports,fs=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("layout",{scopedSlots:e._u([{key:"content",fn:function(){return[n("b-container",{staticClass:"flex-full-size",class:{"is-in-mobile":e.useMobileLayout},attrs:{fluid:"xl"}},[n("b-row",{staticClass:"flex-full-size"},[n("b-col",{staticClass:"flex-full-size"},[e.user?n("div",{staticClass:"flex-full-size"},[e.useMobileLayout?n("div",{staticClass:"mobile-settings-wrapper full-on-mobile"},["/user_preferences/"===e.$route.path?n("div",{staticClass:"mobile-settings-categories"},[n("h2",{directives:[{name:"show",rawName:"v-show",value:!e.onlyNotifications(),expression:"!onlyNotifications()"}],staticClass:"categories-title section-title"},[e._v("Account")]),e._l(e.sections,(function(t,i){return[t.isHidden?e._e():n("router-link",{key:i,class:t.isSubcategory?"subcategory":"",attrs:{to:t.route}},[n("span",[t.faIcon?n("i",{class:[t.faIcon,"mr-2"],staticStyle:{"font-size":"1.125rem"}}):e._e(),n("span",[e._v(e._s(t.title))])]),n("i",{staticClass:"fas fa-arrow-right"})])]})),e.onlyNotifications()?e._e():n("a",{attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.logout(t)}}},[n("span",[n("i",{class:["fas fa-sign-out-alt","mr-2"],staticStyle:{"font-size":"1.125rem"}}),e._v(" Logout ")])])],2):n("div",{staticClass:"mobile-settings-content",class:{"is-in-mobile":e.useMobileLayout}},[!e.currentSection||e.currentSection.isNotificationChannel&&!e.availableNotificationPlugins?e._e():n(e.currentRouteComponent,{tag:"component",attrs:{user:e.user,errorMessages:e.errorMessages,saving:e.saving,config:e.config,notificationChannel:e.currentSection&&e.currentSection.isNotificationChannel?e.currentSection:{}},on:{createNotificationChannel:e.createNotificationChannel,updateNotificationChannel:e.patchNotificationChannel,deleteNotificationChannel:e.deleteNotificationChannel,clearErrorMessages:e.clearErrorMessages,addErrorMessage:e.addErrorMessage,updateSetting:e.updateSetting,errorAlert:e.errorAlert}})],1)]):n("b-tabs",{staticClass:"desktop-settings-wrapper",attrs:{vertical:!0,"nav-wrapper-class":"settings-nav","active-nav-item-class":"","content-class":"desktop-settings-content"},on:{"activate-tab":e.updateRoute},scopedSlots:e._u([{key:"tabs-end",fn:function(){return[n("li",{staticClass:"nav-item"},[n("a",{staticClass:"nav-link",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.logout(t)}}},[n("i",{class:["fas fa-sign-out-alt","mr-2"]}),e._v(" Logout ")])])]},proxy:!0}],null,!1,425318270)},[e._l(e.sections,(function(t,i){return[t.isHidden?e._e():n("b-tab",{key:i,attrs:{"title-item-class":t.isSubcategory?"subcategory":"",active:e.$route.path===t.route,disabled:t.isNotificationChannel&&!e.user.notification_enabled},scopedSlots:e._u([{key:"title",fn:function(){return[t.faIcon?n("i",{class:[t.faIcon,"mr-2"]}):e._e(),e._v(" "+e._s(t.title)+" ")]},proxy:!0}],null,!0)},[!t.isNotificationChannel||e.availableNotificationPlugins?n(i,{tag:"component",attrs:{user:e.user,errorMessages:e.errorMessages,saving:e.saving,config:e.config,notificationChannel:t.isNotificationChannel?t:{}},on:{createNotificationChannel:e.createNotificationChannel,updateNotificationChannel:e.patchNotificationChannel,deleteNotificationChannel:e.deleteNotificationChannel,clearErrorMessages:e.clearErrorMessages,addErrorMessage:e.addErrorMessage,updateSetting:e.updateSetting,errorAlert:e.errorAlert}}):e._e()],1)]}))],2)],1):n("div",{staticClass:"text-center"},[n("b-spinner",{staticClass:"mt-5",attrs:{label:"Loading..."}})],1)])],1)],1)]},proxy:!0}])})},hs=[],ms={ThemePreferences:{title:"Appearance",faIcon:"fas fa-magic",importComponent:function(){return n.e("chunk-2a713caa").then(n.bind(null,"3922"))},route:$.ThemePreferences,isHidden:Object(ce["a"])()&&!("true"===new URLSearchParams(window.location.search).get("themeable"))||Object(ce["d"])()},ProfilePreferences:{title:"Profile",faIcon:"fas fa-user-edit",importComponent:function(){return n.e("chunk-2d22c522").then(n.bind(null,"f376"))},route:$.ProfilePreferences,isHidden:Object(ce["d"])()},AuthorizedApps:{title:"Authorized Apps",faIcon:"fas fa-check-circle",importComponent:function(){return n.e("chunk-2d21a9b7").then(n.bind(null,"bbde"))},route:$.AuthorizedApps,isHidden:Object(ce["d"])()},GeneralNotifications:{title:"Notifications",faIcon:"fas fa-bell",importComponent:function(){return n.e("chunk-e7f0879a").then(n.bind(null,"9c95"))},route:$.GeneralNotifications},PushNotifications:{title:"Push Notification",isSubcategory:!0,isNotificationChannel:!0,importComponent:function(){return{}},route:$.PushNotifications,isHidden:!Object(ce["a"])()}},vs=Object.keys(M).reduce((function(e,t){return Object.assign(e,Object(N["a"])({},t,{title:M[t].displayName,channelName:t,isSubcategory:!0,isNotificationChannel:!0,route:$[t],importComponent:function(){return n("17ae")("./"+t)}}))}),{}),gs=Object(a["a"])(Object(a["a"])({},ms),vs),bs={name:"UserPreferencesPage",props:{config:{default:function(){return{}},type:Object}},components:Object(a["a"])({Layout:Ct},Object.keys(gs).reduce((function(e,t){return Object.assign(e,Object(N["a"])({},t,gs[t].importComponent))}),{})),data:function(){return{sections:gs,availableNotificationPlugins:null,configuredNotificationChannels:null,onlyNotifications:ce["d"],user:null,saving:{},errorMessages:{},delayedSubmit:{first_name:{delay:1e3,timeoutId:null},last_name:{delay:1e3,timeoutId:null}},combinedInputs:{},useMobileLayout:!1}},computed:{visibleSections:function(){return Object.values(gs).filter((function(e){return!e.isHidden}))},currentRouteComponent:function(){for(var e=0,t=Object.entries($);e<t.length;e++){var n=Object(Fn["a"])(t[e],2),i=n[0],r=n[1];if(this.$route.path===r)return i}return null},currentSection:function(){for(var e=0,t=Object.values(this.sections);e<t.length;e++){var n=t[e];if(n.route===this.$route.path)return n}return null},inMobileWebView:function(){return Object(ce["a"])()},clientIsThemeable:function(){return!Object(ce["a"])()||"true"===new URLSearchParams(window.location.search).get("themeable")},firstName:{get:function(){return this.user?this.user.first_name:void 0},set:function(e){this.user.first_name=e}},lastName:{get:function(){return this.user?this.user.last_name:void 0},set:function(e){this.user.last_name=e}}},watch:{firstName:function(e,t){void 0!==t&&this.updateSetting("first_name")},lastName:function(e,t){void 0!==t&&this.updateSetting("last_name")}},created:function(){this.fetchNotificationPlugins(),this.fetchNotificationChannels(),this.fetchUser()},methods:{updateRoute:function(e){var t=Object.values(this.visibleSections)[e];this.$router.replace({path:t.route})},logout:function(){this.$swal.Confirm.fire({title:"Confirmation",html:'<p class="text-center">You a going to logout from your account</p>',confirmButtonText:"Logout",cancelButtonText:"Cancel"}).then((function(e){e.isConfirmed&&window.location.replace("/accounts/logout/")}))},checkMobileLayout:function(){var e=Math.max(document.documentElement.clientWidth||0,window.innerWidth||0);this.useMobileLayout=Object(ce["a"])()||e<1140},fetchUser:function(){var e=this;return G.a.get(Y["a"].user()).then((function(t){e.user=t.data}))},fetchNotificationPlugins:function(){var e=this;return G.a.get(Y["a"].notificationPlugins()).then((function(t){var n=t.data.plugins||{};e.availableNotificationPlugins=n;for(var i=0,r=Object.entries(e.sections);i<r.length;i++){var a=Object(Fn["a"])(r[i],2),s=a[0],o=a[1];o.isNotificationChannel&&(e.sections[s].pluginInfo=n[o.channelName])}}))},fetchNotificationChannels:function(){var e=this;return G.a.get(Y["a"].notificationChannels()).then((function(t){var n=t.data;e.configuredNotificationChannels=n;for(var i=function(){var t=Object(Fn["a"])(a[r],2),i=t[0],s=t[1];s.isNotificationChannel&&(e.sections[i].channelInfo=n.filter((function(e){return e.name===s.channelName}))[0])},r=0,a=Object.entries(e.sections);r<a.length;r++)i()}))},createNotificationChannel:function(e,t){var n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object(a["a"])({user:this.user.id,name:e.channelName,config:t},i),s=Object(Nt["c"])(e,"config");return this.setSavingStatus(s,!0),G.a.post(Y["a"].notificationChannels(),r).then((function(){n.setSavingStatus(s,!1),n.$router.go()})).catch((function(t){if(n.setSavingStatus(s,!1),t.response&&t.response.data&&"object"===Object(b["a"])(t.response.data)){for(var i=[],r=0,a=Object.values(t.response.data);r<a.length;r++){var o=a[r];if("object"===Object(b["a"])(o))for(var c=0,l=Object.values(o);c<l.length;c++){var d=l[c];i.push(d)}else"string"===typeof o?i.push(o):(console.warn("Undefined error object structure"),console.log(t.response))}var u=Object(Nt["c"])(e,"config");n.$set(n.errorMessages,u,i)}else console.log(t.response),n.errorAlert()}))},patchNotificationChannel:function(e,t){var n,i=this,r={name:e.channelName},a=Object(Vn["a"])(t);try{for(a.s();!(n=a.n()).done;){var s=n.value;r[s]=e.channelInfo[s]}}catch(u){a.e(u)}finally{a.f()}var o,c=Object(Vn["a"])(t);try{for(c.s();!(o=c.n()).done;){var l=o.value,d=Object(Nt["c"])(e,l);this.setSavingStatus(d,!0)}}catch(u){c.e(u)}finally{c.f()}return G.a.patch(Y["a"].updateNotificationChannel(e.channelInfo.id),r).then((function(){var n,r=Object(Vn["a"])(t);try{for(r.s();!(n=r.n()).done;){var a=n.value,s=Object(Nt["c"])(e,a);i.setSavingStatus(s,!1)}}catch(u){r.e(u)}finally{r.f()}})).catch((function(n){var r,a=Object(Vn["a"])(t);try{for(a.s();!(r=a.n()).done;){var s=r.value,o=Object(Nt["c"])(e,s);i.setSavingStatus(o,!1)}}catch(n){a.e(n)}finally{a.f()}if(n.response&&n.response.data&&"object"===Object(b["a"])(n.response.data)){for(var c=[],l=0,d=Object.values(n.response.data);l<d.length;l++){var u=d[l];if("object"===Object(b["a"])(u))for(var p=0,f=Object.values(u);p<f.length;p++){var h=f[p];c.push(h)}else"string"===typeof u?c.push(u):(console.warn("Undefined error object structure"),console.log(n.response))}var m,v=Object(Vn["a"])(t);try{for(v.s();!(m=v.n()).done;){var g=m.value,_=Object(Nt["c"])(e,g);i.$set(i.errorMessages,_,c)}}catch(n){v.e(n)}finally{v.f()}}else console.log(n.response),i.errorAlert()}))},deleteNotificationChannel:function(e){var t=this;return G.a.delete(Y["a"].updateNotificationChannel(e.channelInfo.id)).then((function(){t.$router.go()})).catch((function(e){console.log(e.response),t.errorAlert()}))},clearErrorMessages:function(e){this.errorMessages[e]=[]},addErrorMessage:function(e,t){this.errorMessages[e]?this.errorMessages[e].push(t):this.errorMessages[e]=[t]},patchUser:function(e,t){var n=this,i={},r=e,a=this.checkForCombinedValues(e);if(a){var s,o=Object(Vn["a"])(a.inputs);try{for(o.s();!(s=o.n()).done;){var c=s.value;r=a.key;var l=this.user[c];i[c]=l}}catch(p){o.e(p)}finally{o.f()}var d=Object.values(i),u=d.filter((function(e){return!e}));if(u.length!==d.length&&0!==u.length)return}else i=Object(N["a"])({},e,t);return this.setSavingStatus(r,!0),G.a.patch(Y["a"].user(),i).catch((function(e){if(e.response&&e.response.data&&"object"===Object(b["a"])(e.response.data))if(e.response.data.non_field_errors)n.errorAlert(e.response.data.non_field_errors);else for(var t in e.response.data)n.errorMessages[r]=e.response.data[t];else n.errorAlert()})).then((function(){window.ReactNativeWebView&&("first_name"===r?window.ReactNativeWebView.postMessage(JSON.stringify({firstName:n.firstName})):"last_name"===r&&window.ReactNativeWebView.postMessage(JSON.stringify({lastName:n.lastName}))),n.setSavingStatus(r,!1)}))},checkForCombinedValues:function(e){for(var t=0,n=Object.entries(this.combinedInputs);t<n.length;t++){var i=Object(Fn["a"])(n[t],2),r=i[0],a=i[1];if(a.includes(e))return{inputs:a,key:r}}return null},setSavingStatus:function(e,t){t&&delete this.errorMessages[e],this.$set(this.saving,e,t)},errorAlert:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.$swal({icon:"error",html:"<p>".concat(e||"Can not update your preferences.",'</p><p>Get help from <a href="https://obico.io/discord">the Obico app discussion forum</a> if this error persists.</p>')})},updateSetting:function(e){var t=this;if(console.log("updateSetting, ",e),e in this.delayedSubmit){var n=this.delayedSubmit[e];return n["timeoutId"]&&clearTimeout(n["timeoutId"]),void(this.delayedSubmit[e]["timeoutId"]=setTimeout((function(){t.patchUser(e,t.user[e])}),n["delay"]))}this.patchUser(e,this.user[e])}},mounted:function(){this.checkMobileLayout(),window.onresize=this.checkMobileLayout,this.useMobileLayout&&(document.querySelector("body").style.paddingTop="0px")}},_s=bs,ws=(n("5a1e"),Object(Ce["a"])(_s,fs,hs,!1,null,"68d62d49",null)),Cs=ws.exports,ys=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("layout",{scopedSlots:e._u([{key:"topBarRight",fn:function(){return[i("div",[i("b-dropdown",{attrs:{right:"","no-caret":"","toggle-class":"icon-btn"},scopedSlots:e._u([{key:"button-content",fn:function(){return[i("i",{staticClass:"fas fa-filter"})]},proxy:!0}])},[e._l(e.eventClassFiltering,(function(t,n){return i("b-dropdown-item",{key:t.key,on:{click:function(n){return e.toggleEventFiltering("eventClassFiltering",t.key)}}},[i("i",{staticClass:"fas fa-check text-primary",style:{visibility:t.selected?"visible":"hidden"}}),i("span",{class:e.cssClassFromEventClass(t.key)},[e._v(e._s(t.title))])])})),i("b-dropdown-divider"),e._l(e.eventTypeFiltering,(function(t,n){return i("b-dropdown-item",{key:t.key,on:{click:function(n){return e.toggleEventFiltering("eventTypeFiltering",t.key)}}},[i("i",{staticClass:"fas fa-check text-primary",style:{visibility:t.selected?"visible":"hidden"}}),e._v(e._s(t.title)+" ")])}))],2)],1)]},proxy:!0},{key:"content",fn:function(){return[i("b-container",[i("b-row",{staticClass:"justify-content-center"},[i("div",{staticClass:"col-sm-12 col-md-10 col-lg-8"},[e.loading||0!==e.printerEvents.length?i("div",[e._l(e.printerEvents,(function(e){return i("printer-event-card",{key:e.id,attrs:{"printer-event":e}})})),i("mugen-scroll",{staticClass:"text-center p-4",attrs:{handler:e.fetchMoreData,"should-handle":!e.loading}},[e.noMoreData?i("div",{staticClass:"text-center p-2"},[e._v("No more notifications.")]):e._e(),e.noMoreData?e._e():i("b-spinner",{attrs:{label:"Loading..."}})],1)],2):i("div",{staticClass:"text-center"},[i("img",{staticClass:"w-25 my-4",attrs:{src:n("f23d")}}),i("h5",{staticClass:"text-primary"},[e._v("Nothing to look here. Enjoy your vacation!")])])])])],1)]},proxy:!0}])})},ks=[],Ss=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"printer-event-card my-3",class:e.tintBorderClass},[n("div",{staticClass:"printer-event-text",class:{link:e.printerEvent.info_url},on:{click:e.onTextClick}},[n("div",{staticClass:"title font-weight-bold my-2",class:e.tintClass},[e._v(" "+e._s(e.eventTitle)+" "),e.printerEvent.info_url?n("i",{staticClass:"fas fa-external-link-alt"}):e._e()]),n("div",{staticClass:"description",domProps:{innerHTML:e._s(e.printerEvent.event_text)}}),n("div",{staticClass:"my-2 text-muted font-weight-light small"},[e._v(" "+e._s(e.printerEvent.created_at.format("LLLL"))+" ")])]),e.printerEvent.image_url?n("div",{staticClass:"printer-event-snapshot",style:{backgroundImage:"url("+e.printerEvent.image_url+")"}}):e._e()])},Ps=[],xs={name:"PrinterEventCard",components:{},props:{printerEvent:Object},computed:{eventTitle:function(){return this.printerEvent.event_title||"Unknown event"},tintClass:function(){switch(this.printerEvent.event_class){case"ERROR":return"text-danger";case"WARNING":return"text-warning";case"SUCCESS":return"text-success";default:return""}},tintBorderClass:function(){switch(this.printerEvent.event_class){case"ERROR":return"border-danger";case"WARNING":return"border-warning";case"SUCCESS":return"border-success";default:return""}}},methods:{onTextClick:function(){this.printerEvent.info_url&&window.open(this.printerEvent.info_url,"_blank")}}},Ts=xs,Os=(n("404a"),Object(Ce["a"])(Ts,Ss,Ps,!1,null,"1671f474",null)),Ds=Os.exports,Is={eventClassFiltering:"printer-event-class-filtering",eventTypeFiltering:"printer-event-type-filtering"},As=function(e,t){return"".concat(Is["prefix"],".").concat(t)},js=function(e,t,n){return c(As(e,t),n)},Es=12,Fs={name:"PrinterEventsPage",components:{MugenScroll:Dt.a,Layout:Ct,PrinterEventCard:Ds},props:{},data:function(){return{printerEvents:[],loading:!1,noMoreData:!1,eventClassFiltering:[{key:"ERROR",title:"Error",selected:js("eventClassFiltering","ERROR",!0)},{key:"WARNING",title:"Warning",selected:js("eventClassFiltering","WARNING",!0)},{key:"SUCCESS",title:"Successs",selected:js("eventClassFiltering","SUCCESS",!0)},{key:"INFO",title:"Other",selected:js("eventClassFiltering","INFO",!0)}],eventTypeFiltering:[{key:"ALERT",title:"Failure Detection",selected:js("eventTypeFiltering","ALERT",!0)},{key:"ENDED",title:"Print Job Ended",selected:js("eventTypeFiltering","ENDED",!0)},{key:"STARTED",title:"Print Job Started",selected:js("eventTypeFiltering","STARTED",!0)},{key:"PAUSE_RESUME",title:"Print Job Paused/Resumed",selected:js("eventTypeFiltering","PAUSE_RESUME",!0)},{key:"FILAMENT_CHANGE",title:"Filament Change",selected:js("eventTypeFiltering","FILAMENT_CHANGE",!0)},{key:"PRINTER_ERROR",title:"Printer Error",selected:js("eventTypeFiltering","PRINTER_ERROR",!0)}]}},created:function(){this.refetchData()},methods:{fetchMoreData:function(){var e=this;if(!this.noMoreData){this.loading=!0;var t=At()(Rt()(this.eventClassFiltering,"selected"),"key"),n=At()(Rt()(this.eventTypeFiltering,"selected"),"key");G.a.get(Y["a"].printerEvents(),{params:{start:this.printerEvents.length,limit:Es,filter_by_classes:t,filter_by_types:n}}).then((function(t){var n;e.loading=!1,e.noMoreData=t.data.length<Es,(n=e.printerEvents).push.apply(n,Object(R["a"])(t.data.map((function(e){return oe(e)}))))}))}},refetchData:function(){this.printerEvents=[],this.noMoreData=!1,this.fetchMoreData()},cssClassFromEventClass:function(e){switch(e){case"ERROR":return"text-danger";case"INFO":return"";default:return"text-".concat(e.toLowerCase())}},toggleEventFiltering:function(e,t){var n=Me()(this[e],(function(e){return e.key==t})),i=this[e][n];this.$set(this[e],n,Object(a["a"])(Object(a["a"])({},i),{},{selected:!i.selected})),l(As("eventClassFiltering",e.key),!i.selected),this.refetchData()}}},Rs=Fs,Ns=Object(Ce["a"])(Rs,ys,ks,!1,null,"4dbbbf7a",null),Ms=Ns.exports,Ls=new r["a"]({mode:"history",routes:[{path:"/g_code_folders/cloud/:parentFolder",component:qr},{path:"/g_code_folders/local/:printerId/:parentFolder?",component:qr},{path:"/g_code_files/cloud/:fileId",component:ra},{path:"/g_code_files/local/:printerId/:fileId",component:ra},{path:"/user_preferences",component:Cs}].concat(Object(R["a"])(Object.values($).map((function(e){return{path:e,component:Cs}}))),Object(R["a"])(Object.values(z).map((function(e){return{path:e,component:rs}}))))}),Bs={NewOctoPrintTunnelPage:ke,OctoPrintTunnelPage:Ae,PrintShotFeedbackApp:Pt,PrinterListPage:da,SharedPrinterPage:ya,PrinterSettingsPage:Ra,PrinterWizardPage:rs,PrinterControlPage:ps,GCodeFoldersPage:qr,GCodeFilePage:ra,PrintsPage:fn,PrintPage:_n,UploadPrintPage:Tn,UserPreferencesPage:Cs,PrinterEventsPage:Ms};F(Ls,Bs)},"59cf":function(e,t,n){"use strict";n.d(t,"a",(function(){return B})),n.d(t,"c",(function(){return $})),n.d(t,"b",(function(){return W})),n.d(t,"d",(function(){return q}));n("4160"),n("b0c0"),n("d3b7"),n("159b"),n("ddb0");var i,r,a,s,o,c,l,d,u,p,f,h,m,v,g,b,_,w,C,y,k,S,P,x,T,O,D,I,A,j,E,F,R,N,M=n("fc11"),L=n("6c44"),B={Light:"Light",Dark:"Dark",System:"System"},$=(Object(L["a"])()?localStorage.getItem("colorTheme"):B.Dark)||B.Dark,U=[{name:"primary",values:(i={},Object(M["a"])(i,B.Light,"#01A299"),Object(M["a"])(i,B.Dark,"#03DAC5"),i)},{name:"primary-hover",values:(r={},Object(M["a"])(r,B.Light,"#019592"),Object(M["a"])(r,B.Dark,"#70EFDE"),r)},{name:"primary-muted",values:(a={},Object(M["a"])(a,B.Light,"#03DAC5"),Object(M["a"])(a,B.Dark,"#018786"),a)},{name:"on-primary",values:(s={},Object(M["a"])(s,B.Light,"#FFFFFF"),Object(M["a"])(s,B.Dark,"#001210"),s)},{name:"secondary",values:(o={},Object(M["a"])(o,B.Light,"#28303A"),Object(M["a"])(o,B.Dark,"#EBEBEB"),o)},{name:"secondary-hover",values:(c={},Object(M["a"])(c,B.Light,"#424A54"),Object(M["a"])(c,B.Dark,"#D0D0D0"),c)},{name:"on-secondary",values:(l={},Object(M["a"])(l,B.Light,"#EBEBEB"),Object(M["a"])(l,B.Dark,"#28303A"),l)},{name:"success",values:(d={},Object(M["a"])(d,B.Light,"#5CB85C"),Object(M["a"])(d,B.Dark,"#5CB85C"),d)},{name:"success-hover",values:(u={},Object(M["a"])(u,B.Light,"#4CAE4C"),Object(M["a"])(u,B.Dark,"#4CAE4C"),u)},{name:"on-success",values:(p={},Object(M["a"])(p,B.Light,"#ffffff"),Object(M["a"])(p,B.Dark,"#ffffff"),p)},{name:"danger",values:(f={},Object(M["a"])(f,B.Light,"#D9534F"),Object(M["a"])(f,B.Dark,"#D9534F"),f)},{name:"danger-hover",values:(h={},Object(M["a"])(h,B.Light,"#C2413D"),Object(M["a"])(h,B.Dark,"#C2413D"),h)},{name:"on-danger",values:(m={},Object(M["a"])(m,B.Light,"#ffffff"),Object(M["a"])(m,B.Dark,"#ffffff"),m)},{name:"warning",values:(v={},Object(M["a"])(v,B.Light,"#F0AD4E"),Object(M["a"])(v,B.Dark,"#F0AD4E"),v)},{name:"warning-hover",values:(g={},Object(M["a"])(g,B.Light,"#DB9A3F"),Object(M["a"])(g,B.Dark,"#DB9A3F"),g)},{name:"on-warning",values:(b={},Object(M["a"])(b,B.Light,"#ffffff"),Object(M["a"])(b,B.Dark,"#ffffff"),b)},{name:"on-warning-2",values:(_={},Object(M["a"])(_,B.Light,"#000000"),Object(M["a"])(_,B.Dark,"#000000"),_)},{name:"background",values:(w={},Object(M["a"])(w,B.Light,"#EBEBEB"),Object(M["a"])(w,B.Dark,"#233141"),w)},{name:"surface-primary",values:(C={},Object(M["a"])(C,B.Light,"#ffffff"),Object(M["a"])(C,B.Dark,"#485B71"),C)},{name:"surface-secondary",values:(y={},Object(M["a"])(y,B.Light,"#F5F5F5"),Object(M["a"])(y,B.Dark,"#2D3E4F"),y)},{name:"overlay",values:(k={},Object(M["a"])(k,B.Light,"#F5F5F5CC"),Object(M["a"])(k,B.Dark,"#000000CC"),k)},{name:"hover",values:(S={},Object(M["a"])(S,B.Light,"#66666613"),Object(M["a"])(S,B.Dark,"#FFFFFF13"),S)},{name:"divider",values:(P={},Object(M["a"])(P,B.Light,"#ABB6C2"),Object(M["a"])(P,B.Dark,"#6A7B8A"),P)},{name:"divider-muted",values:(x={},Object(M["a"])(x,B.Light,"#ABB6C266"),Object(M["a"])(x,B.Dark,"#6A7B8A66"),x)},{name:"text-primary",values:(T={},Object(M["a"])(T,B.Light,"#28303A"),Object(M["a"])(T,B.Dark,"#EBEBEB"),T)},{name:"text-secondary",values:(O={},Object(M["a"])(O,B.Light,"#8A94A2"),Object(M["a"])(O,B.Dark,"#AAACB0"),O)},{name:"text-help",values:(D={},Object(M["a"])(D,B.Light,"#4C9BE8"),Object(M["a"])(D,B.Dark,"#4C9BE8"),D)},{name:"input-background",values:(I={},Object(M["a"])(I,B.Light,"#E2E8ED"),Object(M["a"])(I,B.Dark,"#42566B"),I)},{name:"input-placeholder",values:(A={},Object(M["a"])(A,B.Light,"#28303A80"),Object(M["a"])(A,B.Dark,"#EBEBEB80"),A)},{name:"table-accent",values:(j={},Object(M["a"])(j,B.Light,"#E3E3E3"),Object(M["a"])(j,B.Dark,"#283848"),j)},{name:"icon-tunneling-1",values:(E={},Object(M["a"])(E,B.Light,"#4E5D6C"),Object(M["a"])(E,B.Dark,"#EAEAEA"),E)},{name:"icon-tunneling-2",values:(F={},Object(M["a"])(F,B.Light,"#1D2935"),Object(M["a"])(F,B.Dark,"#CDCDCD"),F)}],z=[{name:"loader",values:(R={},Object(M["a"])(R,B.Light,'url("/static/img/loader/loader_light-scheme.svg")'),Object(M["a"])(R,B.Dark,'url("/static/img/loader/loader_dark-scheme.svg")'),R)}],V=[{name:"top-nav",values:(N={},Object(M["a"])(N,B.Light,"0px 2px 10px rgb(0 0 0 / .1)"),Object(M["a"])(N,B.Dark,"0px 2px 10px rgb(0 0 0 / .3)"),N)}];function W(e){return e.value===B.System?"not all"!==window.matchMedia("(prefers-color-scheme)").media&&window.matchMedia("(prefers-color-scheme: light)").matches?B.Light:B.Dark:e.value}function q(e){U.forEach((function(t){if(document.documentElement.style.setProperty("--color-".concat(t.name),t.values[e]),"surface-secondary"===t.name){var n=document.querySelector('meta[name="theme-color"]');n.content=t.values[e]}})),z.forEach((function(t){document.documentElement.style.setProperty("--url-".concat(t.name),t.values[e])})),V.forEach((function(t){document.documentElement.style.setProperty("--shadow-".concat(t.name),t.values[e])}))}},"5a1e":function(e,t,n){"use strict";var i=n("40e1"),r=n.n(i);r.a},"5ee5":function(e,t,n){},6426:function(e,t,n){},"667b":function(e,t,n){"use strict";var i=n("5ee5"),r=n.n(i);r.a},"6c44":function(e,t,n){"use strict";function i(){try{var e="__random_key_we_are_not_going_to_use__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(t){return!1}}n.d(t,"a",(function(){return i}))},"75c7":function(e,t,n){"use strict";var i=n("86a9"),r=n.n(i);r.a},"767e":function(e,t,n){e.exports={primary:"#00c4b4",white:"#fff"}},7682:function(e,t,n){},7876:function(e,t,n){"use strict";var i=n("4392"),r=n.n(i);r.a},7992:function(e,t,n){"use strict";var i=n("d0c5"),r=n.n(i);r.a},"7a3c":function(e,t,n){},"7dd6":function(e,t,n){"use strict";var i=n("24bc"),r=n.n(i);r.a},"809e":function(e,t,n){},"822b":function(e,t,n){},"847e":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{class:{"saving-in-progress":e.savingClass,"successfully-saved":e.savingDoneClass,"failed-to-save":e.savingFailedClass,"small-height":e.smallHeightClass}},[e._t("default")],2),e.errors&&e.errors.length>0?n("small",{staticClass:"text-danger"},[e._v(e._s(e.errorMsg))]):e._e()])},r=[],a=(n("a15b"),{name:"SavingAnimation",data:function(){return{savingTimeout:null,savingDoneTimeout:null}},props:{saving:{default:function(){return!1},type:Boolean},errors:{type:Array},height:{default:function(){return"normal"},type:String}},watch:{saving:function(e,t){var n=this;!t&&e?(this.clearSavingTimeout(),this.savingTimeout=setTimeout(this.clearSavingTimeout,15e3)):t&&!e&&(this.clearSavingTimeout(),this.savingDoneTimeout=setTimeout((function(){clearTimeout(n.savingDoneTimeout),n.savingDoneTimeout=null}),2e3))}},computed:{savingClass:function(){return this.saving&&this.savingTimeout},savingDoneClass:function(){return!this.saving&&this.savingDoneTimeout&&!this.errors},savingFailedClass:function(){return!this.saving&&this.savingDoneTimeout&&this.errors&&this.errors.length>0},smallHeightClass:function(){return"small"===this.height},errorMsg:function(){return this.errors?this.errors.join(" "):""}},methods:{clearSavingTimeout:function(){this.savingTimeout&&(clearTimeout(this.savingTimeout),this.savingTimeout=null)}}}),s=a,o=(n("ddd8"),n("2877")),c=Object(o["a"])(s,i,r,!1,null,"4606a7ec",null);t["a"]=c.exports},8537:function(e,t,n){},"86a9":function(e,t,n){},"886f":function(e,t,n){e.exports=n.p+"img/klipper_logo.jpg"},"899c":function(e,t,n){"use strict";var i=n("e404"),r=n.n(i);r.a},"8bc4":function(e,t,n){"use strict";var i=n("3ed7"),r=n.n(i);r.a},"8c3a":function(e,t,n){"use strict";var i=n("05df"),r=n.n(i);r.a},"90d8":function(e,t,n){"use strict";var i=n("809e"),r=n.n(i);r.a},9158:function(e,t,n){"use strict";var i=n("1e98"),r=n.n(i);r.a},9605:function(e,t,n){e.exports=n.p+"img/raspberry_pi.png"},"9fd0":function(e,t,n){"use strict";var i=n("6426"),r=n.n(i);r.a},a085:function(e,t,n){e.exports=n.p+"img/fluidd_logo.png"},a0a4:function(e,t,n){"use strict";var i=n("1920"),r=n.n(i);r.a},a12a:function(e,t,n){"use strict";var i=n("822b"),r=n.n(i);r.a},a180:function(e,t,n){"use strict";var i=n("35af"),r=n.n(i);r.a},b231:function(e,t,n){e.exports=n.p+"img/plugin_rerun_setup.png"},b279:function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return h})),n.d(t,"e",(function(){return m})),n.d(t,"a",(function(){return v})),n.d(t,"f",(function(){return g}));n("99af"),n("caad"),n("2532");var i=n("54f8"),r=n("e740"),a=n.n(r),s=n("2f9f"),o=n.n(s),c=n("6373"),l=n.n(c),d=n("9b02"),u=n.n(d);function p(e,t){return"".concat(e.channelName,"_").concat(t)}function f(e){return a()(o()(l()(e,/_/g," ")))}var h=function(e,t,n){var i=Math.round(e.length*t),r=n?"p":"fields.normalized_p";return u()(e[i],"".concat(r),0)},m=function(e,t){if(e)if(e instanceof Blob){var n=new FileReader;n.addEventListener("loadend",(function(e){e.srcElement&&t(e.srcElement.result)})),n.readAsArrayBuffer(e)}else t(e)},v=function(){var e;return null===(e=document.getElementsByName("csrfmiddlewaretoken")[0])||void 0===e?void 0:e.value},g=function(e,t){var n,r=!1,a=e.path||e.composedPath&&e.composedPath(),s=Object(i["a"])(a);try{for(s.s();!(n=s.n()).done;){var o=n.value;if(o.className&&o.className.includes(t)){r=!0;break}}}catch(c){s.e(c)}finally{s.f()}return r}},b5a7f:function(e,t,n){"use strict";var i=n("f64b"),r=n.n(i);r.a},b83e:function(e,t,n){"use strict";var i=n("c12e"),r=n.n(i);r.a},bab6:function(e,t,n){"use strict";var i=n("8537"),r=n.n(i);r.a},c11f:function(e,t,n){"use strict";var i=n("1ccb"),r=n.n(i);r.a},c12e:function(e,t,n){},c44a:function(e,t,n){"use strict";var i=n("09e8"),r=n.n(i);r.a},c565:function(e,t,n){},c5ee:function(e,t,n){"use strict";var i=n("22c6"),r=n.n(i);r.a},c7f6:function(e,t,n){"use strict";n("99af"),n("a15b");var i=n("0b49"),r=n.n(i),a=n("dd61"),s=n.n(a);t["a"]={printShotFeedback:function(e,t){return"/api/v1/printshotfeedbacks/".concat(e,"/?print_id=").concat(t)},print:function(e){return"/api/v1/prints/".concat(e,"/")},prints:function(){return"/api/v1/prints/"},printsBulkDelete:function(){return"/api/v1/prints/bulk_delete/"},printers:function(){return"/api/v1/printers/"},printer:function(e){return"/api/v1/printers/".concat(e,"/")},printerAction:function(e,t){return"/api/v1/printers/".concat(e).concat(t)},pubPrinter:function(){return"/api/v1p/printer/"},tunnels:function(){return"/api/v1/tunnels/"},tunnel:function(e){return"/api/v1/tunnels/".concat(e,"/")},tunnelUsage:function(){return"/api/v1/tunnelusage/"},verificationCode:function(){return"/api/v1/onetimeverificationcodes/"},user:function(){return"/api/v1/users/me/"},sharedResources:function(e){return"/api/v1/sharedresources/?"+s()(r()(e),(function(e){return e.join("=")})).join("&")},sharedResource:function(e){return"/api/v1/sharedresources/".concat(e,"/")},printerDiscovery:function(){return"/api/v1/printer_discovery/"},printerEvents:function(){return"/api/v1/printer_events/"},notificationPlugins:function(){return"/api/v1/notification_settings/available_plugins/"},notificationChannels:function(){return"/api/v1/notification_settings/"},updateNotificationChannel:function(e){return"/api/v1/notification_settings/".concat(e,"/")},testNotificationChannel:function(e){return"/api/v1/notification_settings/".concat(e,"/send_test_message/")},printerControl:function(e){return"/printers/".concat(e,"/control/")},printerWebSocket:function(e){return"/ws/web/".concat(e,"/")},printerSharedWebSocket:function(e){return"/ws/share_token/web/".concat(e,"/")},printerWizard:function(e){return"/printers/wizard/?printerId=".concat(e)},gcodeFile:function(e){return"/api/v1/g_code_files/".concat(e,"/")},gcodeFiles:function(){return"/api/v1/g_code_files/"},gcodeFolder:function(e){return"/api/v1/g_code_folders/".concat(e,"/")},gcodeFolders:function(){return"/api/v1/g_code_folders/"},gcode:function(e){return"/api/v1/g_code_files/".concat(e,"/")}}},ca14:function(e,t,n){e.exports=n.p+"img/octoapp.webp"},ca15:function(e,t,n){"use strict";var i=n("d605"),r=n.n(i);r.a},ccf6:function(e,t){},d0c5:function(e,t,n){},d0e8:function(e,t,n){"use strict";var i=n("0ab6"),r=n.n(i);r.a},d1d5:function(e,t,n){e.exports=n.p+"img/generic-app.png"},d4ad:function(e,t,n){"use strict";var i=n("7a3c"),r=n.n(i);r.a},d605:function(e,t,n){},ddd8:function(e,t,n){"use strict";var i=n("faad"),r=n.n(i);r.a},e152:function(e,t,n){"use strict";var i=n("faa6"),r=n.n(i);r.a},e39f:function(e,t,n){"use strict";var i=n("c565"),r=n.n(i);r.a},e3ad:function(e,t,n){"use strict";var i=n("3920"),r=n.n(i);r.a},e404:function(e,t,n){},f01d:function(e,t,n){"use strict";var i=n("013e"),r=n.n(i);r.a},f12f:function(e,t,n){"use strict";var i=n("7682"),r=n.n(i);r.a},f1f6:function(e,t,n){e.exports=n.p+"img/plugin_verification_code.png"},f23d:function(e,t,n){e.exports=n.p+"img/vacation.gif"},f249:function(e,t,n){"use strict";var i=n("058a"),r=n.n(i);r.a},f64b:function(e,t,n){},faa6:function(e,t,n){},faad:function(e,t,n){},fb23:function(e,t,n){"use strict";var i=n("4d0c"),r=n.n(i);r.a},ff89:function(e,t,n){"use strict";var i=n("1cd4"),r=n.n(i);r.a}});
//# sourceMappingURL=root.js.map