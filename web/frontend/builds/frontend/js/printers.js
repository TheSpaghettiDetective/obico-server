(function(e){function t(t){for(var i,o,s=t[0],c=t[1],l=t[2],u=0,f=[];u<s.length;u++)o=s[u],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&f.push(r[o][0]),r[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(e[i]=c[i]);d&&d(t);while(f.length)f.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,s=1;s<n.length;s++){var c=n[s];0!==r[c]&&(i=!1)}i&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var i={},r={printers:0},a=[];function o(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=i,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/static/frontend/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var d=c;a.push([6,"chunk-vendors"]),n()})({"020c":function(e,t,n){"use strict";var i=n("c2fe"),r=n.n(i);r.a},"0548":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("a026"),r=n("f357"),a=n("5f5b"),o=n("785f"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"option-drawer"},[n("div",{staticClass:"panel-group",attrs:{id:"accordion",role:"tablist","aria-multiselectable":"true"}},[n("div",{staticClass:"panel panel-default"},[n("b-collapse",{staticClass:"panel-collapse in",attrs:{id:"collapse-one",role:"tabpanel","aria-labelledby":"headingOne"},model:{value:e.filters.visible,callback:function(t){e.$set(e.filters,"visible",t)},expression:"filters.visible"}},[n("div",{staticClass:"panel-body p-3"},[n("div",[n("div",{staticClass:"sorting-and-filter"},[n("TSDSelect",{staticClass:"my-1 mx-2",attrs:{id:"printer-sorting",options:e.sortFilters},on:{input:function(t){return e.onSortFilterChanged()}},model:{value:e.filters.sort,callback:function(t){e.$set(e.filters,"sort",t)},expression:"filters.sort"}}),n("TSDSelect",{staticClass:"my-1 mx-2",attrs:{id:"printer-filtering",options:e.stateFilters},on:{input:function(t){return e.onStateFilterChanged()}},model:{value:e.filters.state,callback:function(t){e.$set(e.filters,"state",t)},expression:"filters.state"}})],1)]),n("hr"),n("div",e._l(e.visiblePrinters,(function(t){return n("a",{key:t.id,staticClass:"btn btn-outline-primary btn-sm my-1 mx-2 printer-link",attrs:{href:"#"+t.id,role:"button"}},[n("i",{staticClass:"fas fa-map-pin"}),e._v(" "+e._s(t.name)+" ")])})),0)])]),n("div",{staticClass:"panel-heading",attrs:{role:"tab",id:"headingOne"}},[n("div",{staticClass:"panel-title"},[n("button",{staticClass:"btn btn-block shadow-none",attrs:{role:"button"},on:{click:e.toggleFiltersPanel}},[n("i",{staticClass:"fas fa-angle-down"})])])])],1)])]),e.isProAccount?e._e():n("div",{staticClass:"row justify-content-center"},[e._m(0)]),n("div",{staticClass:"row justify-content-center",attrs:{id:"printers"}},[e.loading?n("b-spinner",{staticClass:"mt-5",attrs:{label:"Loading..."}}):e._e(),e._l(e.visiblePrinters,(function(t){return n("printer-card",{key:t.id,ref:"printer",refInFor:!0,attrs:{printer:t,"is-pro-account":e.isProAccount},on:{NotAFailureClicked:function(n){return e.onNotAFailureClicked(n,t.id,!1)},WatchForFailuresToggled:function(n){return e.onWatchForFailuresToggled(t.id)},PauseOnFailureToggled:function(n){return e.onPauseOnFailureToggled(t.id)},PrinterActionPauseClicked:function(n){return e.onPrinterActionPauseClicked(t.id)},PrinterActionResumeClicked:function(n){return e.onPrinterActionResumeClicked(n,t.id)},PrinterActionCancelClicked:function(n){return e.onPrinterActionCancelClicked(t.id)},PrinterActionConnectClicked:function(n){return e.onPrinterActionConnectClicked(t.id)},PrinterActionStartClicked:function(n){return e.onPrinterActionStartClicked(t.id)},PrinterActionControlClicked:function(n){return e.onPrinterActionControlClicked(t.id)},TempEditClicked:function(n){return e.onTempEditClicked(t.id,n)}}})}))],2),e._m(1),e.hiddenPrinterCount>0?n("div",{staticClass:"text-warning border-warning text-center border my-3 py-2",attrs:{id:"printers-hidden-warning"}},[n("span",{attrs:{id:"printers-hidden"}},[e._v(e._s(e.hiddenPrinterCount))]),e._v(" printers are hidden by the filtering settings. "),n("a",{attrs:{href:"#",id:"show-all-printers-btn"},on:{click:function(t){return e.onShowAllPrintersClicked()}}},[e._v("Show all printers >>>")])]):e._e()])},c=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"col-sm-12 col-lg-6"},[n("div",{staticClass:"form-container",staticStyle:{margin:"1em 0 -1em 0",padding:"0.5em 1em"}},[n("p",{staticStyle:{margin:"0"}},[e._v("Please consider "),n("a",{attrs:{href:"/ent/pricing?utm_source=tsd&utm_medium=printers-page"}},[e._v("upgrading")]),e._v(" to support our development efforts! "),n("a",{attrs:{href:"https://www.thespaghettidetective.com/docs/upgrade-to-pro/#what-cant-the-detective-just-work-for-free-people-love-free-you-know",target:"_new"}},[e._v("Why?")])])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"row justify-content-center"},[n("div",{staticClass:"col-sm-12 col-lg-6",attrs:{id:"new-printer"}},[n("div",{staticClass:"new-printer-container"},[n("a",{attrs:{href:"/printers/wizard/"}},[n("i",{staticClass:"fa fa-plus fa-2x"}),n("div",[e._v("Link OctoPrint Printer")])])])])])}],l=(n("99af"),n("4de4"),n("7db0"),n("c740"),n("4160"),n("d81d"),n("b0c0"),n("4fad"),n("159b"),n("fc11")),d=n("bc3a"),u=n.n(d),f=n("c1df"),p=n.n(f),v=n("49d5"),m=n.n(v),g=n("9b02"),h=n.n(g),b=n("c707"),w=n.n(b),y=n("5128"),_=n.n(y),C=n("9380"),k=n.n(C),S=n("3c33"),T=n("502a"),P=n("1807"),x=(n("4ec9"),n("d3b7"),n("ac1f"),n("25f0"),n("3ca3"),n("5319"),n("ddb0"),n("dce5")),A=n.n(x),D=n("aaa7"),O=n.n(D);function I(){var e={};function t(t){t.onclose=function(){e.wsList.forEach((function(n,i){n==t&&e.wsList.delete(i)}))},t.onerror=function(){t.close()}}function n(){e.wsList.forEach((function(e){e.close()}))}function r(e){e&&1===e.readyState&&(e.send(JSON.stringify({})),setTimeout((function(){r(e)}),3e4))}return e.desiredWsList=new Map,e.wsList=new Map,e.passthruQueue=new Map,O.a.on("blur",(function(){n()})),O.a.on("focus",(function(){e.desiredWsList.forEach((function(t,n){e.openPrinterWebSockets(n,t[0],t[1])}))})),e.openPrinterWebSockets=function(n,i,a){e.desiredWsList.set(n,[i,a]);var o=new WebSocket(window.location.protocol.replace("http","ws")+"//"+window.location.host+i);e.wsList.set(n,o),o.onmessage=function(t){var n=JSON.parse(t.data);if("passthru"in n){var i=n.passthru.ref;if(i&&e.passthruQueue.get(i)){var r=e.passthruQueue.get(i);e.passthruQueue.delete(i),r(null,n.passthru.ret)}}else a(n)},t(o),setTimeout((function(){r(o)}),3e4)},e.passThruToPrinter=function(t,n,r){var a=e.wsList.get(t);if(a){if(r){var o=Math.random().toString();e.passthruQueue.set(o,r),A()(n,{ref:o}),setTimeout((function(){e.passthruQueue.has(o)&&i["default"].swal.Toast.fire({type:"error",title:"Failed to contact OctoPrint, or the TSD plugin version is older than 1.2.0."})}),1e4)}a.send(JSON.stringify({passthru:n}))}else r&&r("Message not passed through. No suitable WebSocket.")},e}var E=I,R=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"col-sm-12 col-lg-6 printer-card",attrs:{id:e.printer.id}},[i("div",{staticClass:"card"},[i("div",{staticClass:"card-header"},[i("div",{staticClass:"title-box"},[e.hasCurrentPrintFilename?i("div",{staticClass:"primary-title print-filename"},[e._v(e._s(e.printer.current_print.filename))]):e._e(),i("div",{staticClass:"printer-name",class:{"secondary-title":e.hasCurrentPrintFilename}},[e._v(e._s(e.printer.name))])]),i("div",{staticClass:"dropdown"},[i("button",{staticClass:"btn icon-btn",attrs:{type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-label":e.printer.name+" Controls"}},[i("i",{staticClass:"fas fa-ellipsis-v"})]),i("div",{staticClass:"dropdown-menu dropdown-menu-right",attrs:{"aria-labelledby":"dropdownMenuButton"}},[i("a",{staticClass:"dropdown-item",attrs:{href:e.shareUrl()}},[i("i",{staticClass:"fas fa-share-alt fa-lg"}),e._v("Share ")]),i("a",{staticClass:"dropdown-item",attrs:{href:e.octoPrintTunnelUrl()}},[i("img",{staticClass:"menu-icon",attrs:{src:n("17d7")}}),e._v(" Tunneling ")]),i("div",{staticClass:"dropdown-divider"}),i("a",{staticClass:"dropdown-item",attrs:{href:e.settingsUrl()}},[i("i",{staticClass:"fas fa-wrench fa-lg"}),e._v("Configure ")])])])]),i("streaming-box",{attrs:{printer:e.printer,isProAccount:e.isProAccount}}),e.printer.alertUnacknowledged?i("div",{staticClass:"failure-alert card-body bg-warning px-2 py-1"},[i("i",{staticClass:"fas fa-exclamation-triangle align-middle"}),i("span",{staticClass:"align-middle"},[e._v("Failure Detected!")]),i("button",{staticClass:"btn btn-outline-primary btn-sm float-right",attrs:{type:"button",id:"not-a-failure"},on:{click:function(t){return e.$emit("NotAFailureClicked",t,e.printer.id)}}},[e._v("Not a failure?")])]):e._e(),i("div",{staticClass:"card-body gauge-container",class:{overlay:!e.isWatching}},[e.isWatching?e._e():i("div",{staticClass:"overlay-top text-center",staticStyle:{left:"50%","margin-left":"-102px",top:"50%","margin-top":"-15px"}},[i("div",{staticClass:"text-warning"},[e._v("The Detective Is Not Watching")]),e.printer.not_watching_reason?i("small",[e._v(e._s(e.printer.not_watching_reason)+". "),e._m(0)]):e._e(),i("div")]),i("Gauge",{attrs:{normalizedP:e.printer.normalized_p}}),i("hr")],1),i("PrinterActions",e._b({staticClass:"container",attrs:{id:"printer-actions"},on:{PrinterActionPauseClicked:function(t){return e.$emit("PrinterActionPauseClicked",t)},PrinterActionResumeClicked:function(t){return e.$emit("PrinterActionResumeClicked",t)},PrinterActionCancelClicked:function(t){return e.$emit("PrinterActionCancelClicked",t)},PrinterActionConnectClicked:function(t){return e.$emit("PrinterActionConnectClicked",t)},PrinterActionStartClicked:function(t){return e.$emit("PrinterActionStartClicked",t)},PrinterActionControlClicked:function(t){return e.$emit("PrinterActionControlClicked",t)}}},"PrinterActions",e.actionsProps,!1)),i("div",{staticClass:"info-section settings"},[i("button",{staticClass:"info-section-toggle btn btn-sm no-corner mx-2",class:{pressed:e.section_toggles.settings},attrs:{type:"button"},on:{click:function(t){return e.onSettingsToggleClicked()}}},[i("i",{staticClass:"fas fa-cog fa-lg"})]),i("button",{staticClass:"info-section-toggle btn btn-sm no-corner mx-2",class:{pressed:e.section_toggles.time},attrs:{type:"button"},on:{click:function(t){return e.onTimeToggleClicked()}}},[i("i",{staticClass:"fas fa-clock fa-lg"})]),i("button",{staticClass:"info-section-toggle btn btn-sm no-corner mx-2",class:{pressed:e.section_toggles.statusTemp},attrs:{type:"button"},on:{click:function(t){return e.onStatusTempToggleClicked()}}},[i("i",{staticClass:"fas fa-thermometer-half fa-lg"})])]),i("div",{staticClass:"info-section",staticStyle:{height:"0.3rem"}}),i("div",[i("div",{staticClass:"info-section container"},[e.section_toggles.settings?i("div",{attrs:{id:"panel-settings"}},[i("div",{staticClass:"pt-2 pb-3"},[i("div",{staticClass:"row justify-content-center px-3"},[i("div",{staticClass:"col-12 setting-item"},[i("label",{staticClass:"toggle-label",attrs:{for:"watching_enabled-toggle-"+e.printer.id}},[e._v("Watch for failures "),e.watchForFailures?e._e():i("div",{staticClass:"text-muted font-weight-light font-size-sm"},[e._v("Subsequent prints NOT watched until turned on. ")])]),i("div",{staticClass:"custom-control custom-switch"},[i("input",{staticClass:"custom-control-input update-printer",attrs:{type:"checkbox",name:"watching_enabled",id:"watching_enabled-toggle-"+e.printer.id},domProps:{checked:e.watchForFailures},on:{click:function(t){return e.$emit("WatchForFailuresToggled")}}}),i("label",{staticClass:"custom-control-label",staticStyle:{"font-size":"1rem"},attrs:{for:"watching_enabled-toggle-"+e.printer.id}})])])]),i("div",{staticClass:"row justify-content-center px-3"},[i("div",{staticClass:"col-12 setting-item"},[i("label",{staticClass:"toggle-label",attrs:{for:"pause-toggle-"+e.printer.id}},[e._v("Pause on detected failures "),e.pauseOnFailure?e._e():i("div",{staticClass:"text-muted font-weight-light font-size-sm"},[e._v("You will still be alerted via notifications ")])]),i("div",{staticClass:"custom-control custom-switch"},[i("input",{staticClass:"custom-control-input update-printer",attrs:{type:"checkbox",name:"pause_on_failure",id:"pause-toggle-"+e.printer.id},domProps:{checked:e.pauseOnFailure},on:{click:function(t){return e.$emit("PauseOnFailureToggled")}}}),i("label",{staticClass:"custom-control-label",staticStyle:{"font-size":"1rem"},attrs:{for:"pause-toggle-"+e.printer.id}})])])])])]):e._e(),e.section_toggles.time?i("div",{attrs:{id:"print-time"}},[i("div",{staticClass:"py-2"},[e._m(1),i("div",{staticClass:"row"},[e._m(2),i("duration-block",e._b({staticClass:"col-5 numbers",attrs:{id:"print-time-remaining"}},"duration-block",e.timeRemaining,!1)),i("duration-block",e._b({staticClass:"col-5 numbers",attrs:{id:"print-time-total"}},"duration-block",e.timeTotal,!1)),i("div",{staticClass:"col-12"},[i("div",{staticClass:"progress",staticStyle:{height:"2px"}},[i("div",{staticClass:"progress-bar",class:{"progress-bar-striped":e.progressPct<100,"progress-bar-animated":e.progressPct<100},style:"width: "+e.progressPct+"%;",attrs:{id:"print-progress",role:"progressbar","aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100"}})])])],1)])]):e._e(),e.section_toggles.statusTemp&&e.statusTempProps.show?i("StatusTemp",e._b({attrs:{id:"status_temp_block"},on:{TempEditClicked:function(t){return e.$emit("TempEditClicked",t)}}},"StatusTemp",e.statusTempProps,!1)):e._e()],1)])],1)])},j=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{attrs:{href:"https://www.thespaghettidetective.com/docs/detective-not-watching/",target:"_blank"}},[e._v("Learn more. "),n("small",[n("i",{staticClass:"fas fa-external-link-alt"})])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"row text-muted"},[n("small",{staticClass:"col-5 offset-2"},[e._v(" Remaining ")]),n("small",{staticClass:"col-5"},[e._v(" Total ")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"col-2 text-muted"},[n("i",{staticClass:"fas fa-clock"})])}],M=(n("b6802"),n("e9a7")),F=n.n(M),L=n("6868"),V=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card-img-top webcam_container"},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.slowLinkLoss>50,expression:"slowLinkLoss > 50"}],ref:"slowLinkWrapper",staticClass:"slow-link-wrapper",on:{click:e.slowLinkClicked,mouseenter:function(t){e.fixSlowLinkTextWidth(),e.slowLinkShowing=!0,e.slowLinkHiding=!1},mouseleave:function(t){e.fixSlowLinkTextWidth(),e.slowLinkShowing=!1,e.slowLinkHiding=!0}}},[e._m(0),n("div",{ref:"slowLinkText",staticClass:"text text-warning",class:{"show-and-hide":!e.slowLinkShowing&&!e.slowLinkHiding,showing:e.slowLinkShowing&&!e.slowLinkHiding,hiding:!e.slowLinkShowing&&e.slowLinkHiding}},[e._v("Video frames dropped")])]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.trackMuted,expression:"trackMuted"}],staticClass:"muted-status-wrapper"},[n("div",{staticClass:"text"},[e._v("Buffering...")]),n("a",{attrs:{href:"#"},on:{click:function(t){return e.showMutedStatusDescription(t)}}},[e._v("Why is it stuck?")])]),e.trackMuted||e.videoLoading?n("b-spinner",{staticClass:"loading-icon",attrs:{label:"Buffering..."}}):e._e(),e.isVideoVisible&&e.taggedImgAvailable?n("div",{staticClass:"streaming-switch"},[n("button",{staticClass:"btn btn-sm no-corner",class:{active:e.showVideo},attrs:{type:"button"},on:{click:function(t){return e.forceStreamingSrc("VIDEO")}}},[n("i",{staticClass:"fas fa-video"})]),n("button",{staticClass:"btn btn-sm no-corner ",class:{active:!e.showVideo},attrs:{type:"button"},on:{click:function(t){return e.forceStreamingSrc("IMAGE")}}},[n("i",{staticClass:"fas fa-camera"})])]):e._e(),n("div",{class:e.webcamRotateClass},[n("div",{staticClass:"webcam_fixed_ratio",class:e.webcamRatioClass},[n("div",{staticClass:"webcam_fixed_ratio_inner full"},[n("img",{staticClass:"tagged-jpg",class:{flipH:e.printer.settings.webcam_flipH,flipV:e.printer.settings.webcam_flipV},attrs:{src:e.taggedSrc,alt:e.printer.name+" current image"}})]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showVideo,expression:"showVideo"}],staticClass:"webcam_fixed_ratio_inner ontop full",attrs:{id:"webrtc-stream"}},[n("video",{ref:"video",staticClass:"remote-video",class:{hide:!e.isVideoVisible,flipH:e.printer.settings.webcam_flipH,flipV:e.printer.settings.webcam_flipV},attrs:{width:"960",height:e.webcamVideoHeight,poster:e.taggedSrc,autoplay:"",muted:"",playsinline:""},domProps:{muted:!0},on:{loadstart:function(t){return e.onLoadStart()},canplay:function(t){return e.onCanPlay()}}})])])])],1)},N=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"icon bg-warning"},[n("i",{staticClass:"fas fa-exclamation"})])}],$=n("c297");function B(e){var t={callbacks:e,streamId:void 0,streaming:void 0,connect:function(e,t){var n="streamingtest-"+$["a"].randomString(12),i=[{urls:["stun:stun.l.google.com:19302"]}];if(t){var r=window.location.hostname.replace("app","turn");i.push({urls:"turn:"+r+":80?transport=udp",credential:t,username:t}),i.push({urls:"turn:"+r+":80?transport=tcp",credential:t,username:t})}var a=this,o=new $["a"]({server:window.location.protocol.replace("http","ws")+"//"+window.location.host+e,iceServers:i,success:function(){o.attach({plugin:"janus.plugin.streaming",opaqueId:n,success:function(e){$["a"].log("Plugin attached! ("+e.getPlugin()+", id="+e.getId()+")");var t={request:"list"};$["a"].debug("Sending message ("+JSON.stringify(t)+")"),e.send({message:t,success:function(t){var n=h()(t,"list[0]");n&&(a.streamId=n.id,a.streaming=e,a.startStream())}}),setInterval((function(){console.log(e.getBitrate())}),5e3)},error:function(e){$["a"].error("  -- Error attaching plugin... ",e),o.destroy()},onmessage:function(e,t){a.onMessage(e,t)},onremotestream:function(e){a.onRemoteStream(e)},ontrackmuted:function(){a.onTrackMuted()},ontrackunmuted:function(){a.onTrackUnmuted()},slowLink:function(e,t){a.onSlowLink(t)},ondataopen:function(){},ondata:function(){},oncleanup:function(){a.onCleanup()}})},error:function(e){$["a"].error("  -- Error -- ",e),o.destroy()},destroyed:function(){a.streaming=void 0,a.streamId=void 0}})},onMessage:function(e,t){var n=this;$["a"].debug(" ::: Got a message :::"),$["a"].debug(e);var i=e["result"];if(null!==i&&void 0!==i){if(void 0!==i["status"]&&null!==i["status"]){var r=i["status"];"starting"===r?console.log("Starting"):"started"===r?console.log("Started"):"stopped"===r&&n.stopStream()}}else if(void 0!==e["error"]&&null!==e["error"])return $["a"].error(e),void n.stopStream();void 0!==t&&null!==t&&($["a"].debug("Handling SDP as well..."),$["a"].debug(t),n.streaming.createAnswer({jsep:t,media:{audioSend:!1,videoSend:!1,data:!0},success:function(e){$["a"].debug("Got SDP!"),$["a"].debug(e);var t={request:"start"};n.streaming.send({message:t,jsep:e})},error:function(e){$["a"].error("WebRTC error:",e)}}))},onRemoteStream:function(e){$["a"].debug(" ::: Got a remote stream :::"),$["a"].debug(e),this.callbacks.onRemoteStream(e)},onTrackMuted:function(){this.callbacks.onTrackMuted()},onTrackUnmuted:function(){this.callbacks.onTrackUnmuted()},onSlowLink:function(e){this.callbacks.onSlowLink(e)},onCleanup:function(){this.callbacks.onCleanup()},startStream:function(){if(void 0!==this.streamId&&void 0!==this.streaming){var e={request:"watch",id:parseInt(this.streamId)};this.streaming.send({message:e})}},stopStream:function(){if(void 0!==this.streamId&&void 0!==this.streaming){var e={request:"stop"};this.streaming.send({message:e}),this.streaming.hangup()}}};return t}var W,z={getWebRTCManager:B},U=n("6508"),q=n.n(U),G=function(e){return"/ws/janus/".concat(e,"/")},J=function(e){return"/ws/share_token/janus/".concat(e,"/")},H={name:"StreamingBox",created:function(){var e=this;this.webrtc=null,this.isProAccount&&$["a"].init({debug:"all",callback:this.onJanusInitalized}),O.a.on("blur",(function(){e.webrtc&&e.webrtc.stopStream()})),O.a.on("focus",(function(){e.webrtc&&e.webrtc.startStream()}))},props:{printer:{type:Object,required:!0},shareToken:{type:String,required:!1},isProAccount:{type:Boolean,required:!0}},data:function(){return{stickyStreamingSrc:null,isVideoVisible:!1,slowLinkLoss:0,slowLinkShowing:!1,slowLinkHiding:!1,trackMuted:!1,videoLoading:!1}},computed:{taggedImgAvailable:function(){return this.taggedSrc!==q.a},showVideo:function(){return this.isVideoVisible&&"IMAGE"!==this.stickyStreamingSrc},webcamRotateClass:function(){switch(this.printer.settings.webcam_rotate90){case!0:return"webcam_rotated";case!1:return"webcam_unrotated";default:return"webcam_unrotated"}},webcamRatioClass:function(){switch(this.printer.settings.ratio169){case!0:return"ratio169";case!1:return"ratio43";default:return"ratio43"}},webcamVideoHeight:function(){switch(this.printer.settings.ratio169){case!0:return 540;case!1:return 720;default:return 720}},taggedSrc:function(){return h()(this.printer,"pic.img_url",q.a)}},methods:{forceStreamingSrc:function(e){this.stickyStreamingSrc=e},onCanPlay:function(){this.videoLoading=!1},onLoadStart:function(){this.videoLoading=!0},openWebRTCForPrinter:function(){var e,t;this.shareToken?(e=J(this.shareToken),t=this.shareToken):(e=G(this.printer.id),t=this.printer.auth_token),this.webrtc.connect(e,t)},onJanusInitalized:function(){var e=this;$["a"].isWebrtcSupported()&&(this.webrtc=z.getWebRTCManager({onRemoteStream:this.onWebRTCRemoteStream,onCleanup:this.onWebRTCCleanup,onSlowLink:this.onSlowLink,onTrackMuted:function(){return e.trackMuted=!0},onTrackUnmuted:function(){return e.trackMuted=!1}}),this.openWebRTCForPrinter())},onWebRTCRemoteStream:function(e){$["a"].attachMediaStream(this.$refs.video,e);var t=e.getVideoTracks();null===t||void 0===t||0===t.length?this.isVideoVisible=!1:this.isVideoVisible=!0},onWebRTCCleanup:function(){this.isVideoVisible=!1},fixSlowLinkTextWidth:function(){var e=window.getComputedStyle(this.$refs.slowLinkText).width;this.$refs.slowLinkText.style.width=e},onSlowLink:function(e){this.slowLinkLoss+=e},slowLinkClicked:function(){this.slowLinkShowing=!1,this.slowLinkHiding=!1,this.slowLinkLoss=0,this.$swal({title:"Video frames dropped",html:"\n          <p>The video frames are getting dropped because there is a bandwidth bottleneck along the route it they take to travel from your Raspberry Pi to your computer. The bottleneck can be anywhere but in most cases <Text bold>it's either your computer's internet connection, or your Raspberry Pi's</Text>.</p>\n          <p>Make sure your computer is connected to the same network as your Pi. If you still see this warning, you need to trouble-shoot your computer's Wi-Fi connection, probably by moving closer to the Wi-Fi router.</p>\n          <p>If the webcam stream is smooth when your computer is on the same Wi-Fi network as your Pi, the bottleneck is likely with the upload speed of your internet connection. You need to run a speed test to make sure you have high-enough upload speed, as well as <b>low latency (ping)</b>.</p>\n          <p>Check out <a target=\"_blank\" href=\"https://www.thespaghettidetective.com/docs/webcam-feed-is-laggy/\">the step-by-step trouble-shooting guide.</a></p>\n        ",showCloseButton:!0})},showMutedStatusDescription:function(e){e.preventDefault(),this.$swal({title:"Webcam stream buffering",html:'\n          <p>When you see the messaging about webcam stream is "buffering" occassionaly, you can just reload the page. If this message repeatedly appears, it usually indicates a constricted video stream on <strong>your Raspberry Pi, not your computer</strong>.</p>\n          <p>The most common reasons are:</p>\n          <ul>\n            <li>Camera resolution is set too high.</li>\n            <li>Camera framerate is set too high. This is only when you set <a target="_blank" href="https://www.thespaghettidetective.com/docs/streaming-compatibility-mode/">the compatibility mode</a> to "always".</li>\n            <li>The upload speed of your Raspberry Pi is too low.</li>\n          </ul>\n          <br>\n          <p>You should leave the compatibility mode to "auto", unless you have <a target="_blank" href="https://www.thespaghettidetective.com/docs/streaming-compatibility-mode/#are-there-situations-when-i-want-to-always-stream-in-compatibility-mode">a good reason to it to "always".</a></p>\n          <p>As a rule of thumb, for every 300k-pixel resolution (640x480), you need to have 1.5Mbps upload bandwidth to stream smoothly at 25fps. This means if you set the webcam resolution to 1024x768 (~800k pixels), you need to have 4.5Mbps upload bandwidth. Also remember that the upload bandwidth of your Raspberry Pi may not be the same as your computer, even if they are connected to the same Wi-Fi network. This is because Raspberry Pi\'s Wi-Fi chip is weaker than the most computers\'.</p>\n        ',showCloseButton:!0})}}},Y=H,Q=(n("6d5e"),n("2877")),Z=Object(Q["a"])(Y,V,N,!1,null,"143153c5",null),K=Z.exports,X=function(e,t){if(null==e||0==e)return{valid:!1,printing:t};var n=p.a.duration(e,"seconds"),i=Math.floor(n.asHours()),r=n.minutes(),a=n.seconds();return{valid:!0,printing:t,hours:i,showHours:i>0,minutes:r,showMinutes:i>0||r>0,seconds:a,showSeconds:0==i&&0==r}},ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.valid||e.printing?e._e():n("span",[e._v("-")]),!e.valid&&e.printing?n("i",{staticClass:"fa fa-spinner"}):e._e(),e.valid&&e.showHours?n("span",[e._v(" "+e._s(e.hours)),n("span",{staticClass:"text-subscript text-muted"},[e._v("h")])]):e._e(),e.valid&&e.showMinutes?n("span",[e._v(" "+e._s(e.minutes)),n("span",{staticClass:"text-subscript text-muted"},[e._v("m")])]):e._e(),e.valid&&e.showSeconds?n("span",[e._v(" "+e._s(e.seconds)),n("span",{staticClass:"text-subscript text-muted"},[e._v("s")])]):e._e()])},te=[],ne=(n("a9e3"),{name:"DurationBlock",props:{valid:{type:Boolean,required:!0},printing:{type:Boolean,required:!0},hours:{type:Number,default:function(){return 0}},showHours:{type:Boolean,default:function(){return!1}},minutes:{type:Number,default:function(){return 0}},showMinutes:{type:Boolean,default:function(){return!1}},seconds:{type:Number,default:function(){return 0}},showSeconds:{type:Boolean,default:function(){return!1}}}}),ie=ne,re=Object(Q["a"])(ie,ee,te,!1,null,null,null),ae=re.exports,oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"row my-2"},[!e.printer.isOffline&&e.printer.hasError?n("div",{staticClass:"col-12 bg-danger text-center"},[n("div",[e._v("OctoPrint Error")]),n("div",[e._v(e._s(e.printer.status.state.text))])]):e._e(),e.printer.isOffline||e.printer.isDisconnected||e.printer.isIdle?e._e():n("div",{staticClass:"col-sm-6"},[e.printer.isPaused?n("button",{staticClass:"btn btn-block mt-2 btn-outline-success",attrs:{type:"button"},on:{click:function(t){return e.onPauseToggled(t)}}},[n("i",{staticClass:"fas fa-play"}),e._v(" Resume ")]):n("button",{staticClass:"btn btn-block mt-2 btn-outline-warning",attrs:{type:"button"},on:{click:function(t){return e.onPauseToggled(t)}}},[n("i",{staticClass:"fas fa-pause"}),e._v(" Pause ")])]),e.printer.isOffline||e.printer.isDisconnected||e.printer.isIdle?e._e():n("div",{staticClass:"col-sm-6"},[n("button",{staticClass:"btn btn-outline-danger btn-block mt-2 mb-2",attrs:{id:"print-cancel",type:"button"},on:{click:function(t){return e.$emit("PrinterActionCancelClicked",t)}}},[n("i",{staticClass:"fas fa-stop"}),e._v(" Cancel ")])]),e.printer.isOffline||e.printer.isDisconnected||!e.printer.isIdle?e._e():n("div",{staticClass:"col-sm-6"},[n("button",{staticClass:"btn btn-outline-primary btn-block mt-2",attrs:{id:"start-print",type:"button"},on:{click:function(t){return e.$emit("PrinterActionStartClicked",t)}}},[n("i",{staticClass:"fas fa-star"}),e._v(" Start Printing ")])]),e.printer.isOffline||e.printer.isDisconnected||!e.printer.isIdle?e._e():n("div",{staticClass:"col-sm-6"},[n("a",{staticClass:"btn btn-outline-secondary btn-block mt-2 mb-2",attrs:{type:"button",role:"button"},on:{click:function(t){return e.$emit("PrinterActionControlClicked",t)}}},[n("i",{staticClass:"fas fa-arrows-alt"}),e._v(" Control ")])]),!e.printer.isOffline&&e.printer.isDisconnected?n("div",{staticClass:"col-12 text-center py-2 text-warning"},[n("div",[e._v("Printer is not connected to OctoPrint.")]),n("button",{staticClass:"btn btn-outline-primary btn-block mt-2",attrs:{id:"connect-printer",type:"button",disabled:e.connecting},on:{click:this.onConnectClicked}},[e.connecting?n("b-spinner",{attrs:{type:"grow",small:""}}):n("i",{staticClass:"fab fa-usb"}),e._v(" Connect ")],1)]):e._e(),e.printer.isOffline?n("div",{staticClass:"col-12 text-center py-3 text-warning"},[e._m(0)]):e._e()])])},se=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._v(" OctoPrint is not powered on, or is offline. "),n("a",{attrs:{target:"_blank",href:"https://www.thespaghettidetective.com/docs/octoprint-is-offline/"}},[e._v("Why? "),n("small",[n("i",{staticClass:"fas fa-external-link-alt"})])])])}],ce={name:"PrinterActions",props:{printer:{}},data:function(){return{connectBtnClicked:!1}},computed:{connecting:function(){return this.connectBtnClicked&&this.printer.isDisconnected}},methods:{onPauseToggled:function(e){this.printer.isPaused?this.$emit("PrinterActionResumeClicked",e):this.$emit("PrinterActionPauseClicked",e)},onConnectClicked:function(e){var t=this;this.$emit("PrinterActionConnectClicked",e),this.connectBtnClicked=!0,setTimeout((function(){t.connectBtnClicked=!1}),1e4)}}},le=ce,de=Object(Q["a"])(le,oe,se,!1,null,null,null),ue=de.exports,fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"py-2"},[e._m(0),e._l(e.temperatures,(function(t){return n("div",{key:t.id,staticClass:"row"},[n("div",{staticClass:"col-2 numbers"},[n("span",{staticClass:"text-subscript text-muted"},[e._v(e._s(t.toolName))])]),n("div",{staticClass:"col-5 numbers"},[e._v(" "+e._s(t.actual)),n("span",{staticClass:"text-subscript text-muted"},[e._v("째C")])]),n("div",{staticClass:"col-5 numbers",attrs:{id:t.id},on:{click:function(n){return e.onEditClicked(t)}}},[e._v(e._s(t.target)),n("span",{staticClass:"text-subscript text-muted"},[e._v("째C")]),e.editable?n("span",[e._v(" "),n("i",{staticClass:"fas fa-pencil-alt",staticStyle:{"font-size":"0.6em"}})]):e._e()])])}))],2)},pe=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"row text-muted"},[n("div",{staticClass:"col-2"},[n("i",{staticClass:"fas fa-thermometer-half fa-lg"})]),n("small",{staticClass:"col-5"},[e._v(" Actual ")]),n("small",{staticClass:"col-5"},[e._v(" Target ")])])}],ve={name:"StatusTemp",props:{temperatures:{type:Array,required:!0},editable:{type:Boolean,required:!0}},methods:{onEditClicked:function(e){this.editable&&this.$emit("TempEditClicked",e)}}},me=ve,ge=Object(Q["a"])(me,fe,pe,!1,null,null,null),he=ge.exports,be=!0,we=!1,ye={Settings:"panel-settings",Time:"print-time",StatusTemp:"status_temp_block"},_e={name:"PrinterCard",components:{StreamingBox:K,Gauge:L["a"],DurationBlock:ae,PrinterActions:ue,StatusTemp:he},props:{printer:{type:Object,required:!0},isProAccount:{type:Boolean,required:!0}},data:function(){return{section_toggles:{settings:Object(S["a"])(ye.Settings+String(this.printer.id),be),time:Object(S["a"])(ye.Time+String(this.printer.id),we),statusTemp:Object(S["a"])(ye.StatusTemp+String(this.printer.id),be)}}},computed:{isWatching:function(){return!this.printer.not_watching_reason},timeRemaining:function(){return X(this.secondsLeft,this.printer.isPrinting)},timeTotal:function(){var e=null;return this.secondsPrinted&&this.secondsLeft&&(e=this.secondsPrinted+this.secondsLeft),X(e,this.printer.isPrinting)},secondsLeft:function(){return h()(this.printer,"status.progress.printTimeLeft")},secondsPrinted:function(){return h()(this.printer,"status.progress.printTime")},watchForFailures:function(){return this.printer.watching_enabled},pauseOnFailure:function(){return"PAUSE"==this.printer.action_on_failure},hasCurrentPrintFilename:function(){return!(!this.printer.current_print||!this.printer.current_print.filename)},actionsProps:function(){return{printer:this.printer}},progressPct:function(){return h()(this.printer,"status.progress.completion")},statusTempProps:function(){var e=this,t=void 0!=h()(this.printer,"settings.temp_profiles"),n=[],i=["bed","tool0","tool1"];return i.forEach((function(t){var i=h()(e.printer,"status.temperatures."+t);i&&(i.actual=parseFloat(i.actual).toFixed(1),i.target=Math.round(i.target),Object.assign(i,{toolName:F()(t)}),i.id=e.printer.id+"-"+t,i.key=t,n.push(i))})),{temperatures:n,show:n.length>0,editable:t}}},methods:{shareUrl:function(){return"/printers/".concat(this.printer.id,"/share/")},settingsUrl:function(){return"/printers/settings/?printerId=".concat(this.printer.id)},octoPrintTunnelUrl:function(){return"/tunnel/".concat(this.printer.id,"/")},onSettingsToggleClicked:function(){this.section_toggles.settings=!this.section_toggles.settings,Object(S["b"])(ye.Settings+String(this.printer.id),this.section_toggles.settings)},onTimeToggleClicked:function(){this.section_toggles.time=!this.section_toggles.time,Object(S["b"])(ye.Time+String(this.printer.id),this.section_toggles.time)},onStatusTempToggleClicked:function(){this.section_toggles.statusTemp=!this.section_toggles.statusTemp,Object(S["b"])(ye.StatusTemp+String(this.printer.id),this.section_toggles.statusTemp)}}},Ce=_e,ke=(n("2bb4"),Object(Q["a"])(Ce,R,j,!1,null,"c514449a",null)),Se=ke.exports,Te=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.searchText,expression:"searchText"}],staticClass:"form-control",attrs:{id:"myInput",type:"text",placeholder:"Search file name ..."},domProps:{value:e.searchText},on:{input:function(t){t.target.composing||(e.searchText=t.target.value)}}}),n("br"),n("div",[e._l(e.visibleGcodeFiles,(function(t){return n("div",{key:t.id,staticClass:"card"},[n("div",{staticClass:"card-body",staticStyle:{display:"flex","justify-content":"space-between"}},[n("div",{staticStyle:{width:"100%"}},[n("strong",{staticClass:"gcode-filename"},[e._v(" "+e._s(t.filename)+" ")]),n("small",{staticClass:"gcode-info mt-1",staticStyle:{display:"flex","flex-wrap":"wrap"}},[n("div",{staticClass:"pr-3"},[n("span",{staticClass:"text-muted"},[e._v("Size: ")]),e._v(" "+e._s(t.num_bytes))]),n("div",[n("span",{staticClass:"text-muted"},[e._v("Uploaded: ")]),e._v(" "+e._s(t.created_at))])])]),n("button",{staticClass:"send-print btn btn-primary",attrs:{type:"button",disabled:e.isSending},on:{click:function(n){return e.onSendPrintClicked(t.id)}}},[e._v("Print "),e.isSending?n("i",{staticClass:"fas fa-spinner fa-spin"}):e._e()])])])})),e._m(0)],2)])},Pe=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card"},[n("div",{staticClass:"card-body",staticStyle:{display:"flex","justify-content":"space-between"}},[n("a",{staticClass:"btn btn-primary btn-block",attrs:{type:"button",href:"/gcodes/"}},[n("i",{staticClass:"fas fa-upload"}),e._v(" Upload more G-Code ")])])])}],xe=(n("c975"),{name:"StartPrint",props:{gcodeFiles:{type:Array,required:!0},onGcodeFileSelected:{type:Function,required:!0},printerId:{type:Number,required:!0}},data:function(){return{searchText:"",isSending:!1}},computed:{visibleGcodeFiles:function(){var e=this.searchText.toLowerCase();return this.gcodeFiles.filter((function(t){return t.filename.toLowerCase().indexOf(e)>-1}))}},methods:{onSendPrintClicked:function(e){this.isSending=!0,this.onGcodeFileSelected(this.printerId,this.gcodeFiles,e)}}}),Ae=xe,De=Object(Q["a"])(Ae,Te,Pe,!1,null,null,null),Oe=De.exports,Ie=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._m(0),n("div",[n("b-form-select",{attrs:{id:"connect-port"},model:{value:e.selectedPort,callback:function(t){e.selectedPort=t},expression:"selectedPort"}},e._l(e.connectionOptions.ports,(function(t){return n("b-form-select-option",{key:t,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])})),1)],1),n("br"),e._m(1),n("div",[n("b-form-select",{attrs:{id:"connect-baudrate"},model:{value:e.selectedBaudrate,callback:function(t){e.selectedBaudrate=t},expression:"selectedBaudrate"}},[n("b-form-select-option",{attrs:{value:""}},[e._v(" Auto ")]),e._l(e.connectionOptions.baudrates,(function(t){return n("b-form-select-option",{key:t,attrs:{value:t}},[e._v(" "+e._s(t)+" ")])}))],2)],1)])},Ee=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h5",[e._v("Serial Port:")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h5",[e._v("Baudrate:")])])}],Re={name:"ConnectPrinter",props:{connectionOptions:{type:Object,required:!0}},data:function(){return{selectedPort:this.connectionOptions.ports[0],selectedBaudrate:""}}},je=Re,Me=Object(Q["a"])(je,Ie,Ee,!1,null,null,null),Fe=Me.exports,Le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"text-center"},[e.value>0?n("h1",{staticClass:"target-temp-degree"},[e._v(e._s(e.value)+" "),n("span",{staticClass:"text-subscript text-muted"},[e._v("째C")])]):e._e(),e.value<1?n("h1",{staticClass:"target-temp-degree"},[e._v("OFF")]):e._e()]),n("br"),n("div",{staticClass:"mb-5"},[e._m(0),n("div",[n("b-form-select",{attrs:{id:"id_preset"},on:{change:e.onPresetChanged},model:{value:e.preset,callback:function(t){e.preset=t},expression:"preset"}},e._l(e.allPresets,(function(t){return n("b-form-select-option",{key:t.value,attrs:{value:parseInt(t.value)}},[e._v(" "+e._s(t.title)+" ")])})),1)],1),n("br"),n("h5",[e._v("Manual:")]),n("div",[n("vue-slider",{attrs:{min:0,max:e.maxTemp,step:1,tooltip:"none"},on:{change:e.onSliderChanged},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],attrs:{id:"target-temp",type:"hidden"},domProps:{value:e.value},on:{input:function(t){t.target.composing||(e.value=t.target.value)}}})],1)])])},Ve=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h5",[e._v("Presets:")])])}],Ne=n("4971"),$e=n.n(Ne),Be={name:"TempTargetEditor",components:{VueSlider:$e.a},props:{presets:{type:Array,required:!0},maxTemp:{type:Number,required:!0},curTarget:{type:Number,required:!0}},data:function(){var e=this,t=this.presets.find((function(t){return t.target==e.curTarget}))||{target:0!=this.curTarget?-1:0};return{value:this.curTarget,preset:t.target}},computed:{allPresets:function(){var e=[];return e.push({value:-1,title:"Manual"}),e.push({value:0,title:"OFF"}),this.presets.forEach((function(t){e.push({value:t.target,title:"".concat(t.name," (").concat(t.target,"째C)")})})),e}},methods:{onPresetChanged:function(){this.preset>-1&&(this.value=this.preset)},onSliderChanged:function(){0==this.value?this.preset=0:this.preset=-1}}},We=Be,ze=Object(Q["a"])(We,Le,Ve,!1,null,null,null),Ue=ze.exports,qe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-dropdown",{attrs:{"toggle-class":"btn-light tsd-dropdown-toggle","menu-class":"tsd-dropdown-menu"},scopedSlots:e._u([{key:"button-content",fn:function(){return[n("div",{staticClass:"tsd-dropdown-selected-title"},[e._v(e._s(e.selected_title)+" "),e.selected.iconClass?n("i",{class:e.selected.iconClass}):e._e()])]},proxy:!0}])},e._l(e.options,(function(t){return n("b-dropdown-item",{key:t.value,attrs:{active:e.value==t.value,"active-class":"tsd-dropdown-active-item"},on:{click:function(n){return e.onOptionClicked(t)}}},[e._v(e._s(t.title)+" "),t.iconClass?n("i",{class:t.iconClass}):e._e()])})),1)},Ge=[],Je={name:"TSDSelect",props:["options","value"],methods:{onOptionClicked:function(e){this.$emit("input",e.value)}},computed:{selected:function(){var e=this;return this.options?this.options.find((function(t){return t.value==e.value})):null},selected_title:function(){var e=this.selected;return e.selected_title||e.title}}},He=Je,Ye=(n("b19e"),Object(Q["a"])(He,qe,Ge,!1,null,null,null)),Qe=Ye.exports,Ze="/pause_print/",Ke="/resume_print/",Xe="/cancel_print/",et="/mute_current_print/?mute_alert=true",tt="/acknowledge_alert/?alert_overwrite=NOT_FAILED",nt={Asc:"asc",Desc:"desc"},it={All:"all",OnlineOnly:"online",ActiveOnly:"active"},rt={DateAsc:"by-date-asc",DateDesc:"by-date-desc",NameAsc:"by-name-asc",NameDesc:"by-name-desc"},at=(W={},Object(l["a"])(W,nt.Asc,"fas fa-long-arrow-alt-up"),Object(l["a"])(W,nt.Desc,"fas fa-long-arrow-alt-down"),W),ot={StateFilter:"printer-filtering",SortFilter:"printer-sorting"},st=function(e,t,n){var i=Object.entries(e).find((function(e){return e[1]==t}));return i?i[1]:n},ct={name:"PrinterListPage",components:{PrinterCard:Se,TSDSelect:Qe},created:function(){this.printerWs=E(),this.StateFilter=it,this.SortFilter=rt,this.SortOrder=nt,this.stateFilters=[{value:it.All,title:"All Printers"},{value:it.OnlineOnly,title:"Online Printers Only"},{value:it.ActiveOnly,title:"Active Printers Only"}],this.sortFilters=[{value:rt.DateAsc,title:"Sort By Date",iconClass:at[nt.Asc]},{value:rt.DateDesc,title:"Sort By Date",iconClass:at[nt.Desc]},{value:rt.NameAsc,title:"Sort By Name",iconClass:at[nt.Asc]},{value:rt.NameDesc,title:"Sort By Name",iconClass:at[nt.Desc]}]},props:{isProAccount:{type:Boolean,required:!0}},data:function(){return{printers:[],loading:!0,filters:{visible:!1,state:st(it,Object(S["a"])(ot.StateFilter,it.All),it.All),sort:st(rt,Object(S["a"])(ot.SortFilter,rt.DateDesc),rt.DateDesc)}}},computed:{visiblePrinters:function(){var e=this.printers;switch(this.filters.state){case it.OnlineOnly:e=e.filter((function(e){return!e.isDisconnected}));break;case it.ActiveOnly:e=e.filter((function(e){return e.isPrinting}));break;case it.All:break}switch(this.filters.sort){case rt.DateAsc:e=w()(e,(function(e){return e.created_at}));break;case rt.DateDesc:e=_()(w()(e,(function(e){return e.created_at})));break;case rt.NameAsc:e=w()(e,(function(e){return e.name}));break;case rt.NameDesc:e=_()(w()(e,(function(e){return e.name})));break}return e},hiddenPrinterCount:function(){return this.printers.length-this.visiblePrinters.length}},methods:{fetchPrinters:function(){var e=this;return this.loading=!0,u.a.get(P["a"].printers(),{params:{with_archived:!0}}).then((function(t){e.loading=!1,t.data.forEach((function(t){t.archived_at?e.$swal.Toast.fire({html:'<br /><h6>Some of your printers have been archived.</h6><p><a href="/ent/printers/archived/">Find them here.</a></p>',timer:15e3}):e.insertPrinter(Object(T["c"])(t))}))}))},toggleFiltersPanel:function(){this.filters.visible=!this.filters.visible},onSortFilterChanged:function(){Object(S["b"])(ot.SortFilter,this.filters.sort),this.toggleFiltersPanel()},onStateFilterChanged:function(){Object(S["b"])(ot.StateFilter,this.filters.state),this.toggleFiltersPanel()},onShowAllPrintersClicked:function(){this.filters.state=it.All,Object(S["b"])(ot.StateFilter,this.filters.state)},onNotAFailureClicked:function(e,t,n){var i=this;this.$swal.Confirm.fire({title:"Noted!",html:'<p>Do you want The Detective to keep watching this print?</p><small>If you select "No", The Detective will stop watching this print, but will automatically resume watching on your next print.</small>',confirmButtonText:"Yes",cancelButtonText:"No"}).then((function(e){"cancel"==e.dismiss&&setTimeout((function(){i.sendPrinterAction(t,et,!1)}),1e3),n?i.sendPrinterAction(t,Ke,!0):i.sendPrinterAction(t,tt,!1)})),e.preventDefault()},onWatchForFailuresToggled:function(e){var t=this.printers.find((function(t){return t.id==e}));t&&(t.watching_enabled=!t.watching_enabled,this.updatePrinter(t))},onPauseOnFailureToggled:function(e){var t=this.printers.find((function(t){return t.id==e}));t&&(t.action_on_failure="PAUSE"==t.action_on_failure?"NONE":"PAUSE",this.updatePrinter(t))},onPrinterActionPauseClicked:function(e){var t=this;this.$swal.Confirm.fire({html:'If you haven\'t changed the default configuration, the heaters will be turned off, and the print head will be z-lifted. The reversed will be performed before the print is resumed. <a target="_blank" href="https://www.thespaghettidetective.com/docs/detection-print-job-settings/#when-print-is-paused">Learn more. <small><i class="fas fa-external-link-alt"></i></small></a>'}).then((function(n){n.value&&t.sendPrinterAction(e,Ze,!0)}))},onPrinterActionResumeClicked:function(e,t){var n=this.printers.find((function(e){return e.id==t}));n.alertUnacknowledged?this.onNotAFailureClicked(e,t,!0):this.sendPrinterAction(t,Ke,!0)},onPrinterActionCancelClicked:function(e){var t=this;this.$swal.Confirm.fire({text:"Once cancelled, the print can no longer be resumed."}).then((function(n){n.value&&t.sendPrinterAction(e,Xe,!0)}))},onPrinterActionConnectClicked:function(e){var t=this;this.printerWs.passThruToPrinter(e,{func:"get_connection_options",target:"_printer"},(function(n,i){n?t.$swal.Toast.fire({icon:"error",title:"Failed to connect!"}):i.ports.length<1?t.$swal.Toast.fire({icon:"error",title:"Uh-Oh. No printer is found on the serial port."}):t.$swal.openModalWithComponent(Fe,{connectionOptions:i},{confirmButtonText:"Connect",showCancelButton:!0,preConfirm:function(){return{port:document.getElementById("connect-port").value,baudrate:document.getElementById("connect-baudrate").value}}}).then((function(n){if(n.value){var i=[n.value.port,n.value.baudrate];t.printerWs.passThruToPrinter(e,{func:"connect",target:"_printer",args:i})}}))}))},onPrinterActionStartClicked:function(e){var t=this;if(this.isProAccount){var n=this.printers.find((function(t){return t.id==e}));u.a.get(P["a"].gcodes()).then((function(i){var r=i.data;r.forEach((function(e){e.created_at=p()(e.created_at).fromNow(),e.num_bytes=m()(e.num_bytes)})),t.$swal.openModalWithComponent(Oe,{printerId:e,gcodeFiles:r,onGcodeFileSelected:t.onGcodeFileSelected},{title:"Print on "+n.name,showConfirmButton:!1,showCancelButton:!0})}))}else this.$swal.fire({title:"Wait!",html:'\n              <h5 class="mb-3">You need to <a href="/ent/pricing/">upgrade to Pro plan</a> to start a remote print job. </h5>\n              <p>Remote G-Code upload and print start is a Pro feature.</p>\n              <p>With <a href="/ent/pricing/">little more than 1 Starbucks per month</a>, you can upgrade to a Pro account.</p>\n            '})},onGcodeFileSelected:function(e,t,n){var i=this,r=this.printers.find((function(t){return t.id==e}));this.printerWs.passThruToPrinter(e,{func:"download",target:"file_downloader",args:k()(t,{id:n})},(function(t,n){if(t||n.error)i.$swal.Toast.fire({icon:"error",title:t||n.error});else{var a=n.target_path,o='\n          <div class="text-center">\n            <i class="fas fa-spinner fa-spin fa-lg py-3"></i>\n            <h5 class="py-3">\n              Uploading G-Code to '.concat(r.name," ...\n            </h5>\n            <p>\n              ").concat(a,"\n            </p>\n          </div>");i.$swal.fire({html:o,showConfirmButton:!1});var s=function t(){var n=i.printers.find((function(t){return t.id==e}));"Operational"==h()(n,"status.state.text")?setTimeout(t,1e3):i.$swal.close()};s()}}))},onPrinterActionControlClicked:function(e){window.location=P["a"].printerControl(e)},onTempEditClicked:function(e,t){var n,i=this,r=this.printers.find((function(t){return t.id==e})),a=h()(r,"settings.temp_profiles",[]),o=350;"bed"==t.key?(n=a.map((function(e){return{name:e.name,target:e["bed"]}})),o=140):n=a.map((function(e){return{name:e.name,target:e["extruder"]}})),this.$swal.openModalWithComponent(Ue,{presets:n,maxTemp:o,curTarget:t.target},{title:"Set "+t.toolName+" Temperature",confirmButtonText:"Confirm",showCancelButton:!0,preConfirm:function(){return{target:parseInt(document.getElementById("target-temp").value)}}}).then((function(e){if(e.value){var n=e.value.target;i.printerWs.passThruToPrinter(r.id,{func:"set_temperature",target:"_printer",args:[t.key,n]})}}))},updatePrinter:function(e){var t=this;return u.a.patch(P["a"].printer(e.id),{watching_enabled:e.watching_enabled,action_on_failure:e.action_on_failure}).then((function(e){t.printers.map((function(t){return t.id==e.data.id?Object(T["c"])(e.data):t}))})).catch((function(e){console.log(e),t.$swal.Toast.fire({icon:"error",title:"Failed to update printer!"})}))},sendPrinterAction:function(e,t,n){var i=this;u.a.get(P["a"].printerAction(e,t)).then((function(){var e="";n&&(e+="<h6>Successfully sent command to OctoPrint!</h6><p>It may take a while to be executed by OctoPrint.</p>"),""!=e&&i.$swal.Toast.fire({icon:"success",html:e})}))},shouldVideoBeFull:function(e){var t=h()(e,"pic.img_url"),n=e.alertUnacknowledged&&t;return!n},insertPrinter:function(e){this.printers.push(e),this.openWSForPrinter(e)},reinsertPrinter:function(e){var t=this.printers.findIndex((function(t){return t.id==e.id}));t<0||this.$set(this.printers,t,e)},openWSForPrinter:function(e){var t=this,n=e.id,i=P["a"].printerWS(e.id);this.printerWs.openPrinterWebSockets(n,i,(function(e){t.reinsertPrinter(Object(T["c"])(e))}))}},mounted:function(){this.fetchPrinters()}},lt=ct,dt=(n("b01d"),Object(Q["a"])(lt,s,c,!1,null,null,null)),ut=dt.exports,ft=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"row justify-content-center"},[e.loading?i("b-spinner",{staticClass:"mt-5",attrs:{label:"Loading..."}}):e._e(),e.printer?i("div",{staticClass:"col-sm-12 col-lg-6 printer-card"},[i("div",{staticClass:"card"},[i("div",{staticClass:"card-header"},[i("div",[e._v(e._s(e.printer.name))])]),i("streaming-box",{attrs:{printer:e.printer,"is-pro-account":!0,shareToken:e.shareToken}}),i("div",{staticClass:"p-3 p-md-5"},[i("p",{staticClass:"text-center"},[e._v("You are viewing an awesome 3D print your friend shared specifically with you on")]),i("a",{attrs:{href:"https://www.thespaghettidetective.com/"}},[i("img",{staticClass:"logo-img",attrs:{src:n("8a45")}})]),i("hr"),i("br"),i("br"),i("a",{staticClass:"btn btn-block btn-primary",attrs:{href:"/accounts/signup/"}},[e._v("Get OctoPrint remote monitoring/access for FREE")])])],1)]):e._e()],1)])},pt=[],vt=(n("fb6a"),n("6625")),mt=n.n(vt),gt={name:"SharedPrinterPage",components:{StreamingBox:K},created:function(){this.printerWs=E(),this.webrtc=null,this.shareToken=mt()(window.location.pathname,"/").slice(-2,-1).pop()},data:function(){return{printer:null,shareToken:null,videoAvailable:{},loading:!0}},mounted:function(){var e=this,t=P["a"].printerSharedWS(this.shareToken);this.printerWs.openPrinterWebSockets(this.shareToken,t,(function(t){e.printer=Object(T["c"])(t),e.loading=!1}))}},ht=gt,bt=(n("262f"),Object(Q["a"])(ht,ft,pt,!1,null,null,null)),wt=bt.exports,yt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"row justify-content-center"},[n("div",{staticClass:"col-sm-11 col-md-10 col-lg-8"},[e.printer?n("div",{staticClass:"form-container"},[n("section",{staticClass:"settings"},[n("h2",{staticClass:"section-title"},[e._v("Settings")]),n("div",{staticClass:"form-group mb-4 mt-4"},[n("div",{staticClass:"form-label text-muted mb-2"},[e._v("Give your shiny new printer a name")]),n("saving-animation",{attrs:{errors:e.errorMessages.name,saving:e.saving.name}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.printer.name,expression:"printer.name"}],staticClass:"form-control field_required",attrs:{id:"id_name",type:"text",name:"name",maxlength:"200",placeholder:"",required:"required"},domProps:{value:e.printer.name},on:{input:function(t){t.target.composing||e.$set(e.printer,"name",t.target.value)}}})])],1),n("div",{staticClass:"failure-notification"},[n("div",{staticClass:"form-group mt-4 mb-4"},[n("div",{staticClass:"form-label text-muted"},[e._v("When a potential failure is detected:")]),n("saving-animation",{attrs:{errors:e.errorMessages.action_on_failure_NONE,saving:e.saving.action_on_failure_NONE}},[n("div",{staticClass:"custom-control custom-radio mt-1 radio"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.printer.action_on_failure,expression:"printer.action_on_failure"}],staticClass:"custom-control-input field_required",attrs:{type:"radio",name:"action_on_failure",id:"id_action_on_failure_0",value:"NONE"},domProps:{checked:e._q(e.printer.action_on_failure,"NONE")},on:{change:[function(t){return e.$set(e.printer,"action_on_failure","NONE")},function(t){return e.updateSetting("action_on_failure")}]}}),n("label",{staticClass:"custom-control-label",attrs:{for:"id_action_on_failure_0"}},[e._v("Just notify me")])])]),n("saving-animation",{attrs:{errors:e.errorMessages.action_on_failure_PAUSE,saving:e.saving.action_on_failure_PAUSE}},[n("div",{staticClass:"custom-control custom-radio mt-1 radio",attrs:{id:"action_on_failure_PAUSE"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.printer.action_on_failure,expression:"printer.action_on_failure"}],staticClass:"custom-control-input field_required",attrs:{type:"radio",name:"action_on_failure",id:"id_action_on_failure_1",value:"PAUSE"},domProps:{checked:e._q(e.printer.action_on_failure,"PAUSE")},on:{change:[function(t){return e.$set(e.printer,"action_on_failure","PAUSE")},function(t){return e.updateSetting("action_on_failure")}]}}),n("label",{staticClass:"custom-control-label",attrs:{for:"id_action_on_failure_1"}},[e._v("Pause the printer and notify me")])])])],1)]),n("div",{staticClass:"advanced"},[n("div",{staticClass:"accordion"},[n("div",{staticClass:"card",staticStyle:{border:"none"}},[e._m(0),n("div",{staticClass:"collapse",attrs:{id:"menuone"}},[n("div",{staticClass:"card-body p-0 pt-3"},[e._m(1),n("div",{staticClass:"form-group mt-4"},[n("div",{staticClass:"form-label text-muted"},[e._v("When print is paused,")]),n("saving-animation",{attrs:{errors:e.errorMessages.tools_off_on_pause,saving:e.saving.tools_off_on_pause}},[n("div",{staticClass:"custom-control custom-checkbox form-check-inline mt-2 checkbox"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.printer.tools_off_on_pause,expression:"printer.tools_off_on_pause"}],staticClass:"custom-control-input",attrs:{type:"checkbox",name:"tools_off_on_pause",id:"id_tools_off_on_pause"},domProps:{checked:Array.isArray(e.printer.tools_off_on_pause)?e._i(e.printer.tools_off_on_pause,null)>-1:e.printer.tools_off_on_pause},on:{change:[function(t){var n=e.printer.tools_off_on_pause,i=t.target,r=!!i.checked;if(Array.isArray(n)){var a=null,o=e._i(n,a);i.checked?o<0&&e.$set(e.printer,"tools_off_on_pause",n.concat([a])):o>-1&&e.$set(e.printer,"tools_off_on_pause",n.slice(0,o).concat(n.slice(o+1)))}else e.$set(e.printer,"tools_off_on_pause",r)},function(t){return e.updateSetting("tools_off_on_pause")}]}}),n("label",{staticClass:"custom-control-label",attrs:{for:"id_tools_off_on_pause"}},[e._v(" Turn off hotend heater(s) ")])])]),n("saving-animation",{attrs:{errors:e.errorMessages.bed_off_on_pause,saving:e.saving.bed_off_on_pause}},[n("div",{staticClass:"custom-control custom-checkbox form-check-inline mt-2 checkbox"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.printer.bed_off_on_pause,expression:"printer.bed_off_on_pause"}],staticClass:"custom-control-input",attrs:{type:"checkbox",name:"bed_off_on_pause",id:"id_bed_off_on_pause"},domProps:{checked:Array.isArray(e.printer.bed_off_on_pause)?e._i(e.printer.bed_off_on_pause,null)>-1:e.printer.bed_off_on_pause},on:{change:[function(t){var n=e.printer.bed_off_on_pause,i=t.target,r=!!i.checked;if(Array.isArray(n)){var a=null,o=e._i(n,a);i.checked?o<0&&e.$set(e.printer,"bed_off_on_pause",n.concat([a])):o>-1&&e.$set(e.printer,"bed_off_on_pause",n.slice(0,o).concat(n.slice(o+1)))}else e.$set(e.printer,"bed_off_on_pause",r)},function(t){return e.updateSetting("bed_off_on_pause")}]}}),n("label",{staticClass:"custom-control-label",attrs:{for:"id_bed_off_on_pause"}},[e._v(" Turn off bed heater ")])])]),n("saving-animation",{attrs:{errors:e.errorMessages.retract_on_pause,saving:e.saving.retract_on_pause}},[n("div",{staticClass:"form-inline my-1 checkbox-with-input"},[n("div",{staticClass:"custom-control custom-checkbox form-check-inline"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.retractFilamentByEnabled,expression:"retractFilamentByEnabled"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"retract-checkbox"},domProps:{checked:Array.isArray(e.retractFilamentByEnabled)?e._i(e.retractFilamentByEnabled,null)>-1:e.retractFilamentByEnabled},on:{change:function(t){var n=e.retractFilamentByEnabled,i=t.target,r=!!i.checked;if(Array.isArray(n)){var a=null,o=e._i(n,a);i.checked?o<0&&(e.retractFilamentByEnabled=n.concat([a])):o>-1&&(e.retractFilamentByEnabled=n.slice(0,o).concat(n.slice(o+1)))}else e.retractFilamentByEnabled=r}}}),n("label",{staticClass:"custom-control-label",attrs:{for:"retract-checkbox"}},[e._v("Retract filament by")])]),n("div",{staticClass:"input-group input-group-sm minimal-width"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.printer.retract_on_pause,expression:"printer.retract_on_pause"}],staticClass:"form-control field_required",attrs:{type:"number",name:"retract_on_pause",step:"0.5","aria-label":"Retraction ammount in millimeters",min:"0",id:"id_retract_on_pause",disabled:!e.retractFilamentByEnabled},domProps:{value:e.printer.retract_on_pause},on:{change:function(t){return e.updateSetting("retract_on_pause")},input:function(t){t.target.composing||e.$set(e.printer,"retract_on_pause",t.target.value)}}}),n("div",{staticClass:"input-group-append"},[n("span",{staticClass:"input-group-text"},[e._v("mm")])])])])]),n("saving-animation",{attrs:{errors:e.errorMessages.lift_z_on_pause,saving:e.saving.lift_z_on_pause}},[n("div",{staticClass:"form-inline my-1 checkbox-with-input"},[n("div",{staticClass:"custom-control custom-checkbox form-check-inline"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.liftExtruderByEnabled,expression:"liftExtruderByEnabled"}],staticClass:"custom-control-input",attrs:{type:"checkbox",id:"lift-z-checkbox"},domProps:{checked:Array.isArray(e.liftExtruderByEnabled)?e._i(e.liftExtruderByEnabled,null)>-1:e.liftExtruderByEnabled},on:{change:function(t){var n=e.liftExtruderByEnabled,i=t.target,r=!!i.checked;if(Array.isArray(n)){var a=null,o=e._i(n,a);i.checked?o<0&&(e.liftExtruderByEnabled=n.concat([a])):o>-1&&(e.liftExtruderByEnabled=n.slice(0,o).concat(n.slice(o+1)))}else e.liftExtruderByEnabled=r}}}),n("label",{staticClass:"custom-control-label",attrs:{for:"lift-z-checkbox"}},[e._v("Lift extruder along Z axis by")])]),n("div",{staticClass:"input-group input-group-sm minimal-width"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.printer.lift_z_on_pause,expression:"printer.lift_z_on_pause"}],staticClass:"form-control field_required",attrs:{type:"number",name:"lift_z_on_pause",step:"0.5","aria-label":"Lift Z Axis ammount in millimeters",min:"0",id:"id_lift_z_on_pause",disabled:!e.liftExtruderByEnabled},domProps:{value:e.printer.lift_z_on_pause},on:{change:function(t){return e.updateSetting("lift_z_on_pause")},input:function(t){t.target.composing||e.$set(e.printer,"lift_z_on_pause",t.target.value)}}}),n("div",{staticClass:"input-group-append"},[n("span",{staticClass:"input-group-text"},[e._v("mm")])])])])])],1),n("div",{staticClass:"form-group sensitivity my-4"},[n("div",{staticClass:"form-label text-muted"},[e._v("How sensitive do you want the Detective to be on this printer?")]),n("saving-animation",{attrs:{errors:e.errorMessages.detective_sensitivity,saving:e.saving.detective_sensitivity}},[n("div",{staticClass:"my-2 sensitivity-slider"},[n("input",{attrs:{id:"id_sensitivity",name:"detective_sensitivity","data-slider-id":"sensitivity-slider",type:"text","data-slider-min":"0.8","data-slider-max":"1.2","data-slider-step":"0.05","data-slider-value":e.printer.detective_sensitivity}})])]),n("div",{staticClass:"hint-low"},[e._v(" Low - I don't want a lot of false alarms. Only alert me when you are absolutely sure. ")]),n("div",{staticClass:"hint-medium"},[e._v(" Medium - A few false alarms won't bother me. But some well-disguised spaghetti will be missed. ")]),n("div",{staticClass:"hint-high"},[e._v(" High - Hit me with all the false alarms. I want to catch as many failures as possible. ")])],1)])])])])])]),e.extEndpointLength&&e.extEndpointLength>0?n("section",{staticClass:"mt-5"},[n("h2",{staticClass:"section-title"},[e._v("Integration")]),n("a",{staticClass:"btn btn-outline-primary my-2",attrs:{role:"button",type:"button",href:e.integrationUrl}},[e._v(e._s(this.printer.service_token?"Change/Remove 3D Geeks push notification":"Set up 3D Geeks push notification"))]),e._m(2),n("small",{staticClass:"text-muted font-italic"},[e._v("Disclaimer: 3D Geeks is not affiliated with The Spaghetti Detective.")])]):e._e(),n("section",{staticClass:"danger mt-5"},[n("h2",{staticClass:"section-title"},[e._v("Danger Zone")]),n("div",{staticClass:"mt-4"},[n("a",{staticClass:"btn btn-outline-secondary",attrs:{href:e.printerWizardUrl}},[e._v(" Re-Link OctoPrint ")]),e._m(3)]),n("div",{staticClass:"mt-4"},[n("button",{staticClass:"btn btn-outline-danger",on:{click:e.deletePrinter}},[e._v(" Delete Printer ")]),e._m(4)])])]):n("div",{staticClass:"text-center"},[n("b-spinner",{staticClass:"mt-5",attrs:{label:"Loading..."}})],1)])])},_t=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"card-header"},[n("a",{staticClass:"card-link btn-block",attrs:{"data-toggle":"collapse",href:"#menuone","aria-expanded":"false","aria-controls":"menuone"}},[e._v(" Advanced Settings "),n("span",{staticClass:"collapsed"},[n("p",[n("b",[e._v(">")])])]),n("span",{staticClass:"expanded"},[n("p",[n("b",[e._v("<")])])])])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("p",{staticClass:"text-warning"},[n("i",{staticClass:"fas fa-exclamation-triangle"}),e._v(" If you are not sure about the settings below, leave the default values to minimize surprises. ")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mt-2"},[e._v("3D Geeks mobile app can be downloaded "),n("a",{attrs:{href:"https://www.3dgeeks.app/u/tsd-android"}},[e._v("here")]),e._v(".")])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"text-muted mt-1"},[n("small",[e._v('If your OctoPrint is always showing as "offline", and you have gone through '),n("a",{attrs:{href:"https://www.thespaghettidetective.com/docs/octoprint-is-offline/"}},[e._v("all the trouble-shooting steps")]),e._v(", you can try to re-link OctoPrint as the last resort.")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"text-muted mt-1"},[n("small",[e._v("Bye-bye printer. See you next time!")])])}],Ct=(n("841c"),n("2b3d"),n("0122")),kt=n("3a2b"),St=n.n(kt),Tt=n("cb3d"),Pt={components:{SavingAnimation:Tt["a"]},props:{extEndpointLength:{type:Number}},data:function(){return{printer:null,printerId:"",saving:{},errorMessages:{},delayedSubmit:{name:{delay:1e3,timeoutId:null},retract_on_pause:{delay:1e3,timeoutId:null},lift_z_on_pause:{delay:1e3,timeoutId:null}}}},computed:{retractFilamentByEnabled:{get:function(){return this.printer.retract_on_pause>0},set:function(e){this.printer.retract_on_pause=e?6.5:0,this.updateSetting("retract_on_pause")}},liftExtruderByEnabled:{get:function(){return this.printer.lift_z_on_pause>0},set:function(e){this.printer.lift_z_on_pause=e?2.5:0,this.updateSetting("lift_z_on_pause")}},integrationUrl:function(){return"/printers/".concat(this.printerId,"/integration/")},printerWizardUrl:function(){return P["a"].printerWizard(this.printer.id)},printerName:{get:function(){return this.printer?this.printer.name:null},set:function(e){this.printer.name=e}}},watch:{printerName:function(e,t){null!==t&&this.updateSetting("name")}},mounted:function(){var e=this;this.printerId=new URLSearchParams(window.location.search).get("printerId"),this.fetchPrinter().then((function(){var t=new St.a("#id_sensitivity",{formatter:function(e){return e<.95?"Low":e>1.05?"High":"Medium"}});t.on("slideStop",e.saveSensitivity),t.on("change",e.updateSensitivityHint),e.updateSensitivityHint()}))},methods:{fetchPrinter:function(){var e=this;return u.a.get(P["a"].printer(this.printerId)).then((function(t){e.printer=Object(T["c"])(t.data)}))},patchPrinter:function(e,t){var n=this,i=this.getSettingsItemInput(e,t);return this.setSavingStatus(i,!0),u.a.patch(P["a"].printer(this.printerId),Object(l["a"])({},e,t)).catch((function(e){if(e.response&&e.response.data&&"object"===Object(Ct["a"])(e.response.data))if(e.response.data.non_field_errors)n.errorAlert(e.response.data.non_field_errors);else for(var t in e.response.data)n.errorMessages[i]=e.response.data[t];else n.errorAlert()})).then((function(){n.setSavingStatus(i,!1)}))},errorAlert:function(){this.$swal.Toast.fire({icon:"error",html:'<div>Can not update printer settings.</div><div>Get help from <a href="https://discord.com/invite/NcZkQfj">TSD discussion forum</a> if this error persists.</div>'})},updateSetting:function(e){var t=this;if(e in this.delayedSubmit){var n=this.delayedSubmit[e];return n["timeoutId"]&&clearTimeout(n["timeoutId"]),void(this.delayedSubmit[e]["timeoutId"]=setTimeout((function(){t.patchPrinter(e,t.printer[e])}),n["delay"]))}this.patchPrinter(e,this.printer[e])},saveSensitivity:function(e){this.printer.detective_sensitivity=e,this.updateSetting("detective_sensitivity")},updateSensitivityHint:function(){var e=document.querySelectorAll(".sensitivity div[class^=hint]");[].forEach.call(e,(function(e){e.style.display="none"}));var t=parseFloat(document.querySelector("#id_sensitivity").value);t<.95?document.querySelector(".sensitivity .hint-low").style.display="block":t>1.05?document.querySelector(".sensitivity .hint-high").style.display="block":document.querySelector(".sensitivity .hint-medium").style.display="block"},deletePrinter:function(){var e=this;this.$swal.Confirm.fire().then((function(t){t.value&&(window.location.href="/printers/".concat(e.printerId,"/delete/"))}))},getSettingsItemInput:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";switch(e){case"action_on_failure":return"".concat(e,"_").concat(t);default:return"".concat(e)}},setSavingStatus:function(e,t){t&&delete this.errorMessages[e],this.$set(this.saving,e,t)}}},xt=Pt,At=(n("c7db"),Object(Q["a"])(xt,yt,_t,!1,null,"6b74d2b6",null)),Dt=At.exports,Ot=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-12 col-lg-10 wizard-container"},[e.verifiedPrinter?i("div",{staticClass:"text-center py-5"},[i("img",{attrs:{src:n("5490")}}),i("h2",[e._v(e._s(e.verifiedPrinter.name))]),i("div",{staticClass:"lead"},[e._v("Successfully linked to your account!")]),i("br"),i("br"),i("div",{staticClass:"col-sm-12 col-md-8 offset-md-2 col-lg-6 offset-lg-3 d-flex flex-column align-center justify-content-center"},[e._m(0),e._m(1),e._m(2),i("div",{staticClass:"mt-4"},[i("a",{staticClass:"btn btn-outline-secondary btn-block mx-auto btn",attrs:{href:e.editPrinterUrl}},[e._v("Change Printer Settings")])]),e._m(3)])]):i("div",[i("form-wizard",{attrs:{color:e.theme.primary,"step-size":"sm"},scopedSlots:e._u([{key:"footer",fn:function(t){return[i("div",{staticClass:"wizard-footer-left"},[t.activeTabIndex>0?i("wizard-button",{staticClass:"btn btn-link btn-back",nativeOn:{click:function(n){t.prevTab(),e.prevTab()}}},[e._v("< Back")]):e._e()],1),i("div",{staticClass:"wizard-footer-right"},[t.isLastStep?e._e():i("wizard-button",{staticClass:"wizard-footer-right wizard-btn",style:t.fillButtonStyle,nativeOn:{click:function(n){t.nextTab(),e.nextTab()}}},[e._v("Next >")])],1)]}}])},[i("h2",{attrs:{slot:"title"},slot:"title"},[i("img",{staticClass:"header-img",attrs:{src:n("223c")}}),e._v(" "+e._s(e.title)+" ")]),e.printerIdToLink?i("tab-content",{attrs:{title:"Open Plugin Settings"}},[i("div",{staticClass:"container"},[i("div",{staticClass:"row justify-content-center pb-3"},[i("div",{staticClass:"col-sm-12 col-lg-8"},[i("div",{staticClass:"text-warning"},[e._v(" Warning: Re-Linking OctoPrint should be your last resort to solve issues. Please make sure you have exhausted all options on "),i("a",{attrs:{href:"https://www.thespaghettidetective.com/help/"}},[e._v("TSD's help website")]),e._v(". ")]),i("ol",[i("li",[e._v("Open OctoPrint in another browser tab. ")]),i("li",[e._v("Select "),i("em",[e._v('"OctoPrint settings menu  Access Anywhere - The Spaghetti Detective"')]),e._v(".")]),i("li",[e._v("Select "),i("em",[e._v('"Troubleshooting  Re-run Wizard"')]),e._v(".")])])])]),i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-12 col-lg-8 img-container"},[i("img",{staticClass:"mx-auto",attrs:{src:n("754e")}})])])])]):i("tab-content",{attrs:{title:"Install Plugin"}},[i("div",{staticClass:"container"},[i("div",{staticClass:"row justify-content-center pb-3"},[i("div",{staticClass:"col-sm-12 col-lg-8"},[i("ol",[i("li",[e._v("Open OctoPrint in another browser tab. ")]),i("li",[e._v("Select "),i("em",[e._v('"OctoPrint settings menu  Plugin Manager  Get More..."')]),e._v(".")]),i("li",[e._v('Enter "The Spaghetti Detective" to locate the plugin. Click '),i("em",[e._v('"Install"')]),e._v(".")]),i("li",[e._v("Restart OctoPrint when prompted.")])])])]),i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-12 col-lg-8 img-container"},[i("img",{staticClass:"mx-auto screenshot",attrs:{src:n("842d")},on:{click:function(t){return e.zoomIn(t)}}})])])])]),i("tab-content",{attrs:{title:"Plugin Wizard"}},[i("div",{staticClass:"container"},[i("div",{staticClass:"row justify-content-center pb-3"},[i("div",{staticClass:"col-sm-12 col-lg-8"},[i("ol",[i("li",[e._v("Wait for "),i("em",[e._v('"Access Anywhere - The Spaghetti Detective"')]),e._v(" wizard to popup.")]),i("li",[e._v("Follow the instructions in the wizard.")]),i("li",[e._v("Select "),i("em",[e._v('"Web Setup"')]),e._v(" when asked.")])])])]),i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-12 col-lg-8 img-container"},[i("img",{staticClass:"mx-auto screenshot",attrs:{src:n("ebff")},on:{click:function(t){return e.zoomIn(t)}}})])])])]),i("tab-content",{attrs:{title:"Enter Code"}},[i("div",{staticClass:"container"},[i("div",{staticClass:"row justify-content-center pb-3"},[i("div",{staticClass:"col-sm-12 col-lg-8  d-flex flex-column align-items-center"},[i("input",{ref:"code",staticClass:"code-btn",attrs:{disabled:""},domProps:{value:""+(e.verificationCode&&e.verificationCode.code)}}),i("small",{staticClass:"mx-auto py-1",class:{"text-muted":!e.copied}},[e._v(e._s(e.copied?"Code copied to system clipboard":"Ctrl-C/Cmd-C to copy the code"))]),i("div",{staticClass:"mx-auto pt-1 pb-4"},[i("span",{staticClass:"text-muted"},[e._v("Code expires in ")]),e._v(e._s(e.timeToExpire))]),i("div",{staticClass:"lead"},[e._v("Enter the "),i("strong",[e._v("6-digit verification code")]),e._v(" in the plugin")])])]),i("div",{staticClass:"row justify-content-center"},[i("div",{staticClass:"col-sm-12 col-lg-8 img-container"},[i("img",{staticClass:"screenshot",attrs:{src:n("5f18")},on:{click:function(t){return e.zoomIn(t)}}}),i("div",{staticClass:"helper mx-auto py-2"},[i("a",{staticClass:"link font-weight-bold",on:{click:e.showVerificationCodeHelpModal}},[e._v("Can't find the page to enter the 6-digit code?")])])])])])])],1),e._m(4)],1)])])},It=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mt-4"},[n("a",{staticClass:"btn-primary btn-block mx-auto btn btn-lg",attrs:{href:"/printers/"}},[e._v("Go Check Out Printer Feed!")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mt-5"},[n("a",{staticClass:"btn btn-outline-secondary btn-block mx-auto btn",attrs:{href:"/user_preferences/"}},[e._v("Add Phone Number")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"text-muted mx-auto text-center font-weight-light"},[e._v("So that The Detective can send you text (SMS) on print failures.")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"text-muted mx-auto text-center font-weight-light"},[e._v("You can always change it later.")])])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"row"},[n("div",{staticClass:"helper col-sm-12"},[e._v("Need help? Check out the "),n("a",{attrs:{href:"https://www.thespaghettidetective.com/docs/octoprint-plugin-setup/"}},[e._v("step-by-step set up guide.")])])])}],Et=n("2ee4"),Rt=(n("da93"),n("99b8")),jt=n.n(Rt),Mt={components:{FormWizard:Et["FormWizard"],TabContent:Et["TabContent"],WizardButton:Et["WizardButton"]},data:function(){return{theme:jt.a,verificationCode:null,verifiedPrinter:null,onVerificationStep:!1,copied:!1}},computed:{printerIdToLink:function(){return new URLSearchParams(window.location.search.substring(1)).get("printerId")},title:function(){return this.printerIdToLink?"Re-Link OctoPrint":"Link OctoPrint"},editPrinterUrl:function(){return"/printers/".concat(this.verifiedPrinter)},expiryMoment:function(){return this.verificationCode?p()(this.verificationCode.expired_at):null},timeToExpire:function(){return this.expiryMoment?p.a.duration(this.expiryMoment.diff(p()())).humanize():"-"}},methods:{prevTab:function(){document.querySelector(".wizard-nav.wizard-nav-pills li.active .wizard-icon-circle").classList.remove("checked"),this.onVerificationStep="step-PluginWizard1"===document.querySelector(".wizard-nav.wizard-nav-pills li.active .wizard-icon-circle").id},nextTab:function(){var e=this;if(document.querySelector(".wizard-nav.wizard-nav-pills li.active .wizard-icon-circle").classList.add("checked"),this.onVerificationStep="step-PluginWizard1"===document.querySelector(".wizard-nav.wizard-nav-pills li.active .wizard-icon-circle").id,this.onVerificationStep){this.codeInterval||(this.getVerificationCode(),this.codeInterval=setInterval((function(){e.getVerificationCode()}),5e3));var t=this.copyCode,n=!1,i=17,r=91,a=67;document.addEventListener("keydown",(function(e){e.keyCode!=i&&e.keyCode!=r||(n=!0)})),document.addEventListener("keyup",(function(e){e.keyCode!=i&&e.keyCode!=r||(n=!1)})),document.addEventListener("keydown",(function(e){n&&e.keyCode==a&&t()}))}},url:function(){var e=P["a"].verificationCode();return this.verificationCode?this.verificationCode.verified_at||p()().isBefore(this.expiryMoment)?"".concat(e).concat(this.verificationCode.id,"/"):e:this.printerIdToLink?"".concat(e,"?printer_id=").concat(this.printerIdToLink):e},copyCode:function(){if(this.onVerificationStep){var e=document.createElement("textarea");e.value=this.verificationCode.code,e.style.top="0",e.style.left="0",e.style.position="fixed",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy"),this.copied=!0}catch(t){console.error("Fallback: Oops, unable to copy",t)}document.body.removeChild(e)}},getVerificationCode:function(){var e=this;u.a.get(this.url()).then((function(t){t.data&&t.data&&(e.verificationCode=t.data,e.verificationCode.verified_at&&(e.verifiedPrinter=t.data.printer))}))},showVerificationCodeHelpModal:function(){this.$swal.fire({title:"Can't find the page to enter the 6-digit code?",html:'<p>The 6-digit code needs to be entered in The Spaghetti Detective plugin in OctoPrint. There are a few reasons why you can\'t find this page:</p>\n        <p><ul>\n        <li style="margin: 10px 0;">You don\'t have the plugin installed or you haven\'t restarted OctoPrint after installation. Click <a href="/printers/wizard/">here</a> to walk through the process again.</li>\n        <li style="margin: 10px 0;">The installed plugin is on a version earlier than 1.5.0. You need to upgrade the plugin to <b>1.5.0</b> or later.</li>\n        <li style="margin: 10px 0;">If for some reason you can\'t upgrade the plugin, follow <a href="/printers/new/">the old process</a> to link OctoPrint.</li>\n        <li style="margin: 10px 0;">Still no dice? Check out the step-by-step <a href="https://www.thespaghettidetective.com/docs/octoprint-plugin-setup/">set up guide</a>.</li>\n        </ul></p>',customClass:{container:"dark-backdrop"}})},zoomIn:function(e){e.target.classList.toggle("zoomedIn")}}},Ft=Mt,Lt=(n("be59"),n("020c"),Object(Q["a"])(Ft,Ot,It,!1,null,"2b31dd41",null)),Vt=Lt.exports;Object(o["a"])(i["default"]),i["default"].use(a["a"]),i["default"].use(r["a"]),document.getElementById("printer-list-mount")&&new i["default"]({components:{PrinterListPage:ut}}).$mount("#printer-list-mount"),document.getElementById("shared-printer-mount")&&new i["default"]({components:{SharedPrinterPage:wt}}).$mount("#shared-printer-mount"),document.getElementById("printer-settings-mount")&&new i["default"]({components:{PrinterSettingsPage:Dt}}).$mount("#printer-settings-mount"),document.getElementById("printer-wizard-mount")&&new i["default"]({components:{PrinterWizardPage:Vt}}).$mount("#printer-wizard-mount")},"17d7":function(e,t,n){e.exports=n.p+"img/octoprint-tunnel.png"},1807:function(e,t,n){"use strict";n("99af");t["a"]={printShotFeedback:function(e,t){return"/api/v1/printshotfeedbacks/".concat(e,"/?print_id=").concat(t)},print:function(e){return"/api/v1/prints/".concat(e,"/")},prints:function(){return"/api/v1/prints/"},printsBulkDelete:function(){return"/api/v1/prints/bulk_delete/"},printAlertOverwrite:function(e){return"/api/v1/prints/".concat(e,"/alert_overwrite/")},printers:function(){return"/api/v1/printers/"},printer:function(e){return"/api/v1/printers/".concat(e,"/")},printerAction:function(e,t){return"/api/v1/printers/".concat(e).concat(t)},pubPrinter:function(){return"/api/v1p/printer/"},gcodes:function(){return"/api/v1/gcodes/"},tunnelUsage:function(){return"/api/v1/tunnelusage/"},verificationCode:function(){return"/api/v1/onetimeverificationcodes/"},user:function(){return"/api/v1/users/me/"},printerControl:function(e){return"/printers/".concat(e,"/control/")},printerWS:function(e){return"/ws/web/".concat(e,"/")},printerSharedWS:function(e){return"/ws/share_token/web/".concat(e,"/")},printerWizard:function(e){return"/printers/wizard/?printerId=".concat(e)}}},"1e83":function(e,t,n){},"223c":function(e,t,n){e.exports=n.p+"img/octo-inverted.png"},"262f":function(e,t,n){"use strict";var i=n("c114"),r=n.n(i);r.a},"2bb4":function(e,t,n){"use strict";var i=n("a78b"),r=n.n(i);r.a},3477:function(e,t,n){},3878:function(e,t,n){"use strict";var i=n("e18c"),r=n.n(i);r.a},"3c33":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var i=function(e,t){var n=localStorage.getItem(e)||t;try{return JSON.parse(n)}catch(i){return n}},r=function(e,t){return localStorage.setItem(e,t)}},"502a":function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return d}));n("caad"),n("b0c0"),n("d3b7"),n("25f0"),n("2532");var i=n("c1df"),r=n.n(i),a=n("9b02"),o=n.n(a),s=function(e){return e?r()(e):null},c=function(e){return e.ended_at=s(e.cancelled_at||e.finished_at),e.started_at=s(e.started_at),e.uploaded_at=s(e.uploaded_at),e.has_alerts=Boolean(e.alerted_at),e},l=function(e){return e.name=e.name||"Printer #"+e.id.toString(),e.created_at=s(e.created_at),e.isOffline=null===o()(e,"status",null),e.isPaused=o()(e,"status.state.flags.paused",!1),e.isIdle="Operational"===o()(e,"status.state.text",""),e.isDisconnected=o()(e,"status.state.flags.closedOrError",!0),e.isPrinting=!e.isDisconnected&&"Operational"!==o()(e,"status.state.text",""),e.hasError=o()(e,"status.state.flags.error")||o()(e,"status.state.text","").toLowerCase().includes("error"),e.alertUnacknowledged=o()(e,"current_print.alerted_at")&&r()(o()(e,"current_print.alerted_at")).isAfter(r()(o()(e,"current_print.alert_acknowledged_at")||0)),e},d=function(e,t){var n=Math.round(e.length*t);return o()(e[n],"fields.normalized_p",0)}},5490:function(e,t,n){e.exports=n.p+"img/checkmark.png"},"5f18":function(e,t,n){e.exports=n.p+"img/plugin_verification_code.png"},6:function(e,t,n){e.exports=n("0548")},6295:function(e,t,n){"use strict";var i=n("3477"),r=n.n(i);r.a},6508:function(e,t,n){e.exports=n.p+"img/3d_printer.png"},6868:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tsd-gauge-container"},[n("span",{style:{color:e.titleColor},attrs:{id:"title"}},[e._v(e._s(e.titleText))]),n("div",{staticClass:"tsd-gauge"},[n("radial-gauge",{attrs:{value:e.value,options:e.options}})],1),n("hr")])},r=[],a=(n("a9e3"),n("7489")),o={name:"Gauge",components:{RadialGauge:a["a"]},data:function(){return{}},props:{normalizedP:{type:Number},options:{type:Object,default:function(){return{valueDec:0,valueInt:0,width:240,height:240,units:!1,box:!1,minValue:0,maxValue:100,majorTicks:["","","",""],minorTicks:4,highlights:[{from:0,to:33,color:"#5cb85c"},{from:33,to:67,color:"#f0ad4e"},{from:67,to:100,color:"#d9534f"}],colorPlate:"rgba(255,255,255,.0)",colorTitle:"#5cb85c",colorStrokeTicks:"#EBEBEB",colorNeedleStart:"rgba(240, 128, 128, 1)",colorNneedleEnd:"rgba(255, 160, 122, .9)",valueBox:!1,animationRule:"bounce",animationDuration:500,animatedValue:!0,startAngle:90,ticksAngle:180,borders:!1}}}},computed:{value:function(){return 100*this.normalizedP},titleText:function(){switch(this.level()){case 0:return"Looking Good";case 1:return"Fishy...";case 2:return"Failing!";default:return"Looking Good"}},titleColor:function(){switch(this.level()){case 0:return"#5cb85c";case 1:return"#f0ad4e";case 2:return"#d9534f";default:return"#5cb85c"}}},methods:{level:function(){return this.value>66?2:this.value>33?1:0}}},s=o,c=(n("6295"),n("2877")),l=Object(c["a"])(s,i,r,!1,null,"38f5df61",null);t["a"]=l.exports},"6d5e":function(e,t,n){"use strict";var i=n("a398"),r=n.n(i);r.a},"754e":function(e,t,n){e.exports=n.p+"img/plugin_rerun_setup.png"},"785f":function(e,t,n){"use strict";n("99af"),n("fb6a"),n("b0c0"),n("d3b7"),n("ac1f"),n("25f0"),n("5319");var i=n("0122"),r=/(?:^|[-_/])(\w)/g,a="root",o="anonymous component",s=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^/]+?|)(\.[^./]*|))(?:[/]*)$/,c=function(e){var t=s.exec(e);return t?t.slice(1):[]},l=function(e,t){var n=c(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},d=function(e){if(!e)return o;if(e.$root===e)return a;if(!e.$options)return o;if(e.$options.name)return e.$options.name;if(e.$options._componentTag)return e.$options._componentTag;if(e.$options.__file){var t=e.$options.__file.replace(/^[a-zA-Z]:/,"").replace(/\\/g,"/"),n=l(t,".vue");return n.replace(r,(function(e,t){return t?t.toUpperCase():""}))}return o},u=function e(t,n,r,a,o,s){var c=0;for(var l in n){if(c+=1,c>s)break;"object"==Object(i["a"])(n[l])?o>a&&e(t,n[l],r+"."+l,a+1,o,s):t[r+"."+l]=n[l]}},f=function(e){var t=e.config.errorHandler;e.config.errorHandler=function(n,i,r){if(window.Sentry){var a={},o=i;if(i._original&&(o=i._original),o)try{a.componentName=d(o),u(a,JSON.parse(JSON.stringify(o.$options.propsData)),"props",0,2,10)}catch(s){console.log("Unable to extract metadata from Vue component.")}r&&(a.lifecycleHook=r),setTimeout((function(){window.Sentry.getCurrentHub().withScope((function(e){e.setContext("vue",a),window.Sentry.getCurrentHub().captureException(n)}))}))}"function"===typeof t&&t.call(e,n,i,r),e.util&&e.util.warn("Error in ".concat(r,': "').concat(n.toString(),'"'),i),console.error(n)}};t["a"]=f},"842d":function(e,t,n){e.exports=n.p+"img/install_plugin.png"},"8a45":function(e,t,n){e.exports=n.p+"img/logo-inverted.png"},"90da":function(e,t,n){},"99b8":function(e,t,n){e.exports={primary:"#9965f4",white:"#fff"}},a398:function(e,t,n){},a78b:function(e,t,n){},acc5:function(e,t,n){},b01d:function(e,t,n){"use strict";var i=n("d3a4"),r=n.n(i);r.a},b19e:function(e,t,n){"use strict";var i=n("acc5"),r=n.n(i);r.a},be59:function(e,t,n){"use strict";var i=n("1e83"),r=n.n(i);r.a},c114:function(e,t,n){},c297:function(e,t,n){"use strict";(function(e){n("7db0"),n("4160"),n("c975"),n("a15b"),n("45fc"),n("a434"),n("b0c0"),n("d3b7"),n("ac1f"),n("8a79"),n("3ca3"),n("466d"),n("5319"),n("1276"),n("159b"),n("ddb0"),n("2b3d");var i=n("0122");a.sessions={},a.isExtensionEnabled=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return!0;if(window.navigator.userAgent.match("Chrome")){var e=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),t=33;return window.navigator.userAgent.match("Linux")&&(t=35),e>=26&&e<=t||a.extension.isInstalled()}return!0};var r={extensionId:"hapfgfdkleiggjjpfpenajgdnfckjpaj",isInstalled:function(){return null!==document.querySelector("#janus-extension-installed")},getScreen:function(e){var t=window.setTimeout((function(){var t=new Error("NavigatorUserMediaError");return t.name='The required Chrome extension is not installed: click <a href="#">here</a> to install it. (NOTE: this will need you to refresh the page)',e(t)}),1e3);this.cache[t]=e,window.postMessage({type:"janusGetScreen",id:t},"*")},init:function(){var e={};this.cache=e,window.addEventListener("message",(function(t){if(t.origin==window.location.origin)if("janusGotScreen"==t.data.type&&e[t.data.id]){var n=e[t.data.id];if(delete e[t.data.id],""===t.data.sourceId){var i=new Error("NavigatorUserMediaError");i.name="You cancelled the request for permission, giving up...",n(i)}else n(null,t.data.sourceId)}else"janusGetScreenPending"==t.data.type&&(console.log("clearing ",t.data.id),window.clearTimeout(t.data.id))}))}};function a(e){if(void 0===a.initDone)return e.error("Library not initialized"),{};if(!a.isWebrtcSupported())return e.error("WebRTC not supported by this browser"),{};if(a.log("Library initialized: "+a.initDone),e=e||{},e.success="function"==typeof e.success?e.success:a.noop,e.error="function"==typeof e.error?e.error:a.noop,e.destroyed="function"==typeof e.destroyed?e.destroyed:a.noop,null===e.server||void 0===e.server)return e.error("Invalid server url"),{};var t=!1,n=null,r={},o=null,s=null,c=0,l=e.server;a.isArray(l)?(a.log("Multiple servers provided ("+l.length+"), will use the first that works"),l=null,s=e.server,a.debug(s)):0===l.indexOf("ws")?(t=!0,a.log("Using WebSockets to contact Janus: "+l)):(t=!1,a.log("Using REST API to contact Janus: "+l));var d=e.iceServers;void 0!==d&&null!==d||(d=[{urls:"stun:stun.l.google.com:19302"}]);var u=e.iceTransportPolicy,f=e.bundlePolicy,p=e.ipv6;void 0!==p&&null!==p||(p=!1);var v=!1;void 0!==e.withCredentials&&null!==e.withCredentials&&(v=!0===e.withCredentials);var m=10;void 0!==e.max_poll_events&&null!==e.max_poll_events&&(m=e.max_poll_events),m<1&&(m=1);var g=null;void 0!==e.token&&null!==e.token&&(g=e.token);var h=null;void 0!==e.apisecret&&null!==e.apisecret&&(h=e.apisecret),this.destroyOnUnload=!0,void 0!==e.destroyOnUnload&&null!==e.destroyOnUnload&&(this.destroyOnUnload=!0===e.destroyOnUnload);var b=25e3;void 0!==e.keepAlivePeriod&&null!==e.keepAlivePeriod&&(b=e.keepAlivePeriod),isNaN(b)&&(b=25e3);var w=6e4;function y(e){var t={high:9e5,medium:3e5,low:1e5};return void 0!==e&&null!==e&&(e.high&&(t.high=e.high),e.medium&&(t.medium=e.medium),e.low&&(t.low=e.low)),t}void 0!==e.longPollTimeout&&null!==e.longPollTimeout&&(w=e.longPollTimeout),isNaN(w)&&(w=6e4);var _=!1,C=null,k={},S=this,T=0,P={};function x(){if(null!=C)if(a.debug("Long poll..."),_){var t=l+"/"+C+"?rid="+(new Date).getTime();void 0!==m&&null!==m&&(t=t+"&maxev="+m),null!==g&&void 0!==g&&(t=t+"&token="+encodeURIComponent(g)),null!==h&&void 0!==h&&(t=t+"&apisecret="+encodeURIComponent(h)),a.httpAPICall(t,{verb:"GET",withCredentials:v,success:A,timeout:w,error:function(t,n){if(a.error(t+":",n),T++,T>3)return _=!1,void e.error("Lost connection to the server (is it down?)");x()}})}else a.warn("Is the server down? (connected=false)")}function A(e,i){if(T=0,t||void 0===C||null===C||!0===i||x(),t||!a.isArray(e))if("keepalive"!==e["janus"])if("ack"!==e["janus"])if("success"!==e["janus"])if("trickle"===e["janus"]){var r=e["sender"];if(void 0===r||null===r)return void a.warn("Missing sender...");var o=k[r];if(void 0===o||null===o)return void a.debug("This handle is not attached to this session");var s=e["candidate"];a.debug("Got a trickled candidate on session "+C),a.debug(s);var c=o.webrtcStuff;c.pc&&c.remoteSdp?(a.debug("Adding remote candidate:",s),s&&!0!==s.completed?c.pc.addIceCandidate(s):c.pc.addIceCandidate(a.endOfCandidates)):(a.debug("We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate"),c.candidates||(c.candidates=[]),c.candidates.push(s),a.debug(c.candidates))}else{if("webrtcup"===e["janus"]){a.debug("Got a webrtcup event on session "+C),a.debug(e);r=e["sender"];if(void 0===r||null===r)return void a.warn("Missing sender...");o=k[r];return void 0===o||null===o?void a.debug("This handle is not attached to this session"):void o.webrtcState(!0)}if("hangup"===e["janus"]){a.debug("Got a hangup event on session "+C),a.debug(e);r=e["sender"];if(void 0===r||null===r)return void a.warn("Missing sender...");o=k[r];if(void 0===o||null===o)return void a.debug("This handle is not attached to this session");o.webrtcState(!1,e["reason"]),o.hangup()}else if("detached"===e["janus"]){a.debug("Got a detached event on session "+C),a.debug(e);r=e["sender"];if(void 0===r||null===r)return void a.warn("Missing sender...");o=k[r];if(void 0===o||null===o)return;o.detached=!0,o.ondetached(),o.detach()}else if("media"===e["janus"]){a.debug("Got a media event on session "+C),a.debug(e);r=e["sender"];if(void 0===r||null===r)return void a.warn("Missing sender...");o=k[r];if(void 0===o||null===o)return void a.debug("This handle is not attached to this session");o.mediaState(e["type"],e["receiving"])}else if("slowlink"===e["janus"]){a.debug("Got a slowlink event on session "+C),a.debug(e);r=e["sender"];if(void 0===r||null===r)return void a.warn("Missing sender...");o=k[r];if(void 0===o||null===o)return void a.debug("This handle is not attached to this session");o.slowLink(e["uplink"],e["lost"])}else{if("error"===e["janus"]){a.error("Ooops: "+e["error"].code+" "+e["error"].reason),a.debug(e);p=e["transaction"];if(null!==p&&void 0!==p){v=P[p];null!==v&&void 0!==v&&v(e),delete P[p]}return}if("event"===e["janus"]){a.debug("Got a plugin event on session "+C),a.debug(e);r=e["sender"];if(void 0===r||null===r)return void a.warn("Missing sender...");var l=e["plugindata"];if(void 0===l||null===l)return void a.warn("Missing plugindata...");a.debug("  -- Event is coming from "+r+" ("+l["plugin"]+")");var d=l["data"];a.debug(d);o=k[r];if(void 0===o||null===o)return void a.warn("This handle is not attached to this session");var u=e["jsep"];void 0!==u&&null!==u&&(a.debug("Handling SDP as well..."),a.debug(u));var f=o.onmessage;null!==f&&void 0!==f?(a.debug("Notifying application..."),f(d,u)):a.debug("No provided notification callback")}else{if("timeout"===e["janus"])return a.error("Timeout on session "+C),a.debug(e),void(t&&n.close(3504,"Gateway timeout"));a.warn("Unknown message/event  '"+e["janus"]+"' on session "+C),a.debug(e)}}}else{a.debug("Got a success on session "+C),a.debug(e);var p=e["transaction"];if(null!==p&&void 0!==p){var v=P[p];null!==v&&void 0!==v&&v(e),delete P[p]}}else{a.debug("Got an ack on session "+C),a.debug(e);var p=e["transaction"];if(null!==p&&void 0!==p){var v=P[p];null!==v&&void 0!==v&&v(e),delete P[p]}}else a.vdebug("Got a keepalive on session "+C);else for(var m=0;m<e.length;m++)A(e[m],!0)}function D(){if(null!==l&&t&&_){o=setTimeout(D,b);var e={janus:"keepalive",session_id:C,transaction:a.randomString(12)};null!==g&&void 0!==g&&(e["token"]=g),null!==h&&void 0!==h&&(e["apisecret"]=h),n.send(JSON.stringify(e))}}function O(i){var d=a.randomString(12),u={janus:"create",transaction:d};if(i["reconnect"]&&(_=!1,u["janus"]="claim",u["session_id"]=C,n&&(n.onopen=null,n.onerror=null,n.onclose=null,o&&(clearTimeout(o),o=null))),null!==g&&void 0!==g&&(u["token"]=g),null!==h&&void 0!==h&&(u["apisecret"]=h),null===l&&a.isArray(s)&&(l=s[c],0===l.indexOf("ws")?(t=!0,a.log("Server #"+(c+1)+": trying WebSockets to contact Janus ("+l+")")):(t=!1,a.log("Server #"+(c+1)+": trying REST API to contact Janus ("+l+")"))),t)for(var f in n=a.newWebSocket(l,"janus-protocol"),r={error:function(){if(a.error("Error connecting to the Janus WebSockets server... "+l),a.isArray(s)&&!i["reconnect"])return c++,c==s.length?void i.error("Error connecting to any of the provided Janus servers: Is the server down?"):(l=null,void setTimeout((function(){O(i)}),200));i.error("Error connecting to the Janus WebSockets server: Is the server down?")},open:function(){P[d]=function(e){if(a.debug(e),"success"!==e["janus"])return a.error("Ooops: "+e["error"].code+" "+e["error"].reason),void i.error(e["error"].reason);o=setTimeout(D,b),_=!0,C=e["session_id"]?e["session_id"]:e.data["id"],i["reconnect"]?a.log("Claimed session: "+C):a.log("Created session: "+C),a.sessions[C]=S,i.success()},n.send(JSON.stringify(u))},message:function(e){A(JSON.parse(e.data))},close:function(){null!==l&&_&&(_=!1,e.error("Lost connection to the server (is it down?)"))}},r)n.addEventListener(f,r[f]);else a.httpAPICall(l,{verb:"POST",withCredentials:v,body:u,success:function(e){if(a.debug(e),"success"!==e["janus"])return a.error("Ooops: "+e["error"].code+" "+e["error"].reason),void i.error(e["error"].reason);_=!0,C=e["session_id"]?e["session_id"]:e.data["id"],i["reconnect"]?a.log("Claimed session: "+C):a.log("Created session: "+C),a.sessions[C]=S,x(),i.success()},error:function(e,t){if(a.error(e+":",t),a.isArray(s)&&!i["reconnect"])return c++,c==s.length?void i.error("Error connecting to any of the provided Janus servers: Is the server down?"):(l=null,void setTimeout((function(){O(i)}),200));""===t?i.error(e+": Is the server down?"):i.error(e+": "+t)}})}function I(i){i=i||{},i.success="function"==typeof i.success?i.success:a.noop;var s=!0;void 0!==i.asyncRequest&&null!==i.asyncRequest&&(s=!0===i.asyncRequest);var c=!0;void 0!==i.notifyDestroyed&&null!==i.notifyDestroyed&&(c=!0===i.notifyDestroyed);var d=!1;if(void 0!==i.cleanupHandles&&null!==i.cleanupHandles&&(d=!0===i.cleanupHandles),a.log("Destroying session "+C+" (async="+s+")"),!_)return a.warn("Is the server down? (connected=false)"),void i.success();if(void 0===C||null===C)return a.warn("No session to destroy"),i.success(),void(c&&e.destroyed());if(d)for(var u in k)V(u,{noRequest:!0});var f={janus:"destroy",transaction:a.randomString(12)};if(null!==g&&void 0!==g&&(f["token"]=g),null!==h&&void 0!==h&&(f["apisecret"]=h),t){f["session_id"]=C;var p=function(){for(var e in r)n.removeEventListener(e,r[e]);n.removeEventListener("message",m),n.removeEventListener("error",b),o&&clearTimeout(o),n.close()},m=function(t){var n=JSON.parse(t.data);n.session_id==f.session_id&&n.transaction==f.transaction&&(p(),i.success(),c&&e.destroyed())},b=function(t){p(),i.error("Failed to destroy the server: Is the server down?"),c&&e.destroyed()};return n.addEventListener("message",m),n.addEventListener("error",b),void n.send(JSON.stringify(f))}a.httpAPICall(l+"/"+C,{verb:"POST",async:s,withCredentials:v,body:f,success:function(t){a.log("Destroyed session:"),a.debug(t),C=null,_=!1,"success"!==t["janus"]&&a.error("Ooops: "+t["error"].code+" "+t["error"].reason),i.success(),c&&e.destroyed()},error:function(t,n){a.error(t+":",n),C=null,_=!1,i.success(),c&&e.destroyed()}})}function E(e){if(e=e||{},e.success="function"==typeof e.success?e.success:a.noop,e.error="function"==typeof e.error?e.error:a.noop,e.consentDialog="function"==typeof e.consentDialog?e.consentDialog:a.noop,e.iceState="function"==typeof e.iceState?e.iceState:a.noop,e.mediaState="function"==typeof e.mediaState?e.mediaState:a.noop,e.webrtcState="function"==typeof e.webrtcState?e.webrtcState:a.noop,e.slowLink="function"==typeof e.slowLink?e.slowLink:a.noop,e.onmessage="function"==typeof e.onmessage?e.onmessage:a.noop,e.onlocalstream="function"==typeof e.onlocalstream?e.onlocalstream:a.noop,e.onremotestream="function"==typeof e.onremotestream?e.onremotestream:a.noop,e.ondata="function"==typeof e.ondata?e.ondata:a.noop,e.ondataopen="function"==typeof e.ondataopen?e.ondataopen:a.noop,e.oncleanup="function"==typeof e.oncleanup?e.oncleanup:a.noop,e.ondetached="function"==typeof e.ondetached?e.ondetached:a.noop,!_)return a.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var i=e.plugin;if(void 0===i||null===i)return a.error("Invalid plugin"),void e.error("Invalid plugin");var r=e.opaqueId,o=e.token?e.token:g,s=a.randomString(12),c={janus:"attach",plugin:i,opaque_id:r,transaction:s};if(null!==o&&void 0!==o&&(c["token"]=o),null!==h&&void 0!==h&&(c["apisecret"]=h),t)return P[s]=function(t){if(a.debug(t),"success"!==t["janus"])return a.error("Ooops: "+t["error"].code+" "+t["error"].reason),void e.error("Ooops: "+t["error"].code+" "+t["error"].reason);var n=t.data["id"];a.log("Created handle: "+n);var r={session:S,plugin:i,id:n,token:o,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return n},getPlugin:function(){return i},getVolume:function(){return q(n,!0)},getRemoteVolume:function(){return q(n,!0)},getLocalVolume:function(){return q(n,!1)},isAudioMuted:function(){return G(n,!1)},muteAudio:function(){return J(n,!1,!0)},unmuteAudio:function(){return J(n,!1,!1)},isVideoMuted:function(){return G(n,!0)},muteVideo:function(){return J(n,!0,!0)},unmuteVideo:function(){return J(n,!0,!1)},getBitrate:function(){return H(n)},send:function(e){R(n,e)},data:function(e){F(n,e)},dtmf:function(e){L(n,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){$(n,!0,e)},createAnswer:function(e){$(n,!1,e)},handleRemoteJsep:function(e){B(n,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ontrackmuted:e.ontrackmuted,ontrackunmuted:e.ontrackunmuted,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){Q(n,!0===e)},detach:function(e){V(n,e)}};k[n]=r,e.success(r)},c["session_id"]=C,void n.send(JSON.stringify(c));a.httpAPICall(l+"/"+C,{verb:"POST",withCredentials:v,body:c,success:function(t){if(a.debug(t),"success"!==t["janus"])return a.error("Ooops: "+t["error"].code+" "+t["error"].reason),void e.error("Ooops: "+t["error"].code+" "+t["error"].reason);var n=t.data["id"];a.log("Created handle: "+n);var r={session:S,plugin:i,id:n,token:o,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return n},getPlugin:function(){return i},getVolume:function(){return q(n,!0)},getRemoteVolume:function(){return q(n,!0)},getLocalVolume:function(){return q(n,!1)},isAudioMuted:function(){return G(n,!1)},muteAudio:function(){return J(n,!1,!0)},unmuteAudio:function(){return J(n,!1,!1)},isVideoMuted:function(){return G(n,!0)},muteVideo:function(){return J(n,!0,!0)},unmuteVideo:function(){return J(n,!0,!1)},getBitrate:function(){return H(n)},send:function(e){R(n,e)},data:function(e){F(n,e)},dtmf:function(e){L(n,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){$(n,!0,e)},createAnswer:function(e){$(n,!1,e)},handleRemoteJsep:function(e){B(n,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ontrackmuted:e.ontrackmuted,ontrackunmuted:e.ontrackunmuted,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){Q(n,!0===e)},detach:function(e){V(n,e)}};k[n]=r,e.success(r)},error:function(e,t){a.error(e+":",t)}})}function R(e,i){if(i=i||{},i.success="function"==typeof i.success?i.success:a.noop,i.error="function"==typeof i.error?i.error:a.noop,!_)return a.warn("Is the server down? (connected=false)"),void i.error("Is the server down? (connected=false)");var r=k[e];if(null===r||void 0===r||null===r.webrtcStuff||void 0===r.webrtcStuff)return a.warn("Invalid handle"),void i.error("Invalid handle");var o=i.message,s=i.jsep,c=a.randomString(12),d={janus:"message",body:o,transaction:c};if(null!==r.token&&void 0!==r.token&&(d["token"]=r.token),null!==h&&void 0!==h&&(d["apisecret"]=h),null!==s&&void 0!==s&&(d.jsep=s),a.debug("Sending message to plugin (handle="+e+"):"),a.debug(d),t)return d["session_id"]=C,d["handle_id"]=e,P[c]=function(e){if(a.debug("Message sent!"),a.debug(e),"success"===e["janus"]){var t=e["plugindata"];if(void 0===t||null===t)return a.warn("Request succeeded, but missing plugindata..."),void i.success();a.log("Synchronous transaction successful ("+t["plugin"]+")");var n=t["data"];return a.debug(n),void i.success(n)}"ack"===e["janus"]?i.success():void 0!==e["error"]&&null!==e["error"]?(a.error("Ooops: "+e["error"].code+" "+e["error"].reason),i.error(e["error"].code+" "+e["error"].reason)):(a.error("Unknown error"),i.error("Unknown error"))},void n.send(JSON.stringify(d));a.httpAPICall(l+"/"+C+"/"+e,{verb:"POST",withCredentials:v,body:d,success:function(e){if(a.debug("Message sent!"),a.debug(e),"success"===e["janus"]){var t=e["plugindata"];if(void 0===t||null===t)return a.warn("Request succeeded, but missing plugindata..."),void i.success();a.log("Synchronous transaction successful ("+t["plugin"]+")");var n=t["data"];return a.debug(n),void i.success(n)}"ack"===e["janus"]?i.success():void 0!==e["error"]&&null!==e["error"]?(a.error("Ooops: "+e["error"].code+" "+e["error"].reason),i.error(e["error"].code+" "+e["error"].reason)):(a.error("Unknown error"),i.error("Unknown error"))},error:function(e,t){a.error(e+":",t),i.error(e+": "+t)}})}function j(e,i){if(_){var r=k[e];if(null!==r&&void 0!==r&&null!==r.webrtcStuff&&void 0!==r.webrtcStuff){var o={janus:"trickle",candidate:i,transaction:a.randomString(12)};if(null!==r.token&&void 0!==r.token&&(o["token"]=r.token),null!==h&&void 0!==h&&(o["apisecret"]=h),a.vdebug("Sending trickle candidate (handle="+e+"):"),a.vdebug(o),t)return o["session_id"]=C,o["handle_id"]=e,void n.send(JSON.stringify(o));a.httpAPICall(l+"/"+C+"/"+e,{verb:"POST",withCredentials:v,body:o,success:function(e){a.vdebug("Candidate sent!"),a.vdebug(e),"ack"===e["janus"]||a.error("Ooops: "+e["error"].code+" "+e["error"].reason)},error:function(e,t){a.error(e+":",t)}})}else a.warn("Invalid handle")}else a.warn("Is the server down? (connected=false)")}function M(e,t,n,i){var r=k[e];if(null!==r&&void 0!==r&&null!==r.webrtcStuff&&void 0!==r.webrtcStuff){var o=r.webrtcStuff,s=function(e){var t=e.target.label;r.ondata(e.data,t)},c=function(e){a.log("Received state change on data channel:",e);var t=e.target.label,n=o.dataChannel[t]?o.dataChannel[t].readyState:"null";if(a.log("State change on <"+t+"> data channel: "+n),"open"===n){if(o.dataChannel[t].pending&&o.dataChannel[t].pending.length>0){for(var i in a.log("Sending pending messages on <"+t+">:",o.dataChannel[t].pending.length),o.dataChannel[t].pending){var s=o.dataChannel[t].pending[i];a.log("Sending string on data channel <"+t+">: "+s),o.dataChannel[t].send(s)}o.dataChannel[t].pending=[]}r.ondataopen(t)}},l=function(e){a.error("Got error on data channel:",e)};o.dataChannel[t]=n||o.pc.createDataChannel(t,{ordered:!1}),o.dataChannel[t].onmessage=s,o.dataChannel[t].onopen=c,o.dataChannel[t].onclose=c,o.dataChannel[t].onerror=l,o.dataChannel[t].pending=[],i&&o.dataChannel[t].pending.push(i)}else a.warn("Invalid handle")}function F(e,t){t=t||{},t.success="function"==typeof t.success?t.success:a.noop,t.error="function"==typeof t.error?t.error:a.noop;var n=k[e];if(null===n||void 0===n||null===n.webrtcStuff||void 0===n.webrtcStuff)return a.warn("Invalid handle"),void t.error("Invalid handle");var i=n.webrtcStuff,r=t.text;if(null===r||void 0===r)return a.warn("Invalid text"),void t.error("Invalid text");var o=t.label?t.label:a.dataChanDefaultLabel;return i.dataChannel[o]?"open"!==i.dataChannel[o].readyState?(i.dataChannel[o].pending.push(r),void t.success()):(a.log("Sending string on data channel <"+o+">: "+r),i.dataChannel[o].send(r),void t.success()):(M(e,o,!1,r),void t.success())}function L(e,t){t=t||{},t.success="function"==typeof t.success?t.success:a.noop,t.error="function"==typeof t.error?t.error:a.noop;var n=k[e];if(null===n||void 0===n||null===n.webrtcStuff||void 0===n.webrtcStuff)return a.warn("Invalid handle"),void t.error("Invalid handle");var i=n.webrtcStuff;if(null===i.dtmfSender||void 0===i.dtmfSender){if(void 0!==i.pc&&null!==i.pc){var r=i.pc.getSenders(),o=r.find((function(e){return e.track&&"audio"===e.track.kind}));if(!o)return a.warn("Invalid DTMF configuration (no audio track)"),void t.error("Invalid DTMF configuration (no audio track)");i.dtmfSender=o.dtmf,i.dtmfSender&&(a.log("Created DTMF Sender"),i.dtmfSender.ontonechange=function(e){a.debug("Sent DTMF tone: "+e.tone)})}if(null===i.dtmfSender||void 0===i.dtmfSender)return a.warn("Invalid DTMF configuration"),void t.error("Invalid DTMF configuration")}var s=t.dtmf;if(null===s||void 0===s)return a.warn("Invalid DTMF parameters"),void t.error("Invalid DTMF parameters");var c=s.tones;if(null===c||void 0===c)return a.warn("Invalid DTMF string"),void t.error("Invalid DTMF string");var l=s.duration;null!==l&&void 0!==l||(l=500);var d=s.gap;null!==d&&void 0!==d||(d=50),a.debug("Sending DTMF string "+c+" (duration "+l+"ms, gap "+d+"ms)"),i.dtmfSender.insertDTMF(c,l,d),t.success()}function V(e,i){i=i||{},i.success="function"==typeof i.success?i.success:a.noop,i.error="function"==typeof i.error?i.error:a.noop;var r=!0;void 0!==i.asyncRequest&&null!==i.asyncRequest&&(r=!0===i.asyncRequest);var o=!0;void 0!==i.noRequest&&null!==i.noRequest&&(o=!0===i.noRequest),a.log("Destroying handle "+e+" (async="+r+")"),Q(e);var s=k[e];if(null===s||void 0===s||s.detached)return delete k[e],void i.success();if(o)return delete k[e],void i.success();if(!_)return a.warn("Is the server down? (connected=false)"),void i.error("Is the server down? (connected=false)");var c={janus:"detach",transaction:a.randomString(12)};if(null!==s.token&&void 0!==s.token&&(c["token"]=s.token),null!==h&&void 0!==h&&(c["apisecret"]=h),t)return c["session_id"]=C,c["handle_id"]=e,n.send(JSON.stringify(c)),delete k[e],void i.success();a.httpAPICall(l+"/"+C+"/"+e,{verb:"POST",async:r,withCredentials:v,body:c,success:function(t){a.log("Destroyed handle:"),a.debug(t),"success"!==t["janus"]&&a.error("Ooops: "+t["error"].code+" "+t["error"].reason),delete k[e],i.success()},error:function(t,n){a.error(t+":",n),delete k[e],i.success()}})}function N(e,t,n,r,o){var s=k[e];if(null===s||void 0===s||null===s.webrtcStuff||void 0===s.webrtcStuff)return a.warn("Invalid handle"),void r.error("Invalid handle");var c=s.webrtcStuff;a.debug("streamsDone:",o),o&&(a.debug("  -- Audio tracks:",o.getAudioTracks()),a.debug("  -- Video tracks:",o.getVideoTracks()));var l=!1;if(c.myStream&&n.update&&!c.streamExternal){if((!n.update&&K(n)||n.update&&(n.addAudio||n.replaceAudio))&&o.getAudioTracks()&&o.getAudioTracks().length)if(c.myStream.addTrack(o.getAudioTracks()[0]),a.unifiedPlan){a.log((n.replaceAudio?"Replacing":"Adding")+" audio track:",o.getAudioTracks()[0]);var v=null,m=c.pc.getTransceivers();if(m&&m.length>0)for(var g in m){var h=m[g];if(h.sender&&h.sender.track&&"audio"===h.sender.track.kind||h.receiver&&h.receiver.track&&"audio"===h.receiver.track.kind){v=h;break}}v&&v.sender?v.sender.replaceTrack(o.getAudioTracks()[0]):c.pc.addTrack(o.getAudioTracks()[0],o)}else a.log((n.replaceAudio?"Replacing":"Adding")+" audio track:",o.getAudioTracks()[0]),c.pc.addTrack(o.getAudioTracks()[0],o);if((!n.update&&te(n)||n.update&&(n.addVideo||n.replaceVideo))&&o.getVideoTracks()&&o.getVideoTracks().length)if(c.myStream.addTrack(o.getVideoTracks()[0]),a.unifiedPlan){a.log((n.replaceVideo?"Replacing":"Adding")+" video track:",o.getVideoTracks()[0]);var b=null;m=c.pc.getTransceivers();if(m&&m.length>0)for(var g in m){h=m[g];if(h.sender&&h.sender.track&&"video"===h.sender.track.kind||h.receiver&&h.receiver.track&&"video"===h.receiver.track.kind){b=h;break}}b&&b.sender?b.sender.replaceTrack(o.getVideoTracks()[0]):c.pc.addTrack(o.getVideoTracks()[0],o)}else a.log((n.replaceVideo?"Replacing":"Adding")+" video track:",o.getVideoTracks()[0]),c.pc.addTrack(o.getVideoTracks()[0],o)}else c.myStream=o,l=!0;if(!c.pc){var w={iceServers:d,iceTransportPolicy:u,bundlePolicy:f};"chrome"===a.webRTCAdapter.browserDetails.browser&&(w["sdpSemantics"]=a.webRTCAdapter.browserDetails.version<72?"plan-b":"unified-plan");var _={optional:[{DtlsSrtpKeyAgreement:!0}]};if(!0===p&&_.optional.push({googIPv6:!0}),r.rtcConstraints&&"object"===Object(i["a"])(r.rtcConstraints))for(var g in a.debug("Adding custom PeerConnection constraints:",r.rtcConstraints),r.rtcConstraints)_.optional.push(r.rtcConstraints[g]);"edge"===a.webRTCAdapter.browserDetails.browser&&(w.bundlePolicy="max-bundle"),a.log("Creating PeerConnection"),a.debug(_),c.pc=new RTCPeerConnection(w,_),a.debug(c.pc),c.pc.getStats&&(c.volume={},c.bitrate.value="0 kbits/sec"),a.log("Preparing local SDP and gathering candidates (trickle="+c.trickle+")"),c.pc.oniceconnectionstatechange=function(e){c.pc&&s.iceState(c.pc.iceConnectionState)},c.pc.onicecandidate=function(t){if(null==t.candidate||"edge"===a.webRTCAdapter.browserDetails.browser&&t.candidate.candidate.indexOf("endOfCandidates")>0)a.log("End of candidates."),c.iceDone=!0,!0===c.trickle?j(e,{completed:!0}):U(e,r);else{var n={candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex};!0===c.trickle&&j(e,n)}},c.pc.ontrack=function(e){a.log("Handling Remote Track"),a.debug(e),e.streams&&(c.remoteStream=e.streams[0],s.onremotestream(c.remoteStream),e.track.onended||(a.log("Adding onended callback to track:",e.track),e.track.onended=function(e){a.log("Remote track muted/removed:",e),c.remoteStream&&(c.remoteStream.removeTrack(e.target),s.onremotestream(c.remoteStream))},e.track.onmute=function(t){s.ontrackmuted(),e.track.onended(t)},e.track.onunmute=function(e){a.log("Remote track flowing again:",e);try{c.remoteStream.addTrack(e.target),s.onremotestream(c.remoteStream),s.ontrackunmuted()}catch(t){a.error(t)}}))}}if(l&&null!==o&&void 0!==o){a.log("Adding local stream");var C=!0===r.simulcast2;o.getTracks().forEach((function(e){if(a.log("Adding local track:",e),C)if("audio"===e.kind)c.pc.addTrack(e,o);else{a.log("Enabling rid-based simulcasting:",e);var t=y(r.simulcastMaxBitrates);c.pc.addTransceiver(e,{direction:"sendrecv",streams:[o],sendEncodings:[{rid:"h",active:!0,maxBitrate:t.high},{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:t.low,scaleResolutionDownBy:4}]})}else c.pc.addTrack(e,o)}))}if(ae(n)&&!c.dataChannel[a.dataChanDefaultLabel]&&(a.log("Creating data channel"),M(e,a.dataChanDefaultLabel,!1),c.pc.ondatachannel=function(t){a.log("Data channel created by Janus:",t),M(e,t.channel.label,t.channel)}),c.myStream&&s.onlocalstream(c.myStream),null===t||void 0===t)W(e,n,r);else{var S=t["sdp"],T=/420029/gi,P=S.replace(T,"42e01f");a.log(P),t["sdp"]=P,c.pc.setRemoteDescription(t).then((function(){if(a.log("Remote description accepted!"),c.remoteSdp=t.sdp,c.candidates&&c.candidates.length>0){for(var i=0;i<c.candidates.length;i++){var o=c.candidates[i];a.debug("Adding remote candidate:",o),o&&!0!==o.completed?c.pc.addIceCandidate(o):c.pc.addIceCandidate(a.endOfCandidates)}c.candidates=[]}z(e,n,r)}),r.error)}}function $(e,t,n){n=n||{},n.success="function"==typeof n.success?n.success:a.noop,n.error="function"==typeof n.error?n.error:Y;var r=n.jsep;if(t&&r)return a.error("Provided a JSEP to a createOffer"),void n.error("Provided a JSEP to a createOffer");if(!t&&(!r||!r.type||!r.sdp))return a.error("A valid JSEP is required for createAnswer"),void n.error("A valid JSEP is required for createAnswer");n.media=n.media||{audio:!0,video:!0};var o=n.media,s=k[e];if(null===s||void 0===s||null===s.webrtcStuff||void 0===s.webrtcStuff)return a.warn("Invalid handle"),void n.error("Invalid handle");var c=s.webrtcStuff;if(c.trickle=oe(n.trickle),void 0===c.pc||null===c.pc)o.update=!1,o.keepAudio=!1,o.keepVideo=!1;else if(void 0!==c.pc&&null!==c.pc){if(a.log("Updating existing media session"),o.update=!0,null!==n.stream&&void 0!==n.stream)n.stream!==c.myStream&&a.log("Renegotiation involves a new external stream");else{if(o.addAudio){if(o.keepAudio=!1,o.replaceAudio=!1,o.removeAudio=!1,o.audioSend=!0,c.myStream&&c.myStream.getAudioTracks()&&c.myStream.getAudioTracks().length)return a.error("Can't add audio stream, there already is one"),void n.error("Can't add audio stream, there already is one")}else o.removeAudio?(o.keepAudio=!1,o.replaceAudio=!1,o.addAudio=!1,o.audioSend=!1):o.replaceAudio&&(o.keepAudio=!1,o.addAudio=!1,o.removeAudio=!1,o.audioSend=!0);if(null===c.myStream||void 0===c.myStream?(o.replaceAudio&&(o.keepAudio=!1,o.replaceAudio=!1,o.addAudio=!0,o.audioSend=!0),K(o)&&(o.keepAudio=!1,o.addAudio=!0)):null===c.myStream.getAudioTracks()||void 0===c.myStream.getAudioTracks()||0===c.myStream.getAudioTracks().length?(o.replaceAudio&&(o.keepAudio=!1,o.replaceAudio=!1,o.addAudio=!0,o.audioSend=!0),K(o)&&(o.keepVideo=!1,o.addAudio=!0)):!K(o)||o.removeAudio||o.replaceAudio||(o.keepAudio=!0),o.addVideo){if(o.keepVideo=!1,o.replaceVideo=!1,o.removeVideo=!1,o.videoSend=!0,c.myStream&&c.myStream.getVideoTracks()&&c.myStream.getVideoTracks().length)return a.error("Can't add video stream, there already is one"),void n.error("Can't add video stream, there already is one")}else o.removeVideo?(o.keepVideo=!1,o.replaceVideo=!1,o.addVideo=!1,o.videoSend=!1):o.replaceVideo&&(o.keepVideo=!1,o.addVideo=!1,o.removeVideo=!1,o.videoSend=!0);null===c.myStream||void 0===c.myStream||null===c.myStream.getVideoTracks()||void 0===c.myStream.getVideoTracks()||0===c.myStream.getVideoTracks().length?(o.replaceVideo&&(o.keepVideo=!1,o.replaceVideo=!1,o.addVideo=!0,o.videoSend=!0),te(o)&&(o.keepVideo=!1,o.addVideo=!0)):!te(o)||o.removeVideo||o.replaceVideo||(o.keepVideo=!0),o.addData&&(o.data=!0)}if(K(o)&&o.keepAudio&&te(o)&&o.keepVideo)return s.consentDialog(!1),void N(e,r,o,n,c.myStream)}if(o.update&&!c.streamExternal){if(o.removeAudio||o.replaceAudio){if(c.myStream&&c.myStream.getAudioTracks()&&c.myStream.getAudioTracks().length){var l=c.myStream.getAudioTracks()[0];a.log("Removing audio track:",l),c.myStream.removeTrack(l);try{l.stop()}catch(O){}}if(c.pc.getSenders()&&c.pc.getSenders().length){var d=!0;if(o.replaceAudio&&a.unifiedPlan&&(d=!1),d)for(var u in c.pc.getSenders()){l=c.pc.getSenders()[u];l&&l.track&&"audio"===l.track.kind&&(a.log("Removing audio sender:",l),c.pc.removeTrack(l))}}}if(o.removeVideo||o.replaceVideo){if(c.myStream&&c.myStream.getVideoTracks()&&c.myStream.getVideoTracks().length){l=c.myStream.getVideoTracks()[0];a.log("Removing video track:",l),c.myStream.removeTrack(l);try{l.stop()}catch(O){}}if(c.pc.getSenders()&&c.pc.getSenders().length){var f=!0;if(o.replaceVideo&&a.unifiedPlan&&(f=!1),f)for(var u in c.pc.getSenders()){l=c.pc.getSenders()[u];l&&l.track&&"video"===l.track.kind&&(a.log("Removing video sender:",l),c.pc.removeTrack(l))}}}}if(null!==n.stream&&void 0!==n.stream){var p=n.stream;if(a.log("MediaStream provided by the application"),a.debug(p),o.update&&c.myStream&&c.myStream!==n.stream&&!c.streamExternal){try{var v=c.myStream.getTracks();for(var m in v){var g=v[m];a.log(g),null!==g&&void 0!==g&&g.stop()}}catch(O){}c.myStream=null}return c.streamExternal=!0,s.consentDialog(!1),void N(e,r,o,n,p)}if(K(o)||te(o)){if(!a.isGetUserMediaAvailable())return void n.error("getUserMedia not available");var h={mandatory:{},optional:[]};s.consentDialog(!0);var b=K(o);!0===b&&void 0!=o&&null!=o&&"object"===Object(i["a"])(o.audio)&&(b=o.audio);var w=te(o);if(!0===w&&void 0!=o&&null!=o){var y=!0===n.simulcast,_=!0===n.simulcast2;if(!y&&!_||r||void 0!==o.video&&!1!==o.video||(o.video="hires"),o.video&&"screen"!=o.video&&"window"!=o.video)if("object"===Object(i["a"])(o.video))w=o.video;else{var C=0,S=0;"lowres"===o.video?(S=240,240,C=320):"lowres-16:9"===o.video?(S=180,180,C=320):"hires"===o.video||"hires-16:9"===o.video||"hdres"===o.video?(S=720,720,C=1280):"fhdres"===o.video?(S=1080,1080,C=1920):"4kres"===o.video?(S=2160,2160,C=3840):"stdres"===o.video?(S=480,480,C=640):"stdres-16:9"===o.video?(S=360,360,C=640):(a.log("Default video setting is stdres 4:3"),S=480,480,C=640),a.log("Adding media constraint:",o.video),w={height:{ideal:S},width:{ideal:C}},a.log("Adding video constraint:",w)}else if("screen"===o.video||"window"===o.video){if(o.screenshareFrameRate||(o.screenshareFrameRate=3),navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return void navigator.mediaDevices.getDisplayMedia({video:!0}).then((function(t){s.consentDialog(!1),K(o)&&!o.keepAudio?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(i){t.addTrack(i.getAudioTracks()[0]),N(e,r,o,n,t)})):N(e,r,o,n,t)}),(function(e){s.consentDialog(!1),n.error(e)}));function T(t,i){s.consentDialog(!1),t?n.error(t):N(e,r,o,n,i)}function P(e,t,n){a.log("Adding media constraint (screen capture)"),a.debug(e),navigator.mediaDevices.getUserMedia(e).then((function(e){n?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(n){e.addTrack(n.getAudioTracks()[0]),t(null,e)})):t(null,e)})).catch((function(e){s.consentDialog(!1),t(e)}))}if("chrome"===a.webRTCAdapter.browserDetails.browser){var x=a.webRTCAdapter.browserDetails.version,A=33;window.navigator.userAgent.match("Linux")&&(A=35),x>=26&&x<=A?(h={video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:o.screenshareFrameRate,maxFrameRate:o.screenshareFrameRate,chromeMediaSource:"screen"}},audio:K(o)&&!o.keepAudio},P(h,T)):a.extension.getScreen((function(e,t){if(e)return s.consentDialog(!1),n.error(e);h={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:o.screenshareFrameRate,maxFrameRate:o.screenshareFrameRate},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}},h.video.mandatory.chromeMediaSourceId=t,P(h,T,K(o)&&!o.keepAudio)}))}else if("firefox"===a.webRTCAdapter.browserDetails.browser){if(!(a.webRTCAdapter.browserDetails.version>=33)){var D=new Error("NavigatorUserMediaError");return D.name="Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)",s.consentDialog(!1),void n.error(D)}h={video:{mozMediaSource:o.video,mediaSource:o.video},audio:K(o)&&!o.keepAudio},P(h,(function(e,t){if(T(e,t),!e)var n=t.currentTime,i=window.setInterval((function(){t||window.clearInterval(i),t.currentTime==n&&(window.clearInterval(i),t.onended&&t.onended()),n=t.currentTime}),500)}))}return}}null!==o&&void 0!==o&&"screen"===o.video||navigator.mediaDevices.enumerateDevices().then((function(t){var i=t.some((function(e){return"audioinput"===e.kind})),c=re(o)||t.some((function(e){return"videoinput"===e.kind})),l=K(o),d=te(o),u=X(o),f=ne(o);if(l||d||u||f){var v=!!l&&i,m=!!d&&c;if(!v&&!m)return s.consentDialog(!1),n.error("No capture device found"),!1;if(!v&&u)return s.consentDialog(!1),n.error("Audio capture is required, but no capture device found"),!1;if(!m&&f)return s.consentDialog(!1),n.error("Video capture is required, but no capture device found"),!1}var g={audio:!(!i||o.keepAudio)&&b,video:!(!c||o.keepVideo)&&w};a.debug("getUserMedia constraints",g),g.audio||g.video?navigator.mediaDevices.getUserMedia(g).then((function(t){s.consentDialog(!1),N(e,r,o,n,t)})).catch((function(e){s.consentDialog(!1),n.error({code:e.code,name:e.name,message:e.message})})):(s.consentDialog(!1),N(e,r,o,n,p))})).catch((function(e){s.consentDialog(!1),n.error("enumerateDevices error",e)}))}else N(e,r,o,n)}function B(e,t){t=t||{},t.success="function"==typeof t.success?t.success:a.noop,t.error="function"==typeof t.error?t.error:Y;var n=t.jsep,i=k[e];if(null===i||void 0===i||null===i.webrtcStuff||void 0===i.webrtcStuff)return a.warn("Invalid handle"),void t.error("Invalid handle");var r=i.webrtcStuff;if(void 0!==n&&null!==n){if(null===r.pc)return a.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"),void t.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep");r.pc.setRemoteDescription(n).then((function(){if(a.log("Remote description accepted!"),r.remoteSdp=n.sdp,r.candidates&&r.candidates.length>0){for(var e=0;e<r.candidates.length;e++){var i=r.candidates[e];a.debug("Adding remote candidate:",i),i&&!0!==i.completed?r.pc.addIceCandidate(i):r.pc.addIceCandidate(a.endOfCandidates)}r.candidates=[]}t.success()}),t.error)}else t.error("Invalid JSEP")}function W(e,t,n){n=n||{},n.success="function"==typeof n.success?n.success:a.noop,n.error="function"==typeof n.error?n.error:a.noop,n.customizeSdp="function"==typeof n.customizeSdp?n.customizeSdp:a.noop;var i=k[e];if(null===i||void 0===i||null===i.webrtcStuff||void 0===i.webrtcStuff)return a.warn("Invalid handle"),void n.error("Invalid handle");var r=i.webrtcStuff,o=!0===n.simulcast;o?a.log("Creating offer (iceDone="+r.iceDone+", simulcast="+o+")"):a.log("Creating offer (iceDone="+r.iceDone+")");var s={};if(a.unifiedPlan){var c=null,l=null,d=r.pc.getTransceivers();if(d&&d.length>0)for(var u in d){var f=d[u];f.sender&&f.sender.track&&"audio"===f.sender.track.kind||f.receiver&&f.receiver.track&&"audio"===f.receiver.track.kind?c||(c=f):(f.sender&&f.sender.track&&"video"===f.sender.track.kind||f.receiver&&f.receiver.track&&"video"===f.receiver.track.kind)&&(l||(l=f))}var p=K(t),v=ee(t);p||v?p&&v?c&&(c.setDirection?c.setDirection("sendrecv"):c.direction="sendrecv",a.log("Setting audio transceiver to sendrecv:",c)):p&&!v?c&&(c.setDirection?c.setDirection("sendonly"):c.direction="sendonly",a.log("Setting audio transceiver to sendonly:",c)):!p&&v&&(c?(c.setDirection?c.setDirection("recvonly"):c.direction="recvonly",a.log("Setting audio transceiver to recvonly:",c)):(c=r.pc.addTransceiver("audio",{direction:"recvonly"}),a.log("Adding recvonly audio transceiver:",c))):t.removeAudio&&c&&(c.setDirection?c.setDirection("inactive"):c.direction="inactive",a.log("Setting audio transceiver to inactive:",c));var m=te(t),g=ie(t);m||g?m&&g?l&&(l.setDirection?l.setDirection("sendrecv"):l.direction="sendrecv",a.log("Setting video transceiver to sendrecv:",l)):m&&!g?l&&(l.setDirection?l.setDirection("sendonly"):l.direction="sendonly",a.log("Setting video transceiver to sendonly:",l)):!m&&g&&(l?(l.setDirection?l.setDirection("recvonly"):l.direction="recvonly",a.log("Setting video transceiver to recvonly:",l)):(l=r.pc.addTransceiver("video",{direction:"recvonly"}),a.log("Adding recvonly video transceiver:",l))):t.removeVideo&&l&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive",a.log("Setting video transceiver to inactive:",l))}else s["offerToReceiveAudio"]=ee(t),s["offerToReceiveVideo"]=ie(t);var h=!0===n.iceRestart;h&&(s["iceRestart"]=!0),a.debug(s);var b=te(t);if(b&&o&&"firefox"===a.webRTCAdapter.browserDetails.browser){a.log("Enabling Simulcasting for Firefox (RID)");var w=r.pc.getSenders().find((function(e){return"video"==e.track.kind}));if(w){var _=w.getParameters();_||(_={});var C=y(n.simulcastMaxBitrates);_.encodings=[{rid:"h",active:!0,maxBitrate:C.high},{rid:"m",active:!0,maxBitrate:C.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:C.low,scaleResolutionDownBy:4}],w.setParameters(_)}}r.pc.createOffer(s).then((function(e){a.debug(e);var t={type:e.type,sdp:e.sdp};n.customizeSdp(t),e.sdp=t.sdp,a.log("Setting local description"),b&&o&&("chrome"===a.webRTCAdapter.browserDetails.browser||"safari"===a.webRTCAdapter.browserDetails.browser?(a.log("Enabling Simulcasting for Chrome (SDP munging)"),e.sdp=Z(e.sdp)):"firefox"!==a.webRTCAdapter.browserDetails.browser&&a.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),r.mySdp=e.sdp,r.pc.setLocalDescription(e).catch(n.error),r.mediaConstraints=s,r.iceDone||r.trickle?(a.log("Offer ready"),a.debug(n),n.success(e)):a.log("Waiting for all candidates...")}),n.error)}function z(e,t,n){n=n||{},n.success="function"==typeof n.success?n.success:a.noop,n.error="function"==typeof n.error?n.error:a.noop,n.customizeSdp="function"==typeof n.customizeSdp?n.customizeSdp:a.noop;var i=k[e];if(null===i||void 0===i||null===i.webrtcStuff||void 0===i.webrtcStuff)return a.warn("Invalid handle"),void n.error("Invalid handle");var r=i.webrtcStuff,o=!0===n.simulcast;o?a.log("Creating answer (iceDone="+r.iceDone+", simulcast="+o+")"):a.log("Creating answer (iceDone="+r.iceDone+")");var s=null;if(a.unifiedPlan){s={};var c=null,l=null,d=r.pc.getTransceivers();if(d&&d.length>0)for(var u in d){var f=d[u];f.sender&&f.sender.track&&"audio"===f.sender.track.kind||f.receiver&&f.receiver.track&&"audio"===f.receiver.track.kind?c||(c=f):(f.sender&&f.sender.track&&"video"===f.sender.track.kind||f.receiver&&f.receiver.track&&"video"===f.receiver.track.kind)&&(l||(l=f))}var p=K(t),v=ee(t);if(p||v){if(p&&v){if(c)try{c.setDirection?c.setDirection("sendrecv"):c.direction="sendrecv",a.log("Setting audio transceiver to sendrecv:",c)}catch(C){a.error(C)}}else if(p&&!v)try{c&&(c.setDirection?c.setDirection("sendonly"):c.direction="sendonly",a.log("Setting audio transceiver to sendonly:",c))}catch(C){a.error(C)}else if(!p&&v)if(c)try{c.setDirection?c.setDirection("recvonly"):c.direction="recvonly",a.log("Setting audio transceiver to recvonly:",c)}catch(C){a.error(C)}else c=r.pc.addTransceiver("audio",{direction:"recvonly"}),a.log("Adding recvonly audio transceiver:",c)}else if(t.removeAudio&&c)try{c.setDirection?c.setDirection("inactive"):c.direction="inactive",a.log("Setting audio transceiver to inactive:",c)}catch(C){a.error(C)}var m=te(t),g=ie(t);if(m||g){if(m&&g){if(l)try{l.setDirection?l.setDirection("sendrecv"):l.direction="sendrecv",a.log("Setting video transceiver to sendrecv:",l)}catch(C){a.error(C)}}else if(m&&!g){if(l)try{l.setDirection?l.setDirection("sendonly"):l.direction="sendonly",a.log("Setting video transceiver to sendonly:",l)}catch(C){a.error(C)}}else if(!m&&g)if(l)try{l.setDirection?l.setDirection("recvonly"):l.direction="recvonly",a.log("Setting video transceiver to recvonly:",l)}catch(C){a.error(C)}else l=r.pc.addTransceiver("video",{direction:"recvonly"}),a.log("Adding recvonly video transceiver:",l)}else if(t.removeVideo&&l)try{l.setDirection?l.setDirection("inactive"):l.direction="inactive",a.log("Setting video transceiver to inactive:",l)}catch(C){a.error(C)}}else s="firefox"==a.webRTCAdapter.browserDetails.browser||"edge"==a.webRTCAdapter.browserDetails.browser?{offerToReceiveAudio:ee(t),offerToReceiveVideo:ie(t)}:{mandatory:{OfferToReceiveAudio:ee(t),OfferToReceiveVideo:ie(t)}};a.debug(s);var h=te(t);if(h&&o&&"firefox"===a.webRTCAdapter.browserDetails.browser){a.log("Enabling Simulcasting for Firefox (RID)");var b=r.pc.getSenders()[1];a.log(b);var w=b.getParameters();a.log(w);var _=y(n.simulcastMaxBitrates);b.setParameters({encodings:[{rid:"high",active:!0,priority:"high",maxBitrate:_.high},{rid:"medium",active:!0,priority:"medium",maxBitrate:_.medium},{rid:"low",active:!0,priority:"low",maxBitrate:_.low}]})}r.pc.createAnswer(s).then((function(e){a.debug(e);var t={type:e.type,sdp:e.sdp};n.customizeSdp(t),e.sdp=t.sdp,a.log("Setting local description"),h&&o&&("chrome"===a.webRTCAdapter.browserDetails.browser?a.warn("simulcast=true, but this is an answer, and video breaks in Chrome if we enable it"):"firefox"!==a.webRTCAdapter.browserDetails.browser&&a.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),r.mySdp=e.sdp,r.pc.setLocalDescription(e).catch(n.error),r.mediaConstraints=s,r.iceDone||r.trickle?n.success(e):a.log("Waiting for all candidates...")}),n.error)}function U(e,t){t=t||{},t.success="function"==typeof t.success?t.success:a.noop,t.error="function"==typeof t.error?t.error:a.noop;var n=k[e];if(null!==n&&void 0!==n&&null!==n.webrtcStuff&&void 0!==n.webrtcStuff){var i=n.webrtcStuff;a.log("Sending offer/answer SDP..."),null!==i.mySdp&&void 0!==i.mySdp?(i.mySdp={type:i.pc.localDescription.type,sdp:i.pc.localDescription.sdp},!1===i.trickle&&(i.mySdp["trickle"]=!1),a.debug(t),i.sdpSent=!0,t.success(i.mySdp)):a.warn("Local SDP instance is invalid, not sending anything...")}else a.warn("Invalid handle, not sending anything")}function q(e,t){var n=k[e];if(null===n||void 0===n||null===n.webrtcStuff||void 0===n.webrtcStuff)return a.warn("Invalid handle"),0;var i=t?"remote":"local",r=n.webrtcStuff;return r.volume[i]||(r.volume[i]={value:0}),r.pc.getStats&&"chrome"===a.webRTCAdapter.browserDetails.browser?!t||null!==r.remoteStream&&void 0!==r.remoteStream?t||null!==r.myStream&&void 0!==r.myStream?null===r.volume[i].timer||void 0===r.volume[i].timer?(a.log("Starting "+i+" volume monitor"),r.volume[i].timer=setInterval((function(){r.pc.getStats((function(e){for(var n=e.result(),a=0;a<n.length;a++){var o=n[a];"ssrc"==o.type&&(t&&o.stat("audioOutputLevel")?r.volume[i].value=parseInt(o.stat("audioOutputLevel")):!t&&o.stat("audioInputLevel")&&(r.volume[i].value=parseInt(o.stat("audioInputLevel"))))}}))}),200),0):r.volume[i].value:(a.warn("Local stream unavailable"),0):(a.warn("Remote stream unavailable"),0):(a.warn("Getting the "+i+" volume unsupported by browser"),0)}function G(e,t){var n=k[e];if(null===n||void 0===n||null===n.webrtcStuff||void 0===n.webrtcStuff)return a.warn("Invalid handle"),!0;var i=n.webrtcStuff;return null===i.pc||void 0===i.pc?(a.warn("Invalid PeerConnection"),!0):void 0===i.myStream||null===i.myStream?(a.warn("Invalid local MediaStream"),!0):t?null===i.myStream.getVideoTracks()||void 0===i.myStream.getVideoTracks()||0===i.myStream.getVideoTracks().length?(a.warn("No video track"),!0):!i.myStream.getVideoTracks()[0].enabled:null===i.myStream.getAudioTracks()||void 0===i.myStream.getAudioTracks()||0===i.myStream.getAudioTracks().length?(a.warn("No audio track"),!0):!i.myStream.getAudioTracks()[0].enabled}function J(e,t,n){var i=k[e];if(null===i||void 0===i||null===i.webrtcStuff||void 0===i.webrtcStuff)return a.warn("Invalid handle"),!1;var r=i.webrtcStuff;return null===r.pc||void 0===r.pc?(a.warn("Invalid PeerConnection"),!1):void 0===r.myStream||null===r.myStream?(a.warn("Invalid local MediaStream"),!1):t?null===r.myStream.getVideoTracks()||void 0===r.myStream.getVideoTracks()||0===r.myStream.getVideoTracks().length?(a.warn("No video track"),!1):(r.myStream.getVideoTracks()[0].enabled=!n,!0):null===r.myStream.getAudioTracks()||void 0===r.myStream.getAudioTracks()||0===r.myStream.getAudioTracks().length?(a.warn("No audio track"),!1):(r.myStream.getAudioTracks()[0].enabled=!n,!0)}function H(e){var t=k[e];if(null===t||void 0===t||null===t.webrtcStuff||void 0===t.webrtcStuff)return a.warn("Invalid handle"),"Invalid handle";var n=t.webrtcStuff;return null===n.pc||void 0===n.pc?"Invalid PeerConnection":n.pc.getStats?null===n.bitrate.timer||void 0===n.bitrate.timer?(a.log("Starting bitrate timer (via getStats)"),n.bitrate.timer=setInterval((function(){n.pc.getStats().then((function(e){e.forEach((function(e){if(e){var t=!1;if(("video"===e.mediaType||e.id.toLowerCase().indexOf("video")>-1)&&"inbound-rtp"===e.type&&e.id.indexOf("rtcp")<0?t=!0:"ssrc"!=e.type||!e.bytesReceived||"VP8"!==e.googCodecName&&""!==e.googCodecName||(t=!0),t)if(n.bitrate.bsnow=e.bytesReceived,n.bitrate.tsnow=e.timestamp,null===n.bitrate.bsbefore||null===n.bitrate.tsbefore)n.bitrate.bsbefore=n.bitrate.bsnow,n.bitrate.tsbefore=n.bitrate.tsnow;else{var i=n.bitrate.tsnow-n.bitrate.tsbefore;"safari"==a.webRTCAdapter.browserDetails.browser&&(i/=1e3);var r=Math.round(8*(n.bitrate.bsnow-n.bitrate.bsbefore)/i);"safari"===a.webRTCAdapter.browserDetails.browser&&(r=parseInt(r/1e3)),n.bitrate.value=r+" kbits/sec",n.bitrate.bsbefore=n.bitrate.bsnow,n.bitrate.tsbefore=n.bitrate.tsnow}}}))}))}),1e3),"0 kbits/sec"):n.bitrate.value:(a.warn("Getting the video bitrate unsupported by browser"),"Feature unsupported by browser")}function Y(e){a.error("WebRTC error:",e)}function Q(e,i){a.log("Cleaning WebRTC stuff");var r=k[e];if(null!==r&&void 0!==r){var o=r.webrtcStuff;if(null!==o&&void 0!==o){if(!0===i){var s={janus:"hangup",transaction:a.randomString(12)};null!==r.token&&void 0!==r.token&&(s["token"]=r.token),null!==h&&void 0!==h&&(s["apisecret"]=h),a.debug("Sending hangup request (handle="+e+"):"),a.debug(s),t?(s["session_id"]=C,s["handle_id"]=e,n.send(JSON.stringify(s))):a.httpAPICall(l+"/"+C+"/"+e,{verb:"POST",withCredentials:v,body:s})}o.remoteStream=null,o.volume&&(o.volume["local"]&&o.volume["local"].timer&&clearInterval(o.volume["local"].timer),o.volume["remote"]&&o.volume["remote"].timer&&clearInterval(o.volume["remote"].timer)),o.volume={},o.bitrate.timer&&clearInterval(o.bitrate.timer),o.bitrate.timer=null,o.bitrate.bsnow=null,o.bitrate.bsbefore=null,o.bitrate.tsnow=null,o.bitrate.tsbefore=null,o.bitrate.value=null;try{if(!o.streamExternal&&null!==o.myStream&&void 0!==o.myStream){a.log("Stopping local stream tracks");var c=o.myStream.getTracks();for(var d in c){var u=c[d];a.log(u),null!==u&&void 0!==u&&u.stop()}}}catch(f){}o.streamExternal=!1,o.myStream=null;try{o.pc.close()}catch(f){}o.pc=null,o.candidates=null,o.mySdp=null,o.remoteSdp=null,o.iceDone=!1,o.dataChannel={},o.dtmfSender=null}r.oncleanup()}}function Z(e){for(var t=e.split("\r\n"),n=!1,i=[-1],r=[-1],o=null,s=null,c=null,l=null,d=-1,u=0;u<t.length;u++){var f=t[u].match(/m=(\w+) */);if(f){var p=f[1];if("video"===p){if(!(i[0]<0)){d=u;break}n=!0}else if(i[0]>-1){d=u;break}}else if(n){var v=t[u].match(/a=ssrc-group:FID (\d+) (\d+)/);if(v)i[0]=v[1],r[0]=v[2],t.splice(u,1),u--;else{if(i[0]){var m=t[u].match("a=ssrc:"+i[0]+" cname:(.+)");if(m&&(o=m[1]),m=t[u].match("a=ssrc:"+i[0]+" msid:(.+)"),m&&(s=m[1]),m=t[u].match("a=ssrc:"+i[0]+" mslabel:(.+)"),m&&(c=m[1]),m=t[u].match("a=ssrc:"+i[0]+" label:(.+)"),m&&(l=m[1]),0===t[u].indexOf("a=ssrc:"+r[0])){t.splice(u,1),u--;continue}if(0===t[u].indexOf("a=ssrc:"+i[0])){t.splice(u,1),u--;continue}}0!=t[u].length||(t.splice(u,1),u--)}}}if(i[0]<0){d=-1,n=!1;for(u=0;u<t.length;u++){f=t[u].match(/m=(\w+) */);if(f){p=f[1];if("video"===p){if(!(i[0]<0)){d=u;break}n=!0}else if(i[0]>-1){d=u;break}}else if(n){if(i[0]<0){var g=t[u].match(/a=ssrc:(\d+)/);if(g){i[0]=g[1],t.splice(u,1),u--;continue}}else{m=t[u].match("a=ssrc:"+i[0]+" cname:(.+)");if(m&&(o=m[1]),m=t[u].match("a=ssrc:"+i[0]+" msid:(.+)"),m&&(s=m[1]),m=t[u].match("a=ssrc:"+i[0]+" mslabel:(.+)"),m&&(c=m[1]),m=t[u].match("a=ssrc:"+i[0]+" label:(.+)"),m&&(l=m[1]),0===t[u].indexOf("a=ssrc:"+r[0])){t.splice(u,1),u--;continue}if(0===t[u].indexOf("a=ssrc:"+i[0])){t.splice(u,1),u--;continue}}0!=t[u].length||(t.splice(u,1),u--)}}}if(i[0]<0)return a.warn("Couldn't find the video SSRC, simulcasting NOT enabled"),e;d<0&&(d=t.length),i[1]=Math.floor(4294967295*Math.random()),i[2]=Math.floor(4294967295*Math.random()),r[1]=Math.floor(4294967295*Math.random()),r[2]=Math.floor(4294967295*Math.random());for(u=0;u<i.length;u++)o&&(t.splice(d,0,"a=ssrc:"+i[u]+" cname:"+o),d++),s&&(t.splice(d,0,"a=ssrc:"+i[u]+" msid:"+s),d++),c&&(t.splice(d,0,"a=ssrc:"+i[u]+" mslabel:"+c),d++),l&&(t.splice(d,0,"a=ssrc:"+i[u]+" label:"+l),d++),o&&(t.splice(d,0,"a=ssrc:"+r[u]+" cname:"+o),d++),s&&(t.splice(d,0,"a=ssrc:"+r[u]+" msid:"+s),d++),c&&(t.splice(d,0,"a=ssrc:"+r[u]+" mslabel:"+c),d++),l&&(t.splice(d,0,"a=ssrc:"+r[u]+" label:"+l),d++);return t.splice(d,0,"a=ssrc-group:FID "+i[2]+" "+r[2]),t.splice(d,0,"a=ssrc-group:FID "+i[1]+" "+r[1]),t.splice(d,0,"a=ssrc-group:FID "+i[0]+" "+r[0]),t.splice(d,0,"a=ssrc-group:SIM "+i[0]+" "+i[1]+" "+i[2]),e=t.join("\r\n"),e.endsWith("\r\n")||(e+="\r\n"),e}function K(e){return a.debug("isAudioSendEnabled:",e),void 0===e||null===e||!1!==e.audio&&(void 0===e.audioSend||null===e.audioSend||!0===e.audioSend)}function X(e){return a.debug("isAudioSendRequired:",e),void 0!==e&&null!==e&&(!1!==e.audio&&!1!==e.audioSend&&(void 0!==e.failIfNoAudio&&null!==e.failIfNoAudio&&!0===e.failIfNoAudio))}function ee(e){return a.debug("isAudioRecvEnabled:",e),void 0===e||null===e||!1!==e.audio&&(void 0===e.audioRecv||null===e.audioRecv||!0===e.audioRecv)}function te(e){return a.debug("isVideoSendEnabled:",e),void 0===e||null===e||!1!==e.video&&(void 0===e.videoSend||null===e.videoSend||!0===e.videoSend)}function ne(e){return a.debug("isVideoSendRequired:",e),void 0!==e&&null!==e&&(!1!==e.video&&!1!==e.videoSend&&(void 0!==e.failIfNoVideo&&null!==e.failIfNoVideo&&!0===e.failIfNoVideo))}function ie(e){return a.debug("isVideoRecvEnabled:",e),void 0===e||null===e||!1!==e.video&&(void 0===e.videoRecv||null===e.videoRecv||!0===e.videoRecv)}function re(e){if(a.debug("isScreenSendEnabled:",e),void 0===e||null===e)return!1;if("object"!==Object(i["a"])(e.video)||"object"!==Object(i["a"])(e.video.mandatory))return!1;var t=e.video.mandatory;return t.chromeMediaSource?"desktop"===t.chromeMediaSource||"screen"===t.chromeMediaSource:t.mozMediaSource?"window"===t.mozMediaSource||"screen"===t.mozMediaSource:!!t.mediaSource&&("window"===t.mediaSource||"screen"===t.mediaSource)}function ae(e){return a.debug("isDataEnabled:",e),"edge"==a.webRTCAdapter.browserDetails.browser?(a.warn("Edge doesn't support data channels yet"),!1):void 0!==e&&null!==e&&!0===e.data}function oe(e){return a.debug("isTrickleEnabled:",e),void 0===e||null===e||!0===e}O(e),this.getServer=function(){return l},this.isConnected=function(){return _},this.reconnect=function(e){e=e||{},e.success="function"==typeof e.success?e.success:a.noop,e.error="function"==typeof e.error?e.error:a.noop,e["reconnect"]=!0,O(e)},this.getSessionId=function(){return C},this.destroy=function(e){I(e)},this.attach=function(e){E(e)}}a.useDefaultDependencies=function(t){var n=t&&t.fetch||fetch,o=t&&t.Promise||Promise,s=t&&t.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new s(e,t)},extension:t&&t.extension||r,isArray:function(e){return Array.isArray(e)},webRTCAdapter:t&&t.adapter||e,httpAPICall:function(e,t){var r={method:t.verb,headers:{Accept:"application/json, text/plain, */*"},cache:"no-cache"};"POST"===t.verb&&(r.headers["Content-Type"]="application/json"),void 0!==t.withCredentials&&(r.credentials=!0===t.withCredentials?"include":t.withCredentials?t.withCredentials:"omit"),void 0!==t.body&&(r.body=JSON.stringify(t.body));var s=n(e,r).catch((function(e){return o.reject({message:"Probably a network error, is the server down?",error:e})}));if(void 0!==t.timeout){var c=new o((function(e,n){var i=setTimeout((function(){return clearTimeout(i),n({message:"Request timed out",timeout:t.timeout})}),t.timeout)}));s=o.race([s,c])}return s.then((function(e){return e.ok?Object(i["a"])(t.success)===Object(i["a"])(a.noop)?e.json().then((function(e){t.success(e)})).catch((function(t){return o.reject({message:"Failed to parse response body",error:t,response:e})})):void 0:o.reject({message:"API call failed",response:e})})).catch((function(e){Object(i["a"])(t.error)===Object(i["a"])(a.noop)&&t.error(e.message||"<< internal error >>",e)})),s}}},a.useOldDependencies=function(t){var n=t&&t.jQuery||jQuery,o=t&&t.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new o(e,t)},isArray:function(e){return n.isArray(e)},extension:t&&t.extension||r,webRTCAdapter:t&&t.adapter||e,httpAPICall:function(e,t){var r=void 0!==t.body?{contentType:"application/json",data:JSON.stringify(t.body)}:{},o=void 0!==t.withCredentials?{xhrFields:{withCredentials:t.withCredentials}}:{};return n.ajax(n.extend(r,o,{url:e,type:t.verb,cache:!1,dataType:"json",async:t.async,timeout:t.timeout,success:function(e){Object(i["a"])(t.success)===Object(i["a"])(a.noop)&&t.success(e)},error:function(e,n,r){Object(i["a"])(t.error)===Object(i["a"])(a.noop)&&t.error(n,r)}}))}}},a.noop=function(){},a.dataChanDefaultLabel="JanusDataChannel",a.endOfCandidates=null,a.init=function(e){if(e=e||{},e.callback="function"==typeof e.callback?e.callback:a.noop,!0===a.initDone)e.callback();else{if("undefined"!=typeof console&&"undefined"!=typeof console.log||(console={log:function(){}}),a.trace=a.noop,a.debug=a.noop,a.vdebug=a.noop,a.log=a.noop,a.warn=a.noop,a.error=a.noop,!0===e.debug||"all"===e.debug)a.trace=console.trace.bind(console),a.debug=console.debug.bind(console),a.vdebug=console.debug.bind(console),a.log=console.log.bind(console),a.warn=console.warn.bind(console),a.error=console.error.bind(console);else if(Array.isArray(e.debug))for(var t in e.debug){var n=e.debug[t];switch(n){case"trace":a.trace=console.trace.bind(console);break;case"debug":a.debug=console.debug.bind(console);break;case"vdebug":a.vdebug=console.debug.bind(console);break;case"log":a.log=console.log.bind(console);break;case"warn":a.warn=console.warn.bind(console);break;case"error":a.error=console.error.bind(console);break;default:console.error("Unknown debugging option '"+n+"' (supported: 'trace', 'debug', 'vdebug', 'log', warn', 'error')");break}}a.log("Initializing library");var i=e.dependencies||a.useDefaultDependencies();a.isArray=i.isArray,a.webRTCAdapter=i.webRTCAdapter,a.httpAPICall=i.httpAPICall,a.newWebSocket=i.newWebSocket,a.extension=i.extension,a.extension.init(),a.listDevices=function(e,t){e="function"==typeof e?e:a.noop,null==t&&(t={audio:!0,video:!0}),a.isGetUserMediaAvailable()?navigator.mediaDevices.getUserMedia(t).then((function(t){navigator.mediaDevices.enumerateDevices().then((function(n){a.debug(n),e(n);try{var i=t.getTracks();for(var r in i){var o=i[r];null!==o&&void 0!==o&&o.stop()}}catch(s){}}))})).catch((function(t){a.error(t),e([])})):(a.warn("navigator.mediaDevices unavailable"),e([]))},a.attachMediaStream=function(e,t){if("chrome"===a.webRTCAdapter.browserDetails.browser){var n=a.webRTCAdapter.browserDetails.version;n>=52?e.srcObject=t:"undefined"!==typeof e.src?e.src=URL.createObjectURL(t):a.error("Error attaching stream to element")}else e.srcObject=t},a.reattachMediaStream=function(e,t){if("chrome"===a.webRTCAdapter.browserDetails.browser){var n=a.webRTCAdapter.browserDetails.version;n>=52?e.srcObject=t.srcObject:"undefined"!==typeof e.src?e.src=t.src:a.error("Error reattaching stream to element")}else e.srcObject=t.srcObject};var r=["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0,o=r?"pagehide":"beforeunload",s=window["on"+o];if(window.addEventListener(o,(function(e){for(var t in a.log("Closing window"),a.sessions)null!==a.sessions[t]&&void 0!==a.sessions[t]&&a.sessions[t].destroyOnUnload&&(a.log("Destroying session "+t),a.sessions[t].destroy({asyncRequest:!1,notifyDestroyed:!1}));s&&"function"==typeof s&&s()})),a.safariVp8=!1,"safari"===a.webRTCAdapter.browserDetails.browser&&a.webRTCAdapter.browserDetails.version>=605)if(RTCRtpSender&&RTCRtpSender.getCapabilities&&RTCRtpSender.getCapabilities("video")&&RTCRtpSender.getCapabilities("video").codecs&&RTCRtpSender.getCapabilities("video").codecs.length){for(var t in RTCRtpSender.getCapabilities("video").codecs){var c=RTCRtpSender.getCapabilities("video").codecs[t];if(c&&c.mimeType&&"video/vp8"===c.mimeType.toLowerCase()){a.safariVp8=!0;break}}a.safariVp8?a.log("This version of Safari supports VP8"):a.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu")}else{var l=new RTCPeerConnection({},{});l.createOffer({offerToReceiveVideo:!0}).then((function(e){a.safariVp8=-1!==e.sdp.indexOf("VP8"),a.safariVp8?a.log("This version of Safari supports VP8"):a.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu"),l.close(),l=null}))}if(a.unifiedPlan=!1,"firefox"===a.webRTCAdapter.browserDetails.browser&&a.webRTCAdapter.browserDetails.version>=59)a.unifiedPlan=!0;else if("chrome"===a.webRTCAdapter.browserDetails.browser&&a.webRTCAdapter.browserDetails.version<72)a.unifiedPlan=!1;else if(window.RTCRtpTransceiver&&"currentDirection"in RTCRtpTransceiver.prototype){var d=new RTCPeerConnection;try{d.addTransceiver("audio"),a.unifiedPlan=!0}catch(u){}d.close()}else a.unifiedPlan=!1;a.initDone=!0,e.callback()}},a.isWebrtcSupported=function(){return void 0!==window.RTCPeerConnection&&null!==window.RTCPeerConnection},a.isGetUserMediaAvailable=function(){return void 0!==navigator.mediaDevices&&null!==navigator.mediaDevices&&void 0!==navigator.mediaDevices.getUserMedia&&null!==navigator.mediaDevices.getUserMedia},a.randomString=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",i=0;i<e;i++){var r=Math.floor(Math.random()*t.length);n+=t.substring(r,r+1)}return n},t["a"]=a}).call(this,n("d093"))},c2fe:function(e,t,n){},c7db:function(e,t,n){"use strict";var i=n("90da"),r=n.n(i);r.a},cb3d:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:{"saving-in-progress":e.savingClass,"successfully-saved":e.savingDoneClass,"failed-to-save":e.savingFailedClass,"small-height":e.smallHeightClass}},[e._t("default"),e.errors&&e.errors.length>0?n("small",{staticClass:"text-danger"},[e._v(e._s(e.errorMsg))]):e._e()],2)},r=[],a=(n("a15b"),{name:"SavingAnimation",data:function(){return{savingTimeout:null,savingDoneTimeout:null}},props:{saving:{default:function(){return!1},type:Boolean},errors:{type:Array},height:{default:function(){return"normal"},type:String}},watch:{saving:function(e,t){var n=this;!t&&e?(this.clearSavingTimeout(),this.savingTimeout=setTimeout(this.clearSavingTimeout,15e3)):t&&!e&&(this.clearSavingTimeout(),this.savingDoneTimeout=setTimeout((function(){clearTimeout(n.savingDoneTimeout),n.savingDoneTimeout=null}),2e3))}},computed:{savingClass:function(){return this.saving&&this.savingTimeout},savingDoneClass:function(){return!this.saving&&this.savingDoneTimeout&&!this.errors},savingFailedClass:function(){return!this.saving&&this.savingDoneTimeout&&this.errors&&this.errors.length>0},smallHeightClass:function(){return"small"===this.height},errorMsg:function(){return this.errors.join(" ")}},methods:{clearSavingTimeout:function(){this.savingTimeout&&(clearTimeout(this.savingTimeout),this.savingTimeout=null)}}}),o=a,s=(n("3878"),n("2877")),c=Object(s["a"])(o,i,r,!1,null,"3db658bf",null);t["a"]=c.exports},d3a4:function(e,t,n){},e18c:function(e,t,n){},ebff:function(e,t,n){e.exports=n.p+"img/plugin_wizard_websetup.png"},f357:function(e,t,n){"use strict";var i=n("f3f3"),r=n("a026"),a=n("5886"),o=n("3c33"),s=function(e,t,n){var a=document.createElement("div"),o=new r["default"]({render:function(n){return n(e,{props:t})}}).$mount(a);return r["default"].swal(Object(i["a"])(Object(i["a"])({},n),{},{customClass:{container:"dark-backdrop"},html:'<div id="replace-here">Placeholder</div>',onBeforeOpen:function(e){e.querySelector("#replace-here").replaceWith(o.$el)},onDestroy:function(){o.$destroy(),a.remove()}}))},c=function(e,t,n){return r["default"].swal(Object(i["a"])(Object(i["a"])({},n),{},{customClass:{container:"dark-backdrop"},html:'<div id="replace-here">Placeholder</div>',onBeforeOpen:function(t){t.querySelector("#replace-here").replaceWith(e)}}))},l=function(e,t){e.use(a["a"],t);var n=e.swal.mixin({title:"Are you sure?",showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"No",customClass:{container:"dark-backdrop"}}),r=e.swal.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:5e3}),l=function(t,n){if(!Object(o["a"])(n,!1)){var r=Object(i["a"])(Object(i["a"])({},t),{},{position:"top-end",confirmButtonText:"Gotcha! Don't show this again."});return e.swal(r).then((function(e){e.value&&(Object(o["b"])(n,!0),console.log(e))}))}};e.prototype.$swal["openModalWithComponent"]=s,e.prototype.$swal["openModalWithElement"]=c,e.prototype.$swal["Confirm"]=n,e.prototype.$swal["Toast"]=r,e.prototype.$swal["DismissableToast"]=l};t["a"]={install:l}}});
//# sourceMappingURL=printers.js.map